<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<!--[if IE]><meta http-equiv="X-UA-Compatible" content="IE=edge"><![endif]-->
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 1.5.5.dev">
<title>The ALAN Adventure Language Reference Manual</title>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700">
<style>
/* Asciidoctor default stylesheet | MIT License | http://asciidoctor.org */
/* Remove comment around @import statement below when using as a custom stylesheet */
/*@import "https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700";*/
article,aside,details,figcaption,figure,footer,header,hgroup,main,nav,section,summary{display:block}
audio,canvas,video{display:inline-block}
audio:not([controls]){display:none;height:0}
[hidden],template{display:none}
script{display:none!important}
html{font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}
body{margin:0}
a{background:transparent}
a:focus{outline:thin dotted}
a:active,a:hover{outline:0}
h1{font-size:2em;margin:.67em 0}
abbr[title]{border-bottom:1px dotted}
b,strong{font-weight:bold}
dfn{font-style:italic}
hr{-moz-box-sizing:content-box;box-sizing:content-box;height:0}
mark{background:#ff0;color:#000}
code,kbd,pre,samp{font-family:monospace;font-size:1em}
pre{white-space:pre-wrap}
q{quotes:"\201C" "\201D" "\2018" "\2019"}
small{font-size:80%}
sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}
sup{top:-.5em}
sub{bottom:-.25em}
img{border:0}
svg:not(:root){overflow:hidden}
figure{margin:0}
fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}
legend{border:0;padding:0}
button,input,select,textarea{font-family:inherit;font-size:100%;margin:0}
button,input{line-height:normal}
button,select{text-transform:none}
button,html input[type="button"],input[type="reset"],input[type="submit"]{-webkit-appearance:button;cursor:pointer}
button[disabled],html input[disabled]{cursor:default}
input[type="checkbox"],input[type="radio"]{box-sizing:border-box;padding:0}
input[type="search"]{-webkit-appearance:textfield;-moz-box-sizing:content-box;-webkit-box-sizing:content-box;box-sizing:content-box}
input[type="search"]::-webkit-search-cancel-button,input[type="search"]::-webkit-search-decoration{-webkit-appearance:none}
button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}
textarea{overflow:auto;vertical-align:top}
table{border-collapse:collapse;border-spacing:0}
*,*:before,*:after{-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box}
html,body{font-size:100%}
body{background:#fff;color:rgba(0,0,0,.8);padding:0;margin:0;font-family:"Noto Serif","DejaVu Serif",serif;font-weight:400;font-style:normal;line-height:1;position:relative;cursor:auto}
a:hover{cursor:pointer}
img,object,embed{max-width:100%;height:auto}
object,embed{height:100%}
img{-ms-interpolation-mode:bicubic}
.left{float:left!important}
.right{float:right!important}
.text-left{text-align:left!important}
.text-right{text-align:right!important}
.text-center{text-align:center!important}
.text-justify{text-align:justify!important}
.hide{display:none}
body{-webkit-font-smoothing:antialiased}
img,object,svg{display:inline-block;vertical-align:middle}
textarea{height:auto;min-height:50px}
select{width:100%}
.center{margin-left:auto;margin-right:auto}
.spread{width:100%}
p.lead,.paragraph.lead>p,#preamble>.sectionbody>.paragraph:first-of-type p{font-size:1.21875em;line-height:1.6}
.subheader,.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{line-height:1.45;color:#7a2518;font-weight:400;margin-top:0;margin-bottom:.25em}
div,dl,dt,dd,ul,ol,li,h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6,pre,form,p,blockquote,th,td{margin:0;padding:0;direction:ltr}
a{color:#2156a5;text-decoration:underline;line-height:inherit}
a:hover,a:focus{color:#1d4b8f}
a img{border:none}
p{font-family:inherit;font-weight:400;font-size:1em;line-height:1.6;margin-bottom:1.25em;text-rendering:optimizeLegibility}
p aside{font-size:.875em;line-height:1.35;font-style:italic}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{font-family:"Open Sans","DejaVu Sans",sans-serif;font-weight:300;font-style:normal;color:#ba3925;text-rendering:optimizeLegibility;margin-top:1em;margin-bottom:.5em;line-height:1.0125em}
h1 small,h2 small,h3 small,#toctitle small,.sidebarblock>.content>.title small,h4 small,h5 small,h6 small{font-size:60%;color:#e99b8f;line-height:0}
h1{font-size:2.125em}
h2{font-size:1.6875em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.375em}
h4,h5{font-size:1.125em}
h6{font-size:1em}
hr{border:solid #ddddd8;border-width:1px 0 0;clear:both;margin:1.25em 0 1.1875em;height:0}
em,i{font-style:italic;line-height:inherit}
strong,b{font-weight:bold;line-height:inherit}
small{font-size:60%;line-height:inherit}
code{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;color:rgba(0,0,0,.9)}
ul,ol,dl{font-size:1em;line-height:1.6;margin-bottom:1.25em;list-style-position:outside;font-family:inherit}
ul,ol,ul.no-bullet,ol.no-bullet{margin-left:1.5em}
ul li ul,ul li ol{margin-left:1.25em;margin-bottom:0;font-size:1em}
ul.square li ul,ul.circle li ul,ul.disc li ul{list-style:inherit}
ul.square{list-style-type:square}
ul.circle{list-style-type:circle}
ul.disc{list-style-type:disc}
ul.no-bullet{list-style:none}
ol li ul,ol li ol{margin-left:1.25em;margin-bottom:0}
dl dt{margin-bottom:.3125em;font-weight:bold}
dl dd{margin-bottom:1.25em}
abbr,acronym{text-transform:uppercase;font-size:90%;color:rgba(0,0,0,.8);border-bottom:1px dotted #ddd;cursor:help}
abbr{text-transform:none}
blockquote{margin:0 0 1.25em;padding:.5625em 1.25em 0 1.1875em;border-left:1px solid #ddd}
blockquote cite{display:block;font-size:.9375em;color:rgba(0,0,0,.6)}
blockquote cite:before{content:"\2014 \0020"}
blockquote cite a,blockquote cite a:visited{color:rgba(0,0,0,.6)}
blockquote,blockquote p{line-height:1.6;color:rgba(0,0,0,.85)}
@media only screen and (min-width:768px){h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2}
h1{font-size:2.75em}
h2{font-size:2.3125em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.6875em}
h4{font-size:1.4375em}}
table{background:#fff;margin-bottom:1.25em;border:solid 1px #dedede}
table thead,table tfoot{background:#f7f8f7;font-weight:bold}
table thead tr th,table thead tr td,table tfoot tr th,table tfoot tr td{padding:.5em .625em .625em;font-size:inherit;color:rgba(0,0,0,.8);text-align:left}
table tr th,table tr td{padding:.5625em .625em;font-size:inherit;color:rgba(0,0,0,.8)}
table tr.even,table tr.alt,table tr:nth-of-type(even){background:#f8f8f7}
table thead tr th,table tfoot tr th,table tbody tr td,table tr td,table tfoot tr td{display:table-cell;line-height:1.6}
body{tab-size:4}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2;word-spacing:-.05em}
h1 strong,h2 strong,h3 strong,#toctitle strong,.sidebarblock>.content>.title strong,h4 strong,h5 strong,h6 strong{font-weight:400}
.clearfix:before,.clearfix:after,.float-group:before,.float-group:after{content:" ";display:table}
.clearfix:after,.float-group:after{clear:both}
*:not(pre)>code{font-size:.9375em;font-style:normal!important;letter-spacing:0;padding:.1em .5ex;word-spacing:-.15em;background-color:#f7f7f8;-webkit-border-radius:4px;border-radius:4px;line-height:1.45;text-rendering:optimizeSpeed}
pre,pre>code{line-height:1.45;color:rgba(0,0,0,.9);font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;text-rendering:optimizeSpeed}
.keyseq{color:rgba(51,51,51,.8)}
kbd{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;display:inline-block;color:rgba(0,0,0,.8);font-size:.65em;line-height:1.45;background-color:#f7f7f7;border:1px solid #ccc;-webkit-border-radius:3px;border-radius:3px;-webkit-box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em white inset;box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em #fff inset;margin:0 .15em;padding:.2em .5em;vertical-align:middle;position:relative;top:-.1em;white-space:nowrap}
.keyseq kbd:first-child{margin-left:0}
.keyseq kbd:last-child{margin-right:0}
.menuseq,.menu{color:rgba(0,0,0,.8)}
b.button:before,b.button:after{position:relative;top:-1px;font-weight:400}
b.button:before{content:"[";padding:0 3px 0 2px}
b.button:after{content:"]";padding:0 2px 0 3px}
p a>code:hover{color:rgba(0,0,0,.9)}
#header,#content,#footnotes,#footer{width:100%;margin-left:auto;margin-right:auto;margin-top:0;margin-bottom:0;max-width:62.5em;*zoom:1;position:relative;padding-left:.9375em;padding-right:.9375em}
#header:before,#header:after,#content:before,#content:after,#footnotes:before,#footnotes:after,#footer:before,#footer:after{content:" ";display:table}
#header:after,#content:after,#footnotes:after,#footer:after{clear:both}
#content{margin-top:1.25em}
#content:before{content:none}
#header>h1:first-child{color:rgba(0,0,0,.85);margin-top:2.25rem;margin-bottom:0}
#header>h1:first-child+#toc{margin-top:8px;border-top:1px solid #ddddd8}
#header>h1:only-child,body.toc2 #header>h1:nth-last-child(2){border-bottom:1px solid #ddddd8;padding-bottom:8px}
#header .details{border-bottom:1px solid #ddddd8;line-height:1.45;padding-top:.25em;padding-bottom:.25em;padding-left:.25em;color:rgba(0,0,0,.6);display:-ms-flexbox;display:-webkit-flex;display:flex;-ms-flex-flow:row wrap;-webkit-flex-flow:row wrap;flex-flow:row wrap}
#header .details span:first-child{margin-left:-.125em}
#header .details span.email a{color:rgba(0,0,0,.85)}
#header .details br{display:none}
#header .details br+span:before{content:"\00a0\2013\00a0"}
#header .details br+span.author:before{content:"\00a0\22c5\00a0";color:rgba(0,0,0,.85)}
#header .details br+span#revremark:before{content:"\00a0|\00a0"}
#header #revnumber{text-transform:capitalize}
#header #revnumber:after{content:"\00a0"}
#content>h1:first-child:not([class]){color:rgba(0,0,0,.85);border-bottom:1px solid #ddddd8;padding-bottom:8px;margin-top:0;padding-top:1rem;margin-bottom:1.25rem}
#toc{border-bottom:1px solid #efefed;padding-bottom:.5em}
#toc>ul{margin-left:.125em}
#toc ul.sectlevel0>li>a{font-style:italic}
#toc ul.sectlevel0 ul.sectlevel1{margin:.5em 0}
#toc ul{font-family:"Open Sans","DejaVu Sans",sans-serif;list-style-type:none}
#toc li{line-height:1.3334;margin-top:.3334em}
#toc a{text-decoration:none}
#toc a:active{text-decoration:underline}
#toctitle{color:#7a2518;font-size:1.2em}
@media only screen and (min-width:768px){#toctitle{font-size:1.375em}
body.toc2{padding-left:15em;padding-right:0}
#toc.toc2{margin-top:0!important;background-color:#f8f8f7;position:fixed;width:15em;left:0;top:0;border-right:1px solid #efefed;border-top-width:0!important;border-bottom-width:0!important;z-index:1000;padding:1.25em 1em;height:100%;overflow:auto}
#toc.toc2 #toctitle{margin-top:0;margin-bottom:.8rem;font-size:1.2em}
#toc.toc2>ul{font-size:.9em;margin-bottom:0}
#toc.toc2 ul ul{margin-left:0;padding-left:1em}
#toc.toc2 ul.sectlevel0 ul.sectlevel1{padding-left:0;margin-top:.5em;margin-bottom:.5em}
body.toc2.toc-right{padding-left:0;padding-right:15em}
body.toc2.toc-right #toc.toc2{border-right-width:0;border-left:1px solid #efefed;left:auto;right:0}}
@media only screen and (min-width:1280px){body.toc2{padding-left:20em;padding-right:0}
#toc.toc2{width:20em}
#toc.toc2 #toctitle{font-size:1.375em}
#toc.toc2>ul{font-size:.95em}
#toc.toc2 ul ul{padding-left:1.25em}
body.toc2.toc-right{padding-left:0;padding-right:20em}}
#content #toc{border-style:solid;border-width:1px;border-color:#e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;-webkit-border-radius:4px;border-radius:4px}
#content #toc>:first-child{margin-top:0}
#content #toc>:last-child{margin-bottom:0}
#footer{max-width:100%;background-color:rgba(0,0,0,.8);padding:1.25em}
#footer-text{color:rgba(255,255,255,.8);line-height:1.44}
.sect1{padding-bottom:.625em}
@media only screen and (min-width:768px){.sect1{padding-bottom:1.25em}}
.sect1+.sect1{border-top:1px solid #efefed}
#content h1>a.anchor,h2>a.anchor,h3>a.anchor,#toctitle>a.anchor,.sidebarblock>.content>.title>a.anchor,h4>a.anchor,h5>a.anchor,h6>a.anchor{position:absolute;z-index:1001;width:1.5ex;margin-left:-1.5ex;display:block;text-decoration:none!important;visibility:hidden;text-align:center;font-weight:400}
#content h1>a.anchor:before,h2>a.anchor:before,h3>a.anchor:before,#toctitle>a.anchor:before,.sidebarblock>.content>.title>a.anchor:before,h4>a.anchor:before,h5>a.anchor:before,h6>a.anchor:before{content:"\00A7";font-size:.85em;display:block;padding-top:.1em}
#content h1:hover>a.anchor,#content h1>a.anchor:hover,h2:hover>a.anchor,h2>a.anchor:hover,h3:hover>a.anchor,#toctitle:hover>a.anchor,.sidebarblock>.content>.title:hover>a.anchor,h3>a.anchor:hover,#toctitle>a.anchor:hover,.sidebarblock>.content>.title>a.anchor:hover,h4:hover>a.anchor,h4>a.anchor:hover,h5:hover>a.anchor,h5>a.anchor:hover,h6:hover>a.anchor,h6>a.anchor:hover{visibility:visible}
#content h1>a.link,h2>a.link,h3>a.link,#toctitle>a.link,.sidebarblock>.content>.title>a.link,h4>a.link,h5>a.link,h6>a.link{color:#ba3925;text-decoration:none}
#content h1>a.link:hover,h2>a.link:hover,h3>a.link:hover,#toctitle>a.link:hover,.sidebarblock>.content>.title>a.link:hover,h4>a.link:hover,h5>a.link:hover,h6>a.link:hover{color:#a53221}
.audioblock,.imageblock,.literalblock,.listingblock,.stemblock,.videoblock{margin-bottom:1.25em}
.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{text-rendering:optimizeLegibility;text-align:left;font-family:"Noto Serif","DejaVu Serif",serif;font-size:1rem;font-style:italic}
table.tableblock>caption.title{white-space:nowrap;overflow:visible;max-width:0}
.paragraph.lead>p,#preamble>.sectionbody>.paragraph:first-of-type p{color:rgba(0,0,0,.85)}
table.tableblock #preamble>.sectionbody>.paragraph:first-of-type p{font-size:inherit}
.admonitionblock>table{border-collapse:separate;border:0;background:none;width:100%}
.admonitionblock>table td.icon{text-align:center;width:80px}
.admonitionblock>table td.icon img{max-width:none}
.admonitionblock>table td.icon .title{font-weight:bold;font-family:"Open Sans","DejaVu Sans",sans-serif;text-transform:uppercase}
.admonitionblock>table td.content{padding-left:1.125em;padding-right:1.25em;border-left:1px solid #ddddd8;color:rgba(0,0,0,.6)}
.admonitionblock>table td.content>:last-child>:last-child{margin-bottom:0}
.exampleblock>.content{border-style:solid;border-width:1px;border-color:#e6e6e6;margin-bottom:1.25em;padding:1.25em;background:#fff;-webkit-border-radius:4px;border-radius:4px}
.exampleblock>.content>:first-child{margin-top:0}
.exampleblock>.content>:last-child{margin-bottom:0}
.sidebarblock{border-style:solid;border-width:1px;border-color:#e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;-webkit-border-radius:4px;border-radius:4px}
.sidebarblock>:first-child{margin-top:0}
.sidebarblock>:last-child{margin-bottom:0}
.sidebarblock>.content>.title{color:#7a2518;margin-top:0;text-align:center}
.exampleblock>.content>:last-child>:last-child,.exampleblock>.content .olist>ol>li:last-child>:last-child,.exampleblock>.content .ulist>ul>li:last-child>:last-child,.exampleblock>.content .qlist>ol>li:last-child>:last-child,.sidebarblock>.content>:last-child>:last-child,.sidebarblock>.content .olist>ol>li:last-child>:last-child,.sidebarblock>.content .ulist>ul>li:last-child>:last-child,.sidebarblock>.content .qlist>ol>li:last-child>:last-child{margin-bottom:0}
.literalblock pre,.listingblock pre:not(.highlight),.listingblock pre[class="highlight"],.listingblock pre[class^="highlight "],.listingblock pre.CodeRay,.listingblock pre.prettyprint{background:#f7f7f8}
.sidebarblock .literalblock pre,.sidebarblock .listingblock pre:not(.highlight),.sidebarblock .listingblock pre[class="highlight"],.sidebarblock .listingblock pre[class^="highlight "],.sidebarblock .listingblock pre.CodeRay,.sidebarblock .listingblock pre.prettyprint{background:#f2f1f1}
.literalblock pre,.literalblock pre[class],.listingblock pre,.listingblock pre[class]{-webkit-border-radius:4px;border-radius:4px;word-wrap:break-word;padding:1em;font-size:.8125em}
.literalblock pre.nowrap,.literalblock pre[class].nowrap,.listingblock pre.nowrap,.listingblock pre[class].nowrap{overflow-x:auto;white-space:pre;word-wrap:normal}
@media only screen and (min-width:768px){.literalblock pre,.literalblock pre[class],.listingblock pre,.listingblock pre[class]{font-size:.90625em}}
@media only screen and (min-width:1280px){.literalblock pre,.literalblock pre[class],.listingblock pre,.listingblock pre[class]{font-size:1em}}
.literalblock.output pre{color:#f7f7f8;background-color:rgba(0,0,0,.9)}
.listingblock pre.highlightjs{padding:0}
.listingblock pre.highlightjs>code{padding:1em;-webkit-border-radius:4px;border-radius:4px}
.listingblock pre.prettyprint{border-width:0}
.listingblock>.content{position:relative}
.listingblock code[data-lang]:before{display:none;content:attr(data-lang);position:absolute;font-size:.75em;top:.425rem;right:.5rem;line-height:1;text-transform:uppercase;color:#999}
.listingblock:hover code[data-lang]:before{display:block}
.listingblock.terminal pre .command:before{content:attr(data-prompt);padding-right:.5em;color:#999}
.listingblock.terminal pre .command:not([data-prompt]):before{content:"$"}
table.pyhltable{border-collapse:separate;border:0;margin-bottom:0;background:none}
table.pyhltable td{vertical-align:top;padding-top:0;padding-bottom:0;line-height:1.45}
table.pyhltable td.code{padding-left:.75em;padding-right:0}
pre.pygments .lineno,table.pyhltable td:not(.code){color:#999;padding-left:0;padding-right:.5em;border-right:1px solid #ddddd8}
pre.pygments .lineno{display:inline-block;margin-right:.25em}
table.pyhltable .linenodiv{background:none!important;padding-right:0!important}
.quoteblock{margin:0 1em 1.25em 1.5em;display:table}
.quoteblock>.title{margin-left:-1.5em;margin-bottom:.75em}
.quoteblock blockquote,.quoteblock blockquote p{color:rgba(0,0,0,.85);font-size:1.15rem;line-height:1.75;word-spacing:.1em;letter-spacing:0;font-style:italic;text-align:justify}
.quoteblock blockquote{margin:0;padding:0;border:0}
.quoteblock blockquote:before{content:"\201c";float:left;font-size:2.75em;font-weight:bold;line-height:.6em;margin-left:-.6em;color:#7a2518;text-shadow:0 1px 2px rgba(0,0,0,.1)}
.quoteblock blockquote>.paragraph:last-child p{margin-bottom:0}
.quoteblock .attribution{margin-top:.5em;margin-right:.5ex;text-align:right}
.quoteblock .quoteblock{margin-left:0;margin-right:0;padding:.5em 0;border-left:3px solid rgba(0,0,0,.6)}
.quoteblock .quoteblock blockquote{padding:0 0 0 .75em}
.quoteblock .quoteblock blockquote:before{display:none}
.verseblock{margin:0 1em 1.25em 1em}
.verseblock pre{font-family:"Open Sans","DejaVu Sans",sans;font-size:1.15rem;color:rgba(0,0,0,.85);font-weight:300;text-rendering:optimizeLegibility}
.verseblock pre strong{font-weight:400}
.verseblock .attribution{margin-top:1.25rem;margin-left:.5ex}
.quoteblock .attribution,.verseblock .attribution{font-size:.9375em;line-height:1.45;font-style:italic}
.quoteblock .attribution br,.verseblock .attribution br{display:none}
.quoteblock .attribution cite,.verseblock .attribution cite{display:block;letter-spacing:-.025em;color:rgba(0,0,0,.6)}
.quoteblock.abstract{margin:0 0 1.25em 0;display:block}
.quoteblock.abstract blockquote,.quoteblock.abstract blockquote p{text-align:left;word-spacing:0}
.quoteblock.abstract blockquote:before,.quoteblock.abstract blockquote p:first-of-type:before{display:none}
table.tableblock{max-width:100%;border-collapse:separate}
table.tableblock td>.paragraph:last-child p>p:last-child,table.tableblock th>p:last-child,table.tableblock td>p:last-child{margin-bottom:0}
table.tableblock,th.tableblock,td.tableblock{border:0 solid #dedede}
table.grid-all th.tableblock,table.grid-all td.tableblock{border-width:0 1px 1px 0}
table.grid-all tfoot>tr>th.tableblock,table.grid-all tfoot>tr>td.tableblock{border-width:1px 1px 0 0}
table.grid-cols th.tableblock,table.grid-cols td.tableblock{border-width:0 1px 0 0}
table.grid-all *>tr>.tableblock:last-child,table.grid-cols *>tr>.tableblock:last-child{border-right-width:0}
table.grid-rows th.tableblock,table.grid-rows td.tableblock{border-width:0 0 1px 0}
table.grid-all tbody>tr:last-child>th.tableblock,table.grid-all tbody>tr:last-child>td.tableblock,table.grid-all thead:last-child>tr>th.tableblock,table.grid-rows tbody>tr:last-child>th.tableblock,table.grid-rows tbody>tr:last-child>td.tableblock,table.grid-rows thead:last-child>tr>th.tableblock{border-bottom-width:0}
table.grid-rows tfoot>tr>th.tableblock,table.grid-rows tfoot>tr>td.tableblock{border-width:1px 0 0 0}
table.frame-all{border-width:1px}
table.frame-sides{border-width:0 1px}
table.frame-topbot{border-width:1px 0}
th.halign-left,td.halign-left{text-align:left}
th.halign-right,td.halign-right{text-align:right}
th.halign-center,td.halign-center{text-align:center}
th.valign-top,td.valign-top{vertical-align:top}
th.valign-bottom,td.valign-bottom{vertical-align:bottom}
th.valign-middle,td.valign-middle{vertical-align:middle}
table thead th,table tfoot th{font-weight:bold}
tbody tr th{display:table-cell;line-height:1.6;background:#f7f8f7}
tbody tr th,tbody tr th p,tfoot tr th,tfoot tr th p{color:rgba(0,0,0,.8);font-weight:bold}
p.tableblock>code:only-child{background:none;padding:0}
p.tableblock{font-size:1em}
td>div.verse{white-space:pre}
ol{margin-left:1.75em}
ul li ol{margin-left:1.5em}
dl dd{margin-left:1.125em}
dl dd:last-child,dl dd:last-child>:last-child{margin-bottom:0}
ol>li p,ul>li p,ul dd,ol dd,.olist .olist,.ulist .ulist,.ulist .olist,.olist .ulist{margin-bottom:.625em}
ul.unstyled,ol.unnumbered,ul.checklist,ul.none{list-style-type:none}
ul.unstyled,ol.unnumbered,ul.checklist{margin-left:.625em}
ul.checklist li>p:first-child>.fa-square-o:first-child,ul.checklist li>p:first-child>.fa-check-square-o:first-child{width:1em;font-size:.85em}
ul.checklist li>p:first-child>input[type="checkbox"]:first-child{width:1em;position:relative;top:1px}
ul.inline{margin:0 auto .625em auto;margin-left:-1.375em;margin-right:0;padding:0;list-style:none;overflow:hidden}
ul.inline>li{list-style:none;float:left;margin-left:1.375em;display:block}
ul.inline>li>*{display:block}
.unstyled dl dt{font-weight:400;font-style:normal}
ol.arabic{list-style-type:decimal}
ol.decimal{list-style-type:decimal-leading-zero}
ol.loweralpha{list-style-type:lower-alpha}
ol.upperalpha{list-style-type:upper-alpha}
ol.lowerroman{list-style-type:lower-roman}
ol.upperroman{list-style-type:upper-roman}
ol.lowergreek{list-style-type:lower-greek}
.hdlist>table,.colist>table{border:0;background:none}
.hdlist>table>tbody>tr,.colist>table>tbody>tr{background:none}
td.hdlist1,td.hdlist2{vertical-align:top;padding:0 .625em}
td.hdlist1{font-weight:bold;padding-bottom:1.25em}
.literalblock+.colist,.listingblock+.colist{margin-top:-.5em}
.colist>table tr>td:first-of-type{padding:0 .75em;line-height:1}
.colist>table tr>td:last-of-type{padding:.25em 0}
.thumb,.th{line-height:0;display:inline-block;border:solid 4px #fff;-webkit-box-shadow:0 0 0 1px #ddd;box-shadow:0 0 0 1px #ddd}
.imageblock.left,.imageblock[style*="float: left"]{margin:.25em .625em 1.25em 0}
.imageblock.right,.imageblock[style*="float: right"]{margin:.25em 0 1.25em .625em}
.imageblock>.title{margin-bottom:0}
.imageblock.thumb,.imageblock.th{border-width:6px}
.imageblock.thumb>.title,.imageblock.th>.title{padding:0 .125em}
.image.left,.image.right{margin-top:.25em;margin-bottom:.25em;display:inline-block;line-height:0}
.image.left{margin-right:.625em}
.image.right{margin-left:.625em}
a.image{text-decoration:none;display:inline-block}
a.image object{pointer-events:none}
sup.footnote,sup.footnoteref{font-size:.875em;position:static;vertical-align:super}
sup.footnote a,sup.footnoteref a{text-decoration:none}
sup.footnote a:active,sup.footnoteref a:active{text-decoration:underline}
#footnotes{padding-top:.75em;padding-bottom:.75em;margin-bottom:.625em}
#footnotes hr{width:20%;min-width:6.25em;margin:-.25em 0 .75em 0;border-width:1px 0 0 0}
#footnotes .footnote{padding:0 .375em 0 .225em;line-height:1.3334;font-size:.875em;margin-left:1.2em;text-indent:-1.05em;margin-bottom:.2em}
#footnotes .footnote a:first-of-type{font-weight:bold;text-decoration:none}
#footnotes .footnote:last-of-type{margin-bottom:0}
#content #footnotes{margin-top:-.625em;margin-bottom:0;padding:.75em 0}
.gist .file-data>table{border:0;background:#fff;width:100%;margin-bottom:0}
.gist .file-data>table td.line-data{width:99%}
div.unbreakable{page-break-inside:avoid}
.big{font-size:larger}
.small{font-size:smaller}
.underline{text-decoration:underline}
.overline{text-decoration:overline}
.line-through{text-decoration:line-through}
.aqua{color:#00bfbf}
.aqua-background{background-color:#00fafa}
.black{color:#000}
.black-background{background-color:#000}
.blue{color:#0000bf}
.blue-background{background-color:#0000fa}
.fuchsia{color:#bf00bf}
.fuchsia-background{background-color:#fa00fa}
.gray{color:#606060}
.gray-background{background-color:#7d7d7d}
.green{color:#006000}
.green-background{background-color:#007d00}
.lime{color:#00bf00}
.lime-background{background-color:#00fa00}
.maroon{color:#600000}
.maroon-background{background-color:#7d0000}
.navy{color:#000060}
.navy-background{background-color:#00007d}
.olive{color:#606000}
.olive-background{background-color:#7d7d00}
.purple{color:#600060}
.purple-background{background-color:#7d007d}
.red{color:#bf0000}
.red-background{background-color:#fa0000}
.silver{color:#909090}
.silver-background{background-color:#bcbcbc}
.teal{color:#006060}
.teal-background{background-color:#007d7d}
.white{color:#bfbfbf}
.white-background{background-color:#fafafa}
.yellow{color:#bfbf00}
.yellow-background{background-color:#fafa00}
span.icon>.fa{cursor:default}
.admonitionblock td.icon [class^="fa icon-"]{font-size:2.5em;text-shadow:1px 1px 2px rgba(0,0,0,.5);cursor:default}
.admonitionblock td.icon .icon-note:before{content:"\f05a";color:#19407c}
.admonitionblock td.icon .icon-tip:before{content:"\f0eb";text-shadow:1px 1px 2px rgba(155,155,0,.8);color:#111}
.admonitionblock td.icon .icon-warning:before{content:"\f071";color:#bf6900}
.admonitionblock td.icon .icon-caution:before{content:"\f06d";color:#bf3400}
.admonitionblock td.icon .icon-important:before{content:"\f06a";color:#bf0000}
.conum[data-value]{display:inline-block;color:#fff!important;background-color:rgba(0,0,0,.8);-webkit-border-radius:100px;border-radius:100px;text-align:center;font-size:.75em;width:1.67em;height:1.67em;line-height:1.67em;font-family:"Open Sans","DejaVu Sans",sans-serif;font-style:normal;font-weight:bold}
.conum[data-value] *{color:#fff!important}
.conum[data-value]+b{display:none}
.conum[data-value]:after{content:attr(data-value)}
pre .conum[data-value]{position:relative;top:-.125em}
b.conum *{color:inherit!important}
.conum:not([data-value]):empty{display:none}
dt,th.tableblock,td.content,div.footnote{text-rendering:optimizeLegibility}
h1,h2,p,td.content,span.alt{letter-spacing:-.01em}
p strong,td.content strong,div.footnote strong{letter-spacing:-.005em}
p,blockquote,dt,td.content,span.alt{font-size:1.0625rem}
p{margin-bottom:1.25rem}
.sidebarblock p,.sidebarblock dt,.sidebarblock td.content,p.tableblock{font-size:1em}
.exampleblock>.content{background-color:#fffef7;border-color:#e0e0dc;-webkit-box-shadow:0 1px 4px #e0e0dc;box-shadow:0 1px 4px #e0e0dc}
.print-only{display:none!important}
@media print{@page{margin:1.25cm .75cm}
*{-webkit-box-shadow:none!important;box-shadow:none!important;text-shadow:none!important}
a{color:inherit!important;text-decoration:underline!important}
a.bare,a[href^="#"],a[href^="mailto:"]{text-decoration:none!important}
a[href^="http:"]:not(.bare):after,a[href^="https:"]:not(.bare):after{content:"(" attr(href) ")";display:inline-block;font-size:.875em;padding-left:.25em}
abbr[title]:after{content:" (" attr(title) ")"}
pre,blockquote,tr,img,object,svg{page-break-inside:avoid}
thead{display:table-header-group}
svg{max-width:100%}
p,blockquote,dt,td.content{font-size:1em;orphans:3;widows:3}
h2,h3,#toctitle,.sidebarblock>.content>.title{page-break-after:avoid}
#toc,.sidebarblock,.exampleblock>.content{background:none!important}
#toc{border-bottom:1px solid #ddddd8!important;padding-bottom:0!important}
.sect1{padding-bottom:0!important}
.sect1+.sect1{border:0!important}
#header>h1:first-child{margin-top:1.25rem}
body.book #header{text-align:center}
body.book #header>h1:first-child{border:0!important;margin:2.5em 0 1em 0}
body.book #header .details{border:0!important;display:block;padding:0!important}
body.book #header .details span:first-child{margin-left:0!important}
body.book #header .details br{display:block}
body.book #header .details br+span:before{content:none!important}
body.book #toc{border:0!important;text-align:left!important;padding:0!important;margin:0!important}
body.book #toc,body.book #preamble,body.book h1.sect0,body.book .sect1>h2{page-break-before:always}
.listingblock code[data-lang]:before{display:block}
#footer{background:none!important;padding:0 .9375em}
#footer-text{color:rgba(0,0,0,.6)!important;font-size:.9em}
.hide-on-print{display:none!important}
.print-only{display:block!important}
.hide-for-print{display:none!important}
.show-for-print{display:inherit!important}}
</style>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css">
</head>
<body class="book">
<div id="header">
<h1>The ALAN Adventure Language Reference Manual</h1>
<div class="details">
<span id="revnumber">version 0.1.7,</span>
<span id="revdate">August 21, 2018</span>
<br><span id="revremark">AsciiDoc conversion work</span>
</div>
</div>
<div id="content">
<div id="preamble">
<div class="sectionbody">
<div class="literalblock">
<div class="content">
<pre>Doc version: 0.1.7
Last edited: August 21, 2018</pre>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">About This Document</div>
<div class="paragraph">
<p>This document was coverted to AsciiDoc and is being reformated by Tristano Ajmone; and it&#8217;s still a work-in-progress draft.
The above version number and date refer to the editing status of the conversion work (ie, this document), not to the original manual from which the present document was derived.</p>
</div>
<div class="paragraph">
<p>This document was converted from the original <em>Alan Manual</em> (in ODT format), version 3.0beta5 (August 9, 2018),
downloaded from:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://bitbucket.org/alanif/alan/src/fb81645/doc/manual/" class="bare">https://bitbucket.org/alanif/alan/src/fb81645/doc/manual/</a></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>This document is subjected to the <a href="https://bitbucket.org/alanif/alan/src/master/COPYING">Artistic License 2.0</a> terms.</p>
</div>
</div>
</div>
<div class="paragraph">
<p><span class="image"><img src="alan-logo.png" alt="Alan Logo" width="500" height="458"></span></p>
</div>
</div>
<div id="toc" class="toc">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="#trueintroduction">1. Introduction</a>
<ul class="sectlevel2">
<li><a href="#trueprogrammer-s-pitch">1.1. Programmer&#8217;s Pitch</a></li>
<li><a href="#trueto-the-reader">1.2. To the Reader</a></li>
</ul>
</li>
<li><a href="#trueconcepts">2. Concepts</a>
<ul class="sectlevel2">
<li><a href="#truewhat-is-an-adventure">2.1. What Is An Adventure?</a></li>
<li><a href="#trueelements-of-adventures">2.2. Elements Of Adventures</a></li>
<li><a href="#truealan-fundamentals">2.3. Alan Fundamentals</a>
<ul class="sectlevel3">
<li><a href="#truewhat-is-a-language">What Is A Language?</a></li>
<li><a href="#truethe-alan-idea">The Alan Idea</a></li>
<li><a href="#truewhat-s-happening">What&#8217;s Happening?</a></li>
<li><a href="#truethe-map">The Map</a></li>
<li><a href="#truethe-things">The Things</a></li>
<li><a href="#trueother-people-and-monsters">Other People and Monsters</a></li>
<li><a href="#trueacting">Acting</a></li>
<li><a href="#truethe-input">The Input</a></li>
</ul>
</li>
<li><a href="#trueintroduction-to-the-language">2.4. Introduction to the Language</a>
<ul class="sectlevel3">
<li><a href="#truenotation">Notation</a></li>
<li><a href="#truethe-locations">The Locations</a></li>
<li><a href="#truethe-objects">The Objects</a></li>
<li><a href="#truethe-actors">The Actors</a></li>
<li><a href="#trueinheritance-and-object-orientation">Inheritance and Object Orientation</a>
<ul class="sectlevel4">
<li><a href="#trueinheritance-and-instances">Inheritance and Instances</a></li>
<li><a href="#truepolymorphism">Polymorphism</a></li>
<li><a href="#trueevery-and-the">Every and The</a></li>
<li><a href="#truethe-pre-defined-classes">The Pre-defined Classes</a></li>
<li><a href="#truecreating-classes-and-instances">Creating Classes and Instances</a></li>
<li><a href="#truespecialising-and-overriding">Specialising and Overriding</a></li>
</ul>
</li>
<li><a href="#truecontainment-classes-and-transitivity">Containment , Classes and Transitivity</a>
<ul class="sectlevel4">
<li><a href="#truecontainers-containing-containers">Containers Containing Containers</a></li>
<li><a href="#truetransitivity">Transitivity</a></li>
</ul>
</li>
<li><a href="#truethe-verb-construct">The Verb Construct</a>
<ul class="sectlevel4">
<li><a href="#truechecking-things">Checking Things</a></li>
</ul>
</li>
<li><a href="#truethe-syntax">The Syntax</a></li>
<li><a href="#truetext-output-formatting">Text Output Formatting</a></li>
</ul>
</li>
<li><a href="#truestrict-and-safe">2.5. Strict and Safe</a></li>
</ul>
</li>
<li><a href="#truelanguage-reference">3. Language Reference</a>
<ul class="sectlevel2">
<li><a href="#truegeneral-rules">General Rules</a></li>
<li><a href="#truean-adventure">3.1. An Adventure</a></li>
<li><a href="#trueoptions">3.2. Options</a></li>
<li><a href="#truetypes">3.3. Types</a>
<ul class="sectlevel3">
<li><a href="#truebasic-simple-and-compound-types">Basic, Simple and Compound Types</a></li>
<li><a href="#trueinstance-type">Instance Type</a></li>
<li><a href="#trueevent-type">Event Type</a></li>
<li><a href="#trueset-type">Set Type</a></li>
<li><a href="#truetype-compatibility">Type Compatibility</a></li>
<li><a href="#truetype-requirements">Type Requirements</a></li>
</ul>
</li>
<li><a href="#trueimport">3.4. Import</a></li>
<li><a href="#trueclasses">3.5. Classes</a>
<ul class="sectlevel3">
<li><a href="#trueinheritance">Inheritance</a></li>
</ul>
</li>
<li><a href="#trueinstances">3.6. Instances</a>
<ul class="sectlevel3">
<li><a href="#trueentities">Entities</a></li>
<li><a href="#truethings">Things</a></li>
<li><a href="#trueobjects">Objects</a></li>
<li><a href="#trueactors">Actors</a>
<ul class="sectlevel4">
<li><a href="#truethe-hero">The Hero</a></li>
</ul>
</li>
<li><a href="#truelocations">Locations</a></li>
<li><a href="#trueliterals">Literals</a></li>
</ul>
</li>
<li><a href="#trueproperties">3.7. Properties</a>
<ul class="sectlevel3">
<li><a href="#trueinheriting-properties">Inheriting Properties</a></li>
<li><a href="#trueinitial-location">Initial Location</a></li>
<li><a href="#truenames">Names</a>
<ul class="sectlevel4">
<li><a href="#trueinheriting-names">Inheriting Names</a></li>
<li><a href="#truedisplaying-instances">Displaying Instances</a></li>
</ul>
</li>
<li><a href="#truepronouns">Pronouns</a></li>
<li><a href="#trueattributes">Attributes</a>
<ul class="sectlevel4">
<li><a href="#trueboolean-attributes">Boolean Attributes</a></li>
<li><a href="#truenumeric-and-string-attributes">Numeric and String Attributes</a></li>
<li><a href="#trueevent-attributes">Event Attributes</a></li>
<li><a href="#truereference-attributes">Reference Attributes</a></li>
<li><a href="#trueset-type-attributes">Set Type Attributes</a></li>
<li><a href="#trueinheriting-attributes">Inheriting Attributes</a></li>
</ul>
</li>
<li><a href="#trueinitialize">Initialize</a></li>
<li><a href="#truedescription">Description</a></li>
<li><a href="#truearticles-and-forms">Articles and Forms</a>
<ul class="sectlevel4">
<li><a href="#truearticles">Articles</a></li>
<li><a href="#trueform">Form</a></li>
<li><a href="#trueprinting">Printing</a></li>
<li><a href="#truementioned">Mentioned</a></li>
</ul>
</li>
<li><a href="#truecontainer-properties">Container Properties</a>
<ul class="sectlevel4">
<li><a href="#truelimits">Limits</a></li>
<li><a href="#trueheader-and-else">Header and Else</a></li>
<li><a href="#trueextract">Extract</a></li>
</ul>
</li>
<li><a href="#trueverbs">Verbs</a></li>
<li><a href="#trueentered">Entered</a></li>
<li><a href="#trueexits">Exits</a></li>
<li><a href="#truescripts">Scripts</a>
<ul class="sectlevel4">
<li><a href="#truesteps">Steps</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#trueadditions">3.8. Additions</a></li>
<li><a href="#truesyntax-definitions">3.9. Syntax Definitions</a>
<ul class="sectlevel3">
<li><a href="#trueindicators">Indicators</a></li>
<li><a href="#trueparameter-restrictions">Parameter Restrictions</a></li>
<li><a href="#truesyntax-synonyms">Syntax Synonyms</a></li>
<li><a href="#truedefault-syntax">Default Syntax</a></li>
<li><a href="#truescope">Scope</a></li>
</ul>
</li>
<li><a href="#trueverbs-2">3.10. Verbs</a>
<ul class="sectlevel3">
<li><a href="#truemeta-verbs">Meta Verbs</a></li>
<li><a href="#trueverbs-in-locations">Verbs in Locations</a></li>
<li><a href="#trueverb-checks">Verb Checks</a></li>
<li><a href="#truedoes-clause">Does-clause</a></li>
<li><a href="#trueverb-alternatives">Verb Alternatives</a></li>
<li><a href="#trueverb-qualification">Verb Qualification</a></li>
<li><a href="#trueverb-execution">Verb Execution</a>
<ul class="sectlevel4">
<li><a href="#truecontrolling-execution-with-qualifiers">Controlling Execution with Qualifiers</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#trueevents">3.11. Events</a></li>
<li><a href="#truerules">3.12. Rules</a></li>
<li><a href="#truesynonyms">3.13. Synonyms</a></li>
<li><a href="#truemessages">3.14. Messages</a>
<ul class="sectlevel3">
<li><a href="#truemessage-parameters">Message parameters</a></li>
</ul>
</li>
<li><a href="#trueprompt-section">3.15. Prompt Section</a></li>
<li><a href="#truestart-section">3.16. Start Section</a></li>
<li><a href="#truestatements">3.17. Statements</a>
<ul class="sectlevel3">
<li><a href="#trueoutput-statements">Output Statements</a>
<ul class="sectlevel4">
<li><a href="#truestring-statement">String Statement</a></li>
<li><a href="#truestyle-statement">Style Statement</a></li>
<li><a href="#truedescribe-statement">Describe Statement</a></li>
<li><a href="#truesay-statement">Say Statement</a></li>
<li><a href="#truelist-statement">List Statement</a></li>
</ul>
</li>
<li><a href="#truemulti-media-statements">Multi-media Statements</a>
<ul class="sectlevel4">
<li><a href="#trueshow-statement">Show Statement</a></li>
<li><a href="#trueplay-statement">Play Statement</a></li>
</ul>
</li>
<li><a href="#truemanipulation-statements">Manipulation Statements</a>
<ul class="sectlevel4">
<li><a href="#truelocate-statement">Locate Statement</a></li>
<li><a href="#trueempty-statement">Empty Statement</a></li>
<li><a href="#truestrip-statement">Strip Statement</a></li>
</ul>
</li>
<li><a href="#trueevent-statements">Event Statements</a>
<ul class="sectlevel4">
<li><a href="#trueschedule-statement">Schedule Statement</a></li>
<li><a href="#truecancel-statement">Cancel Statement</a></li>
</ul>
</li>
<li><a href="#trueassignment-statements">Assignment Statements</a>
<ul class="sectlevel4">
<li><a href="#truemake-statement">Make Statement</a></li>
<li><a href="#trueincrease-and-decrease-statements">Increase and Decrease Statements</a></li>
<li><a href="#trueset-statement">Set Statement</a></li>
<li><a href="#trueinclude-statement">Include Statement</a></li>
<li><a href="#trueexclude-statement">Exclude Statement</a></li>
</ul>
</li>
<li><a href="#trueconditional-statements">Conditional Statements</a>
<ul class="sectlevel4">
<li><a href="#trueif-statement">If Statement</a></li>
<li><a href="#truedepending-on-statement">Depending On Statement</a></li>
</ul>
</li>
<li><a href="#trueactor-statements">Actor Statements</a>
<ul class="sectlevel4">
<li><a href="#trueuse-statement">Use Statement</a></li>
<li><a href="#truestop-statement">Stop Statement</a></li>
<li><a href="#truerepetition-statements">Repetition Statements</a></li>
</ul>
</li>
<li><a href="#truespecial-statements">Special Statements</a>
<ul class="sectlevel4">
<li><a href="#truequit-statement">Quit Statement</a></li>
<li><a href="#truelook-statement">Look Statement</a></li>
<li><a href="#truesave-and-restore-statements">Save and Restore Statements</a></li>
<li><a href="#truescore-statement">Score Statement</a></li>
<li><a href="#truevisits-statement">Visits Statement</a></li>
<li><a href="#truetranscript-statement">Transcript Statement</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#truewhere-specifications">3.18. WHERE Specifications</a></li>
<li><a href="#truewhat-specifications">3.19. WHAT Specifications</a></li>
<li><a href="#trueexpressions">3.20. Expressions</a>
<ul class="sectlevel3">
<li><a href="#truetypes-of-expressions">Types of Expressions</a></li>
<li><a href="#trueliteral-values">Literal Values</a></li>
<li><a href="#trueattribute-references">Attribute References</a>
<ul class="sectlevel4">
<li><a href="#truelocation-of">Location Of</a></li>
</ul>
</li>
<li><a href="#truerandom-values">Random Values</a></li>
<li><a href="#truelogical-expressions">Logical Expressions</a></li>
<li><a href="#trueclass-expressions">Class Expressions</a></li>
<li><a href="#truebinary-operators">Binary Operators</a></li>
<li><a href="#truerelational-and-equality-operators">Relational and Equality Operators</a></li>
<li><a href="#truestring-containment">String Containment</a></li>
<li><a href="#truecurrent-entities">Current Entities</a></li>
<li><a href="#truethis-instance">This Instance</a></li>
<li><a href="#truethe-whereabouts-of-an-entity">The Whereabouts of an Entity</a></li>
<li><a href="#trueaggregates">Aggregates</a></li>
</ul>
</li>
<li><a href="#truefilters">3.21. Filters</a></li>
</ul>
</li>
<li><a href="#truelexical-definitions">4. Lexical Definitions</a>
<ul class="sectlevel2">
<li><a href="#truecomments">4.1. Comments</a></li>
<li><a href="#truewords-identifiers-and-names">4.2. Words, Identifiers and Names</a></li>
<li><a href="#truenumbers">4.3. Numbers</a></li>
<li><a href="#truestrings">4.4. Strings</a></li>
<li><a href="#truefilenames">4.5. Filenames</a></li>
</ul>
</li>
<li><a href="#truerunning-an-adventure">5. Running An Adventure</a>
<ul class="sectlevel2">
<li><a href="#truea-turn-of-events">5.1. A Turn of Events</a></li>
<li><a href="#trueplayer-input">5.2. Player Input</a></li>
<li><a href="#truerun-time-contexts">5.3. Run-time Contexts</a></li>
<li><a href="#truemoving-actors">5.4. Moving Actors</a></li>
<li><a href="#trueundoing">5.5. Undoing</a></li>
<li><a href="#truescripting-and-commenting">5.6. Scripting and Commenting</a></li>
</ul>
</li>
<li><a href="#truehints-and-tips">6. Hints And Tips</a>
<ul class="sectlevel2">
<li><a href="#trueuse-of-attributes">6.1. Use of Attributes</a></li>
<li><a href="#truedescriptions">6.2. Descriptions</a></li>
<li><a href="#truecommon-verbs">6.3. Common Verbs</a></li>
<li><a href="#truedistant-events">6.4. Distant Events</a></li>
<li><a href="#truedoors">6.5. Doors</a></li>
<li><a href="#truequestions-and-answers">6.6. Questions and Answers</a></li>
<li><a href="#trueactors-2">6.7. Actors</a></li>
<li><a href="#truevehicles">6.8. Vehicles</a></li>
<li><a href="#truefloating-objects">6.9. Floating Objects</a>
<ul class="sectlevel3">
<li><a href="#truebody-parts">Body Parts</a></li>
<li><a href="#trueoutdoors-and-indoors">Outdoors and Indoors</a></li>
<li><a href="#truenested-locations-as-a-solution">Nested Locations as a Solution</a></li>
</ul>
</li>
<li><a href="#truedarkness-and-light-sources">6.10. Darkness and Light Sources</a></li>
<li><a href="#truedistant-imaginary-objects">6.11. Distant &amp; Imaginary Objects</a>
<ul class="sectlevel3">
<li><a href="#truea-mountain">A Mountain</a></li>
<li><a href="#truethe-melody">The Melody</a></li>
</ul>
</li>
<li><a href="#trueusing-events-as-functions">6.12. Using Events as Functions</a></li>
<li><a href="#truestructure">6.13. Structure</a></li>
<li><a href="#truedebugging">6.14. Debugging</a>
<ul class="sectlevel3">
<li><a href="#truecommand-logs-and-game-transcripts">Command Logs and Game Transcripts</a></li>
<li><a href="#trueinterpreter-and-instruction-trace">Interpreter and Instruction Trace</a></li>
<li><a href="#truedebug-mode">Debug mode</a></li>
<li><a href="#trueusing-the-debugger">Using the Debugger</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#trueadventure-construction">7. Adventure Construction</a>
<ul class="sectlevel2">
<li><a href="#truegetting-an-idea">7.1. Getting an Idea</a></li>
<li><a href="#trueelaborating-the-story">7.2. Elaborating the Story</a></li>
<li><a href="#trueimplementing-it">7.3. Implementing it</a></li>
<li><a href="#truepolishing-the-adventure">7.4. Polishing the Adventure</a></li>
<li><a href="#truebeta-testing">7.5. Beta Testing</a></li>
</ul>
</li>
<li><a href="#truehow-to-use-the-system">Appendix A: How To Use The System</a></li>
<li><a href="#truea-sample-interaction">Appendix B: A Sample Interaction</a></li>
<li><a href="#truerun-time-messages">Appendix C: Run-time Messages</a>
<ul class="sectlevel2">
<li><a href="#trueplayer-errors">C.1. Player Errors</a></li>
<li><a href="#trueauthor-errors">C.2. Author Errors</a></li>
<li><a href="#trueimplementor-errors">C.3. Implementor Errors</a></li>
</ul>
</li>
<li><a href="#truelanguage-grammar">Appendix D: Language Grammar</a>
<ul class="sectlevel2">
<li><a href="#truekeywords">D.1. Keywords</a></li>
</ul>
</li>
<li><a href="#truepredefined-player-words">Appendix E: Predefined player words</a>
<ul class="sectlevel2">
<li><a href="#trueenglish">E.1. English</a></li>
<li><a href="#trueswedish">E.2. Swedish</a></li>
<li><a href="#truegerman">E.3. German</a></li>
</ul>
</li>
<li><a href="#truecompiler-messages">Appendix F: Compiler Messages</a></li>
<li><a href="#truelocalization">Appendix G: Localization</a></li>
<li><a href="#trueportability-of-games">Appendix H: Portability of Games</a></li>
<li><a href="#truecopying-conditions">Appendix I: Copying Conditions</a></li>
<li><a href="#trueindex">8. INDEX</a></li>
</ul>
</div>
</div>
<div class="sect1">
<h2 id="trueintroduction"><a class="anchor" href="#trueintroduction"></a>1. Introduction</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Text adventures or, using a more appropriate term, interactive fiction, is a form of computer game which has many things in common with fiction in book form, role-playing games and puzzle-solving. To create a high quality interactive fiction game, you need to be more of an author than a programmer.</p>
</div>
<div class="paragraph">
<p>Alan is a special purpose computer language specifically designed to make it very easy to create such adventure games requiring only limited programming skills.</p>
</div>
<div class="paragraph">
<p>The main principle of the design of the language is simplicity. That is, it should be very easy to do common things, but it should also be possible to do more complicated things by constructs that are more complex. This means that wherever a construct is optional, the system supplies some sensible default.</p>
</div>
<div class="paragraph">
<p>The author and a very good friend designed the first crude version of the Alan language in 1985. During many years of incremental improvement and use, it has now reached its third major version. This means that the language has a sound foundation, based on practical use. Therefore, features have been added as experience have grown, from actual use and understanding of the most prioritised needs.</p>
</div>
<div class="paragraph">
<p>In this version modern and novel object orientation features has been incorporated into the language that allows definition of classes, instantiation and inheritance of attributes and other features. Do not worry if you find these terms incomprehensible at this point, Alan is still an easy language to use and by reading this manual, you will understand how these new features may aid you in your quest for adventures.</p>
</div>
<div class="sect2">
<h3 id="trueprogrammer-s-pitch"><a class="anchor" href="#trueprogrammer-s-pitch"></a>1.1. Programmer&#8217;s Pitch</h3>
<div class="paragraph">
<p>Alan is an application-oriented language. It features constructs that are natural to an author of Interactive Fiction. Alan is a strictly typed, compiled, object-oriented language with single inheritance. Classes inherit properties from their super-classes. The class system allows polymorphism so that instances of subclasses are valid wherever a super-class is specified. There are no explicit type declarations, except for instances of classes; instead, types are automatically inferred from expressions such as integers, strings or instances of a particular class.</p>
</div>
</div>
<div class="sect2">
<h3 id="trueto-the-reader"><a class="anchor" href="#trueto-the-reader"></a>1.2. To the Reader</h3>
<div class="paragraph">
<p>There are probably four major types of readers of this document:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Readers completely new to interactive fiction – read the whole document from the beginning.</p>
</li>
<li>
<p>Readers familiar with writing Interactive Fiction but new to Alan – read from section 2.4 onwards.</p>
</li>
<li>
<p>Alan v2 users wanting to upgrade – you should read the separate document on conversion, then section <em>2.4</em> and onwards, with frequent use of chapter <em>3</em> as a reference while doing your conversion.</p>
</li>
<li>
<p>Alan v3 users looking for detailed answers – use the index, look up the relevant sections in chapter <em>3</em> but also glance through chapter <em>2</em> from section <em>2.4</em>. Visit <a href="http://www.alanif.se/"><em>http://www.alanif.se</em></a> for a collection of examples.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>All readers are encouraged to give feedback on the documentation, particularly if you could not find the answer to what you were looking for by using the index, the table of content or skimming through what you thought might be relevant parts of the documentation. You can find the authors through the web page <a href="http://www.alanif.se/"><em>http://www.alanif.se</em></a>, where you also can enrol in the Alan mailing list, a place for new and seasoned Alan users alike!</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="trueconcepts"><a class="anchor" href="#trueconcepts"></a>2. Concepts</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This chapter introduces the concepts used in the Alan language. You might already have a good idea about these things, especially if you are a seasoned adventure player, and perhaps even author.</p>
</div>
<div class="paragraph">
<p>But I would suggest that you read through it anyway since it introduces some important concepts that are specific to how Alan treats them.</p>
</div>
<div class="sect2">
<h3 id="truewhat-is-an-adventure"><a class="anchor" href="#truewhat-is-an-adventure"></a>2.1. What Is An Adventure?</h3>
<div class="paragraph">
<p>As long as man has been around there have been stories, fairy tales and fantasies. In the early days, storytellers told their stories to silent and astonished audiences. After Gutenberg, the stories were printed and the readers partook in the fantasies of the author. In our days, passive viewers are fed from the silver screen or through the tube.</p>
</div>
<div class="paragraph">
<p>In our time, at last, there has evolved a way for the &#8220;audience&#8221; to take part in the story themselves. It started in the forties and fifties and continued to develop into the games today known as Dungeon and Dragons, Tunnels and Trolls, etc. Games where a game leader designs the story, but the players decide (and perform) the actions of the characters in the story.</p>
</div>
<div class="paragraph">
<p>These games, of course, have a computerized counterpart.</p>
</div>
<div class="paragraph">
<p>These games are played interacting with the computer. The program describes a scene or situation (usually in text, but pictures may also be used), the player decides on some action and gives orders to the computer to carry out his wishes. Usually there are objects to manipulate, traps to negotiate and puzzles to solve, the object being to find the hidden treasures or save the world.</p>
</div>
<div class="paragraph">
<p>Crowther &amp; Woods started this form of games in the late sixties when they designed the famous <em>Colossal Cave Adventure,</em> which became available on many mainframe computer systems. Inspired by this, Lebling et.al (then at MIT) took a giant step forward in adventuring by creating the Great Underground Empire and making it available for venturing Adventurers in the game Dungeon. This game contained a much more developed story and could handle much more complex commands.</p>
</div>
<div class="paragraph">
<p>Later, Dave Lebling &amp; Co started Infocom, a company where they continued to develop their technique, first with <em>Zork I</em>, <em>II</em> and <em>III</em> (the first a re-implementation of Dungeon, the others equally successful sequels). Since then, a host of games has been released (<em>Starcross</em>, <em>Witness</em>, <em>Enchanter</em> are some of the names that come to mind). Although the original authors are long scattered, the Infocom games are still highly appreciated even today.</p>
</div>
<div class="paragraph">
<p>Other companies have followed Infocom&#8217;s example and a handful of them seem to make a living out of creating adventure games. However, today most of the works are created by devoted people that do it for the fun of it, releasing their games as shareware or completely free.</p>
</div>
<div class="paragraph">
<p>There have been many attempts to use computer graphics to display the surroundings and objects in adventure games. Some of the more successful early examples are the Sierra games (notably the <em>Leisure Suit Larry</em> and the <em>Kings Quest</em> series) which had mouse oriented moves but also allowed single line text commands, games from ICOM Simulations (<em>DejaVu</em> and <em>The Uninvited</em>) which were purely graphics games with mouse and icon interfaces. Other manufacturers have tried to use (sometimes optional) pictures to accompany the text, for example Magnetic Scrolls games (e.g. <em>the Pawn</em>), which shift the picture automatically as you move around using the normal directional commands.</p>
</div>
<div class="paragraph">
<p>Currently, a community of addicted authors and players of text-based adventure games are still out there. Visit the vaults of interactive fiction on the Internet, and you will be surprised by the abundance of modern, high quality interactive fiction available.</p>
</div>
<div class="paragraph">
<p>The Alan Adventure Language has been designed to aid construction primarily of pure text adventures or, in the words of Infocom, interactive fiction. Some sound and graphics functions are also available to spice up your game if you so desire.</p>
</div>
<div class="paragraph">
<p>The main feature of adventures is the interaction between the player and the game through commands input through the keyboard and descriptions printed on the screen. In Appendix <em>B</em> you can find such a sample interaction.</p>
</div>
</div>
<div class="sect2">
<h3 id="trueelements-of-adventures"><a class="anchor" href="#trueelements-of-adventures"></a>2.2. Elements Of Adventures</h3>
<div class="paragraph">
<p>The success of all Infocom games can probably be attributed to three distinctive features. First, they all have a &#8216;believable&#8217; and consistent plot, which is flavoured with humour and wittiness. Second, the descriptions are extensive and give a lot of atmosphere to the game. Third, the command handler recognizes and understands a large vocabulary and complex input. Add to this the worlds best graphics device (the human brain) and you are unbeatable!</p>
</div>
<div class="paragraph">
<p>Looking at adventures in more detail, we can see some common features. There is always the world or universe (called the map) where the adventure is taking place. Although you can move around quite freely there are usually some problems getting into certain parts of the world (e.g. locked doors, no air to breathe or even finding the entrance). The size of the map ranges from hundreds of locations to just two or three, or even a single location.</p>
</div>
<div class="paragraph">
<p>Then, there are the objects in the game. These range from your tools, like lamps and shovels, to immaterial things like a hole in the ground, in short, anything you can manipulate. Ideally, everything that is mentioned in a description should be an object, but this is normally impossible because of storage limits (and perhaps the stamina of the games designer!).</p>
</div>
<div class="paragraph">
<p>Most objects have uses. You can easily guess how to use a key, but what about the velvet pillow? Red herring objects are also common in adventuring.</p>
</div>
<div class="paragraph">
<p>The player must be able to express his wishes. Complete understanding of natural language commands from the player is probably overkill, but single verb-object input is not sufficient for a good game either. The player must be able to say things like</p>
</div>
<div class="exampleblock gametranscript">
<div class="content">
<div class="paragraph">
<p>&gt; take all except the blue vase</p>
</div>
</div>
</div>
<div class="paragraph">
<p>or</p>
</div>
<div class="exampleblock gametranscript">
<div class="content">
<div class="paragraph">
<p>&gt; put the ring and the bag in the box</p>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="truealan-fundamentals"><a class="anchor" href="#truealan-fundamentals"></a>2.3. Alan Fundamentals</h3>
<div class="paragraph">
<p>Alan is all about adventure games, or interactive fiction. In this manual, we will use both terms interchangeably since they convey two slightly different views on the purpose. But the technical platform, the Alan language and its support system, is the same, works the same and looks the same, regardless if you are designing a treasure hunt featuring an elaborate combat and hit point system or if you are competing with Sir William Shakespeare himself.</p>
</div>
<div class="sect3">
<h4 id="truewhat-is-a-language"><a class="anchor" href="#truewhat-is-a-language"></a>What Is A Language?</h4>
<div class="paragraph">
<p>A computer language is usually described as a set of rules for textual instructions for a computer. The idea is that a computer can follow those rules and perform the necessary and/or intended actions.</p>
</div>
<div class="paragraph">
<p>The Alan Adventure Language is a high-level computer language designed to make it easy to create text adventures. This means that the language have been designed so that the textual instructions are relatively easy to read and write if you understand the mechanisms that adventures are made from. In addition, it requires only for minimal additional instructions to make those mechanisms work.</p>
</div>
<div class="paragraph">
<p>Compared to programming in a typical programming language, the Alan system handles most of the tiresome tasks and supplies reasonable defaults so that you can concentrate on the plot, the puzzles, the objects and the map. This makes Alan a true high-level computer language.</p>
</div>
<div class="paragraph">
<p>The Alan <em>system</em> consists of two computer programs, one of which analyses an input following (or at least intended to follow) the Alan <em>language</em>. This program is called the <em>compiler</em> and the analysis ensures that the input (the game description, in fact) makes sense. The compiler also, at the same time, converts the input into something more compact, the game file. This game file can be transferred and used without the compiler. Instead, to run an adventure the <em>interpreter</em> is needed. The interpreter is another program that reads the information in the game file, communicates with the player of the game (or reader of the work, if you like) and interprets all the complex mechanisms in your game logic so that it gives the player the illusion of the activities and events that you have designed.</p>
</div>
<div class="paragraph">
<p>To create works of interactive fiction using Alan, you also need a program with which to construct your Alan source code, a standard text editor, like Notepad or similar programs. However, you cannot use a word processor, like Microsoft Word, since the files created with those usually contains formatting information that the Alan compiler don&#8217;t understand.</p>
</div>
<div class="paragraph">
<p>There are also special editors, or additions to standard editors, available, which supports Alan coding and helps with formatting and even compiling and running your game.</p>
</div>
<div class="paragraph">
<p>You might wonder why the game is not a single executable program. The answer is simple, compare the game with a Word-document. In order for the document to be visible, you need the Word-program that reads the Word-file and displays the content on the screen. As you probably know, the same program does not run on all computers. For example, you cannot install Word for Windows on a Macintosh.</p>
</div>
<div class="paragraph">
<p>In view of this, it might be considered a nice thing that there are programs for Macintosh that read, display and print Word-documents. This makes the document files portable. Once you have a reading program on your computer, you can use all similar files on it. This is also one reason behind the compiler-interpreter design of Alan.</p>
</div>
</div>
<div class="sect3">
<h4 id="truethe-alan-idea"><a class="anchor" href="#truethe-alan-idea"></a>The Alan Idea</h4>
<div class="paragraph">
<p>The Alan language does not focus on variables, subroutines or other traditional programming constructs, because Alan is not primarily a <em>programming</em> language. Instead, Alan takes a descriptive view of the concepts of adventure authoring. The Alan language contains constructs that make it possible for you, the author, to describe the various features of these concepts. By describing for example, how the locations in the adventure are connected you have described the geography in which the story will take place. Much of what should be described is in terms of ordinary text shown to make the player experience the story that you have designed by reading them.</p>
</div>
<div class="paragraph">
<p>You will still need to understand how to vary your output depending on various conditions or information, how the player input controls which events will happen, how to connect one location to another and how to store information for later use. In a way this is programming, but in an unusual sense.</p>
</div>
<div class="paragraph">
<p>In order to understand the rules of the Alan language, which this manual is all about, it is necessary to first establish some common ground. As an author you will have to have the same view as the Alan language has on some fundamentals of what a work of interactive fiction is all about.</p>
</div>
</div>
<div class="sect3">
<h4 id="truewhat-s-happening"><a class="anchor" href="#truewhat-s-happening"></a>What&#8217;s Happening?</h4>
<div class="paragraph">
<p>The execution of an adventure is primarily driven by the input of player commands. A command is analysed by the interpreter program according to the player command syntax allowed by the author and, if understood, transformed into execution of verbs or movements, which in turn may trigger other parts in the game as described in the Alan source. After a player turn, other, scripted non-player characters or actors, can move, controlled by the computer, again according to the definitions in the source. Scheduled events are then run, and then the player takes another turn. This is described in more detailed in section <em>5.1</em>, <em>A Turn of Events</em> on page <em>159</em>.</p>
</div>
<div class="paragraph">
<p>The following sections describe a number of the fundamental concepts that are present in an adventure game and what the Alan view of them is.</p>
</div>
</div>
<div class="sect3">
<h4 id="truethe-map"><a class="anchor" href="#truethe-map"></a>The Map</h4>
<div class="paragraph">
<p>The scene for the game is a map of a number of connected locations. A location has a description that is presented to the player when that location is entered. A location may also have a number of exits stating in which direction there are exits and to which locations they lead. Alan places no restrictions on the layout of the map, any topology is allowed.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>In Alan, exits are always one-way, and an explicit declaration of a backward path (if such is desired) must be made. Although, normally you would probably want them to be two-way, if they where automatically two-way, it would be very hard to handle the rare, but important, cases when you want them to not be.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="truethe-things"><a class="anchor" href="#truethe-things"></a>The Things</h4>
<div class="paragraph">
<p>Most objects in an adventure are things that in real life would be objects too, like a knife or a key. In addition, other things that should be possible to manipulate by the player, e.g. parts of the scenery, must be declared as an object. For example if you require the player to &#8216;whistle the melody&#8217;, then the melody must be an Alan object.</p>
</div>
<div class="paragraph">
<p>Objects, like locations, have a description that is presented when they are encountered during the game.</p>
</div>
<div class="paragraph">
<p>Every object may also have a set of properties, like edible and movable, which may be changed during the execution of an Alan program. Most objects would e.g. probably not be edible so there is also a mechanism for declaring how these properties should be set by default, as well as mechanisms to override them, both for a particular object and for groups of objects.</p>
</div>
<div class="paragraph">
<p>Some player actions (verbs) have special meaning or effects when applied to a certain object. These verbs and their special effects are also declared within the object declaration.</p>
</div>
</div>
<div class="sect3">
<h4 id="trueother-people-and-monsters"><a class="anchor" href="#trueother-people-and-monsters"></a>Other People and Monsters</h4>
<div class="paragraph">
<p>An extra thrill and dimension are additional characters in the game. In Alan, these are called actors and may have a life of their own. For each move the player makes, these programmed characters also get a turn to do their thing. An actor may be a thief running around and stealing your collected treasures or a dragon guarding the entrance to its lair.</p>
</div>
<div class="paragraph">
<p>Actors get their behaviour from scripts that step, by step, describes what is going to happen for each player interaction.</p>
</div>
<div class="paragraph">
<p>One of the interesting things about playing adventure games with actors is to figure out how to interact with and influence the other characters.</p>
</div>
</div>
<div class="sect3">
<h4 id="trueacting"><a class="anchor" href="#trueacting"></a>Acting</h4>
<div class="paragraph">
<p>The player commands action by typing imperative statements. These statements are analysed and results in execution (&#8220;calls&#8221;) to verbs. The effects of these commands must be declared in verbs by the game author, either in an object (describing the effects of the verb when applied to an object) or as a general (global) verb that only applies without object.</p>
</div>
</div>
<div class="sect3">
<h4 id="truethe-input"><a class="anchor" href="#truethe-input"></a>The Input</h4>
<div class="paragraph">
<p>To make it possible for the player to input more complex commands a means to specify the syntax for a verb is also available. A particular syntax is connected to a verb and describes how the player must phrase his input in order to command the triggering of a particular verb. Using this mechanism, verbs can also be made to operate on literals (strings and integers) giving the player the possibility to input things like</p>
</div>
<div class="exampleblock gametranscript">
<div class="content">
<div class="paragraph">
<p>&gt; write "Merry Christmas, Mr. Lawrence" on the xmas card</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="trueintroduction-to-the-language"><a class="anchor" href="#trueintroduction-to-the-language"></a>2.4. Introduction to the Language</h3>
<div class="paragraph">
<p>Alan is an adventure language, i.e. a language designed to make it easy to write adventures. This means that constructs in the Alan language reflects the various concepts encountered when creating an adventure plot.</p>
</div>
<div class="paragraph">
<p>A common step after having come up with a plot for your adventure is to draw a map of the world where the adventure is taking place. For this purpose, we use <code>Location</code>s.</p>
</div>
<div class="paragraph">
<p>The next step is to introduce tools, weapons and other objects possible to manipulate. These are the <code>Object</code>s.</p>
</div>
<div class="paragraph">
<p>Then the player will need words to command action. The Alan language construct to supply these with is the <code>Verb</code>. Using the <code>Syntax</code> construct, you can also define more complex player input.</p>
</div>
<div class="paragraph">
<p>Additionally, you may also want other characters and creatures in your adventure. For this the <code>Actor</code> class is provided.</p>
</div>
<div class="sect3">
<h4 id="truenotation"><a class="anchor" href="#truenotation"></a>Notation</h4>
<div class="paragraph">
<p>In this document, there are some typographical clues. Example Alan source code is typeset in separate sections with a mono-spaced font:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>This is an example of some source code.</pre>
</div>
</div>
<div class="paragraph">
<p>You will also encounter sample game-play which will be formatted using a surrounding border (like paper&#8230;&#8203;) thus:</p>
</div>
<div class="exampleblock gametranscript">
<div class="content">
<div class="paragraph">
<p><strong>Grandma&#8217;s House</strong><br>
You are outside your grandma&#8217;s house.</p>
</div>
</div>
</div>
<div class="paragraph">
<p>Later in the manual, you will find semi-formal definitions, grammar rules, for how various constructs may be constructed. These sections are typeset against a coloured background:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>The rules for the rules are available in Appendix _L_ on page _221_.</pre>
</div>
</div>
<div class="paragraph">
<p>In running text, words that are keywords or signify an Alan construct is written in a mono-spaced, bold, font. This helps distinguish the English word &#8216;the&#8217; from the Alan keyword <code>The</code>.</p>
</div>
<div class="paragraph">
<p>As shown in the last example, Alan keywords are written with the first letter capitalized. This is simply a convention and has no effect other than the visual. A keyword can be written <code>Keyword</code>, <code>KEYWORD</code>, <code>keyword</code>, or even <code>KeYwOrD</code> (if you are keen to show how good you are with a keyboard…). This manual tries to be consistent with using the first version (except in grammar rules).</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>And this is a note!</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="truethe-locations"><a class="anchor" href="#truethe-locations"></a>The Locations</h4>
<div class="paragraph">
<p>The scene for your adventure is a series of &#8220;rooms&#8221; or, rather, locations. Locations are connected by exits, leading out of one location into another. This makes it possible for the hero to travel through the world of your design, exploring it and solving the puzzles.</p>
</div>
<div class="paragraph">
<p>What is required if we want to describe a location? Every location must have an identifier. This is so that you, the designer, may refer to that location easily, instead of having to remember a magic number for it.</p>
</div>
<div class="paragraph">
<p>Unless you plan to provide other means for transportation from a location, you should also describe in which directions there are <code>Exit</code>s and to which locations they lead.</p>
</div>
<div class="paragraph">
<p>In fact, this is all that is necessary in a location, so lets look at an example.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-alan" data-lang="alan">The kitchen IsA location
  Exit east To hallway.
End The Kitchen.

The hallway IsA location
  Exit west To kitchen.
End The hallway.

Start At kitchen.</code></pre>
</div>
</div>
<div class="paragraph">
<p>This is a complete Alan adventure (although very primitive). As you see, every Alan construct ends with a period (<code>.</code>) and there is a &#8220;<code>Start At</code>&#8221; sentence at the end, indicating in which location to put the hero when the game starts.</p>
</div>
<div class="paragraph">
<p>Type the above text into a text file, e.g. using a notepad program. Run this little Alan source through the Alan compiler and try the adventure (see Appendix <em>A</em>, <em>How To Use The System</em>, on page <em>202</em> on how to do this). After starting the adventure, two lines will be shown on your screen.</p>
</div>
<div class="exampleblock gametranscript">
<div class="content">
<div class="paragraph">
<p><strong>Kitchen</strong></p>
</div>
<div class="paragraph">
<p>&gt;</p>
</div>
</div>
</div>
<div class="paragraph">
<p>The first line contains &#8220;Kitchen&#8221;, the name of the initial location, and the second a &#8220;&gt;&#8221;, which is the default prompt for the player to input a command. Now try typing &#8220;east&#8221; and press the return/enter key. The word &#8220;Hallway&#8221; and the prompt will appear. Typing &#8220;west&#8221; will take you back to &#8220;Kitchen&#8221; again. (Use Ctrl-C to exit the game if you are running it in a console window.)</p>
</div>
<div class="paragraph">
<p>The identifier for a location is automatically used as a description, a heading, shown when that room is entered. And the words listed in the <code>Exit</code>-parts are translated into directional commands the player can use in his input.</p>
</div>
<div class="paragraph">
<p>You should remember that exits are strictly one-way. An <code>Exit</code> from one location to another does not automatically imply the opposite path. Thus, you must explicitly declare the path back, in the definition of the other location.</p>
</div>
<div class="paragraph">
<p>However, just the name of the location is not much of a description. So in order to provide the &#8220;purple prose&#8221; descriptions often found in many adventures there is an optional <code>Description</code>-clause that you can use. Let us describe the Hallway.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-alan" data-lang="alan">The hallway IsA location
  Description
    "In front of you is a long hallway. In one end
     is the front door, in the other a doorway. From
     the smell of things the doorway leads to the
     Kitchen."
  Exit west To kitchen.
End The hallway.</code></pre>
</div>
</div>
<div class="paragraph">
<p>We introduce another feature in this example, namely the text enclosed in double quotation marks (") which is called a <strong>String</strong> or, when used on its own like this, an output statement. When executed this string will be presented to the player and formatted to suit the format of his screen.</p>
</div>
<div class="paragraph">
<p>Invent a description for the Kitchen, enter it in the Alan source and run the changed adventure. You notice, of course, that the text in the output statements is reformatted during output to suit your screen, in order to make room for as much text as possible. Note also that you do not have to worry about this at all - in your source file, you may format the text any way you like, even spanning multiple lines with extra white-space included.</p>
</div>
<div class="paragraph">
<p>This type of output statement is just one of the statements in the Alan Language, and we will see more of them later.</p>
</div>
<div class="paragraph">
<p>It is also possible to have conditions and statements in the <code>Exit</code>-clauses of a <code>Location</code> to restrict the access to the next location or to describe what happens during this movement.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-alan" data-lang="alan">Exit west To kitchen
  Check kitchen_door Is open
    Else "The door is closed."
  Does
    "As you enter the kitchen the smell of
     something burning is getting stronger."
End Exit west.</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="truethe-objects"><a class="anchor" href="#truethe-objects"></a>The Objects</h4>
<div class="paragraph">
<p>Another essential feature in Alan are the objects. Like the location, the object is a means to describe the &#8220;physical&#8221; world where your adventure is taking place. Many objects are probably used to provide puzzles, such as closed doors, keys and so on, but other objects should be promoted to objects too. A large number of objects that can be examined and manipulated make a game so much more enjoyable.</p>
</div>
<div class="paragraph">
<p>Objects, like locations, have identifiers and descriptions, so you might guess the general structure of an object:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-alan" data-lang="alan">The door IsA object At hallway
  Is closed.
    Description
    "The door to the kitchen is a sliding door."
    If door Is closed Then
     "It is closed."
    Else
     "It is open."
    End If.
End The door.</code></pre>
</div>
</div>
<div class="paragraph">
<p>An object may initially be located at a particular location. This is indicated by the <code>At</code>-clause, in this case telling us that the door is initially located in the Hallway. Objects do not have to start at a particular place in which case they are not present in the game until located, by executing some code, at some place where the player may lay his hands on them.</p>
</div>
<div class="paragraph">
<p>In addition, objects may have attributes indicating the state of certain properties of the object. In this example with a door, the <code>Is closed</code> part indicates that the door should have the attribute closed, which initially is set to <strong>TRUE</strong> (implying that the door is initially closed). The opposite would be indicated with a <code>Not</code>, (i.e. <code>Is Not closed</code>).</p>
</div>
<div class="paragraph">
<p>Alternatively, attributes may be numeric (e.g. <code>Has weight 5</code>) or be of string type (e.g. <code>Has inscription "Kilroy was here"</code>).</p>
</div>
<div class="paragraph">
<p>We also introduce another Alan statement, the <code>If</code>-statement. The <code>If</code>-statement allows you to select which statements to execute according to some condition. In the example, the <code>closed</code> attribute of the door selects which description to show. There are further variations of expressions and the <code>If</code>-statement, but we will come back to these later (<em>Expressions</em> on page <em>141</em> and <em>If</em> on page <em>130</em>).</p>
</div>
<div class="paragraph">
<p>Instead, let&#8217;s look at some other statements in relation to objects.</p>
</div>
<div class="paragraph">
<p>It must of course be possible to change the value of attributes of an object. You can do this using the <code>Make</code> statement or the <code>Set</code> statement. For example if the door should be opened (the player having said &#8220;open door&#8221;, perhaps) this could be performed by stating</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-alan" data-lang="alan">Make door Not closed.</code></pre>
</div>
</div>
<div class="paragraph">
<p>To close it (i.e. setting the closed attribute to TRUE again) you write</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-alan" data-lang="alan">Make door closed.</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>Make</code> statement changes Boolean (or True/False) attributes. The <code>Set</code> statement changes numeric or string attributes, for example</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-alan" data-lang="alan">Set level Of bottle To 4.</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>These statements only change attributes. The implications of such a change must be implemented by writing Alan code that test these attributes and provides differing text output to the player. This is what gives the player <em>the illusion</em> of a door being open or closed for example.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Alan does not understand, or enforce, any semantic in the identifiers for attributes, they are only identifiers. The illusion of the effects of differences in the value must be implemented by varying the output. In addition, Alan does not understand that an attribute &#8216;closed&#8217;, for a human would be the opposite of an attribute &#8216;open&#8217;. You should choose one and stick to it.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Of course, attributes are not only available on objects, but on locations and other types of entities also.</p>
</div>
<div class="paragraph">
<p>Another manipulation statement is the <code>Locate</code> statement. This is the statement to use when moving objects from one location to another. Opening a lid might cause a previously hidden object to fall to the floor, something that could be performed by moving the object from limbo to the current location with:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-alan" data-lang="alan">Locate treasure Here.</code></pre>
</div>
</div>
<div class="paragraph">
<p>You could also relocate it to a particular place using the statement:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-alan" data-lang="alan">Locate vase At hallway.</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="truethe-actors"><a class="anchor" href="#truethe-actors"></a>The Actors</h4>
<div class="paragraph">
<p>Actors can be used to populate the adventure with creatures, beings and other people. They might be pirates or monsters, but the thing they have in common is that they move around or at least perform various actions more or less in the same way as the player does.</p>
</div>
<div class="paragraph">
<p>An actor may have a <code>Description</code> and attributes like objects and locations. An actor performs his movements by following scripts, each having a number of steps. Each step corresponds to one player move.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-alan" data-lang="alan">The charlie_chaplin IsA actor Name charlie chaplin
  Script going_out
    Step
     Locate Actor At outside_house.
    Step
      Locate Actor At hallway.
     Use Script going_out.
End The charlie_chaplin.</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="trueinheritance-and-object-orientation"><a class="anchor" href="#trueinheritance-and-object-orientation"></a>Inheritance and Object Orientation</h4>
<div class="paragraph">
<p>Object orientation is a term that is often used when talking about programming. The concept is modelled after a natural phenomenon first described by the Swedish botanist Carl Linnaeus (or Carl von Linné). He devised a naming system for flowers and plants that was based on features common between various species and families. The idea is that a general concept such as a mammal is defined by listing some features which all mammals share. Specialisations such as sub-species in turn have other, more specialised, features in common.</p>
</div>
<div class="paragraph">
<p>In nature, we talk about species and individuals. In object oriented programming we talk about classes and instances, which are similar. Classes are abstract definitions of what the common features are and instances are individuals (data objects) having those features.</p>
</div>
<div class="sect4">
<h5 id="trueinheritance-and-instances"><a class="anchor" href="#trueinheritance-and-instances"></a>Inheritance and Instances</h5>
<div class="paragraph">
<p>Inheritance means that a more general class can be restricted or specialised into new sub-classes. We say that the specialised class inherits from the more general. Most object oriented programming languages allows creating instances from any class, which does not happen in nature, there are no individuals that are mammals, they are individuals of some specific species of horse for example.</p>
</div>
<div class="paragraph">
<p>In programming, we can use this concept to make some things easier for ourselves. By collecting features that are common to many types of data objects into classes and sub-classes we can inherit those features. In this way, we can avoid explicitly, and repeatedly, stating those for every data object. One small drawback is that we have an implicit declaration of features, which can make reading a bit more obscure. We need to look up the parent class (or classes) for complete information about the object.</p>
</div>
</div>
<div class="sect4">
<h5 id="truepolymorphism"><a class="anchor" href="#truepolymorphism"></a>Polymorphism</h5>
<div class="paragraph">
<p>By using inheritance, we can also guarantee the properties of similar, or related, instances. If every mammal is a vertebrae, we know that all properties of vertebrates also applies to mammals. We can use this knowledge to handle commonalities without knowing anything about the more specialized kinds, or classes. One example of this might be lockable things like doors and drawers. If they inherit from a common ancestor 'lockable_things', then we do not need know if it was a door or a drawer, if we are only interested in the 'locked' property. This flexibility, know as polymorphism, is possible in programming only through object orientation and inheritance.</p>
</div>
</div>
<div class="sect4">
<h5 id="trueevery-and-the"><a class="anchor" href="#trueevery-and-the"></a>Every and The</h5>
<div class="paragraph">
<p>The Alan language supports object orientation and inheritance with two constructs:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-alan" data-lang="alan">Every mammal IsA vertebrate …

The house_pet IsA cat …</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>Every</code>-construct defines a class and its properties, including inheriting from another, even more general class. The <code>The</code>-construct declares an instance, which in this example inherits from the class &#8216;cat&#8217;. The <code>IsA</code>-construct defines from which class properties are inherited.</p>
</div>
</div>
<div class="sect4">
<h5 id="truethe-pre-defined-classes"><a class="anchor" href="#truethe-pre-defined-classes"></a>The Pre-defined Classes</h5>
<div class="paragraph">
<p>To make it easy to get started there are eight classes pre-defined in the Alan language.</p>
</div>
<div class="paragraph">
<p>They are <strong>entity</strong>, <strong>thing</strong>, <strong>location</strong>, <strong>actor</strong>, <strong>object</strong>, <strong>literal</strong>, <strong>string</strong> and <strong>integer</strong> and have the relationship, inheritance tree, shown in <em>Figure 2</em> above.</p>
</div>
<div class="paragraph">
<p>The semantics of these pre-defined classes are in short:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Only locations (instances inheriting from <code>location</code>) can be visited by the hero (the players alter ego)</p>
</li>
<li>
<p>Only actors may have scripts that they perform</p>
</li>
<li>
<p>Only things will be described automatically when encountered</p>
</li>
<li>
<p>Literal and its sub-classes cannot be sub-classed. They are used to handle integers and strings in player input</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>See the subsections of <em>Instances</em> on page <em>56</em> for more detailed descriptions.</p>
</div>
</div>
<div class="sect4">
<h5 id="truecreating-classes-and-instances"><a class="anchor" href="#truecreating-classes-and-instances"></a>Creating Classes and Instances</h5>
<div class="paragraph">
<p>In the sections above about locations, objects and actors the examples show how to create an instance of a class. Those examples show how to do it from the pre-defined classes. However, it is the identical if you have defined the class yourself. In general the format is</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-alan" data-lang="alan">The _&lt;instance_ _identifier&gt;_ IsA _&lt;class identifier&gt;_ …</code></pre>
</div>
</div>
<div class="paragraph">
<p>To define a class you do much what you would expect:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-alan" data-lang="alan">Every _&lt;class identifier&gt;_ …</code></pre>
</div>
</div>
<div class="paragraph">
<p>After this, declarations of all the properties for that class follow. This could include inheriting from another class, e.g.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-alan" data-lang="alan">Every door IsA object
End Every.

Every openable_door IsA door
  Is open.
End Every.

The kitchen_door IsA openable_door
End The kitchen_door.</code></pre>
</div>
</div>
<div class="paragraph">
<p>In this example, the <code>kitchen_door</code> has the attribute <code>open</code> although it does not specifically show in the declaration. It is initially set to true as specified in the declaration of the class <code>openable_door</code>.</p>
</div>
</div>
<div class="sect4">
<h5 id="truespecialising-and-overriding"><a class="anchor" href="#truespecialising-and-overriding"></a>Specialising and Overriding</h5>
<div class="paragraph">
<p>Sub-classing, or specialisation, is usually used to add properties and thus make the instances of the sub-class more restricted, or specialised. In the example above, <code>openable_door</code>s are specialisations of <code>door</code>s since they have an attribute that the more general class does not have.</p>
</div>
<div class="paragraph">
<p>However, a sub-class can also redefine a feature. In the example above a class named <code>closed_openable_door</code> could be defined as:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-alan" data-lang="alan">Every closed_openable_door IsA openable_door
  Is Not open.
End Every.</code></pre>
</div>
</div>
<div class="paragraph">
<p>This makes all instances of the new class have the same attribute but it is set to false instead. The important thing is that the feature of having the attribute is common to all <code>openable_door</code>s. This is called overriding a property.</p>
</div>
<div class="paragraph">
<p>This concludes this short description of object orientation and how the Alan language supports it. In the following descriptions, you just need to remember that most features can be inherited along the inheritance tree and be overridden, both during that inheritance and explicitly in the instance declaration itself.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="truecontainment-classes-and-transitivity"><a class="anchor" href="#truecontainment-classes-and-transitivity"></a>Containment , Classes and Transitivity</h4>
<div class="paragraph">
<p>One basic property of instances is that they may contain other instances. Although conceptually simple there are twists that you should know about.</p>
</div>
<div class="sect4">
<h5 id="truecontainers-containing-containers"><a class="anchor" href="#truecontainers-containing-containers"></a>Containers Containing Containers</h5>
<div class="paragraph">
<p>Containers might contain other instances that are in turn containers and so on, of course. If you want to consider everything inside a container recursively, you might actually get types of instances you did not expect.</p>
</div>
<div class="paragraph">
<p>Consider e.g. a container, <em>cont</em>, that takes a subclass of <em>object</em><strong>,</strong> <em>subobject</em>. Assume there is also an instance of that class, <em>inst</em>, that also is a container, but takes <em>object</em>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-alan" data-lang="alan">Every subobject IsA object
End Every subobject.

The cont IsA object
  Container Taking subobject.
End The cont.

The inst IsA subobject
  Container Taking object.
End The inst.</code></pre>
</div>
</div>
<div class="paragraph">
<p>When you search, recursively, for instances in the container <em>cont</em>, you might then get instances that are both of class <em>subobject</em> and <em>object</em>, e.g. if the <em>inst</em> is inside the <em>cont</em> and in turn contains something, which would then be of class <em>object</em>.</p>
</div>
<div class="paragraph">
<p>This might lead to, completely correct, but surprising, error messages from the compiler indicating that an attribute or other property that you though existed is not available. Especially surprising is perhaps the case where the classes are not even decendants of each other. In this case the contained instances can only be guaranteed to be their common parent, which might be a quite general class like <em>thing</em> or even <em>entity</em>.</p>
</div>
</div>
<div class="sect4">
<h5 id="truetransitivity"><a class="anchor" href="#truetransitivity"></a>Transitivity</h5>
<div class="paragraph">
<p>For many scenarios the above works well, and as expected. But for other cases the notion of transitivity is introduced. Transitivity describes how e.g. containment should be interpreted.</p>
</div>
<div class="paragraph">
<p>The scenario above may be described as &#8220;transitive containment&#8221; meaning that something is in a container if it is in that container or in any container it contains, recursively.</p>
</div>
<div class="paragraph">
<p>There are two other types, namely DIRECT and INDIRECT transitivity. Direct transitivity actually means no transitivity. If you investigate a container with direct transitivity you will only get the direct content of it, not the content of the containers within it.</p>
</div>
<div class="paragraph">
<p>Finally, indirect transitivity means instances indirectly contained by a container. In a way it is the opposite of direct transitivity, all instances recursively contained <em>except</em> the directly contained. Here&#8217;s a rule to remember:</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Transitive = Direct + Indirect</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>What this means is that if you use transitive containment you get the same instances that direct <em>and</em> indirect will give you. And it is usually the indirect ones that you should look out for.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="truethe-verb-construct"><a class="anchor" href="#truethe-verb-construct"></a>The Verb Construct</h4>
<div class="paragraph">
<p>The <code>Verb</code> is the construct that implements the effects of an action requested by the player. Verbs are associated with a class or an instance. We will look at the implications of various combinations of these in the next few sections.</p>
</div>
<div class="paragraph">
<p>To implement a <code>Verb</code> you need a name for it (which is also the default word the player should input to request that action). You must also decide which effects this verb should have under various circumstances.</p>
</div>
<div class="paragraph">
<p>If we want to implement the <code>Verb</code> open for the door we could use the following code</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-alan" data-lang="alan">Verb open
  Does
    Make door open.
End Verb open.</code></pre>
</div>
</div>
<div class="paragraph">
<p>A <code>Verb</code> is either a simple command taking no parameters, like &#8216;look&#8217;, &#8216;save&#8217; or &#8216;help&#8217;, or it involves one or more parameters that the player can reference. Simple verbs should be declared at the top level, globally, i.e. outside of any other declaration. Verbs taking parameters, on the other hand, must be declared within the class or instance, with which it is associated. For example, if a verb will handle objects it should be declared in the object class. The example above should probably best be placed in the door object itself.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-alan" data-lang="alan">The kitchen_door IsA object
  Verb open
    Does
      Make kitchen_door open.
  End Verb open.
End The kitchen_door.</code></pre>
</div>
</div>
<div class="paragraph">
<p>This defines the effects of applying the <code>open</code> verb to that precise door. The implementation makes direct references to the <code>kitchen_door</code>, so to make the verb more general it should be possible to apply to all doors.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-alan" data-lang="alan">Every door IsA object
  Verb open
    Does
      Make This open.
  End Verb open.
End Every door.</code></pre>
</div>
</div>
<div class="paragraph">
<p>With this definition it is possible to apply the verb to all doors. Instead need to reference the object the player mentioned in his command (see The Syntax on page 33 for an introduction, and Syntax Definitions on page 78 for a more thorough discussion). In this case, the attribute <code>closed</code> must also be available for all objects by ensuring that the attribute exists in to the class. (See <em>Additions</em> on page <em>91</em> on how to add an attribute to a predefined class such as <code>object</code>).</p>
</div>
<div class="paragraph">
<p>Of course, there are often also conditions that need to be checked before we can execute this code (perhaps to see if it was possible to open the object!). Therefore, <code>Verb</code>s may have <code>Check</code>s, as we will see next.</p>
</div>
<div class="sect4">
<h5 id="truechecking-things"><a class="anchor" href="#truechecking-things"></a>Checking Things</h5>
<div class="paragraph">
<p>In order to assert that the correct conditions are fulfilled before the body of a <code>Verb</code> is actually executed the verb may have an optional <code>Check</code> part.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-alan" data-lang="alan">Verb open
  Check o Is openable
    Else "You can't open the $o."
  Does
    Make o open.
End Verb open.</code></pre>
</div>
</div>
<div class="paragraph">
<p>This is a more realistic definition of the open <code>Verb</code> than the previous one. It specifies that before the statements after <code>Does</code> are executed, the condition after <code>Check</code> must be checked (which, in this case, checks that the object indicated by the player is really possible to open). If that condition is TRUE then the requirements are fulfilled and the body of the <code>Verb</code> (following the <code>Does</code>) can be executed. If this is not the case the <code>Else</code>-part is executed instead (normally showing some message).</p>
</div>
<div class="paragraph">
<p>A <code>Check</code> may have multiple conditions as the following code shows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-alan" data-lang="alan">Verb take
  Check o takeable
    Else "You can't take that."
  And o Not In hero
    Else "You already have it."
  Does
    Locate o In hero.
End Verb take.</code></pre>
</div>
</div>
<div class="paragraph">
<p>Here we also encounter a variation on the <code>Locate</code> statement - the capability to place an object inside a container (the inventory).</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>You can never destroy an instance or remove it from the game. Instead, you can define a limbo location, i.e. a location that is not accessible to the player and may thus be used as a storage for &#8220;destroyed&#8221; objects and other things the player is not supposed to see.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect3">
<h4 id="truethe-syntax"><a class="anchor" href="#truethe-syntax"></a>The Syntax</h4>
<div class="paragraph">
<p>Normally a verb acts on one object or actor, henceforth called a parameter, referenced by the player in a command. This means that the format of player input normally is something like</p>
</div>
<div class="exampleblock gametranscript">
<div class="content">
<div class="paragraph">
<p>&gt; take vase</p>
</div>
</div>
</div>
<div class="paragraph">
<p>This form, or syntax, is the default form if you don&#8217;t specify anything else. The default syntax might thus be described as</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-alan" data-lang="alan">Syntax +
  ? = ? (parameter)</code></pre>
</div>
</div>
<div class="paragraph">
<p>The question marks are place-holders and should be interpreted as the name of the verb.</p>
</div>
<div class="paragraph">
<p>In order to allow different and more complex player input the <code>Syntax</code> construct is supplied.</p>
</div>
<div class="paragraph">
<p>The <code>Syntax</code> construct is a way to describe the words and parameters the player may use in order to execute a particular verb (its global and more specialised parts). Below is the syntax for <code>put_in</code>, the verb to put something inside a container.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-alan" data-lang="alan">Syntax
  put_in = 'put' (obj) 'in' (cont).</code></pre>
</div>
</div>
<div class="paragraph">
<p>This syntax defines the <code>put_in</code> verb to be executed when the player has input the word &#8216;put&#8217; followed by a reference to an object or actor (a parameter named <code>obj</code>), followed by the word <code>in</code> followed by a reference to a second parameter (the container, referred to as <code>cont</code>), as in</p>
</div>
<div class="exampleblock gametranscript">
<div class="content">
<div class="paragraph">
<p>&gt; put the green pearl in the black box</p>
</div>
</div>
</div>
<div class="paragraph">
<p>This will bind the parameter <code>obj</code> to the instance that represents the green pearl and the parameter <code>cont</code> will be bound to the black box.</p>
</div>
<div class="paragraph">
<p>It is also possible to restrict the types of the parameters:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-alan" data-lang="alan">Syntax
  put_in = 'put' (obj) 'in' (cont)
    Where obj IsA object
      Else "You can't put that into anything."
    And cont IsA Container
      Else "Nothing fits inside that."</code></pre>
</div>
</div>
<div class="paragraph">
<p>This restricts the parameter <code>obj</code> to being an instance inheriting from the class object (as opposed to an actor for example) and the parameter <code>cont</code> to a container (an instance with the container property).</p>
</div>
<div class="paragraph">
<p>The parameters are used as normal identifiers in the Alan source code. The parameters can only be referenced if they are defined in the current context, i.e. they can only be used in the various bodies of the verb for which the syntax applies (see also <em>Run-time Contexts</em> on page <em>162</em> for a detailed discussion).</p>
</div>
<div class="paragraph">
<p>The <code>Syntax</code> construct allows for more than one parameter, in order to make it possible to define more complex player commands. Therefore, the verb execution order described previously from execution of verbs in one instance must be generalised to verb bodies in all the parameters. In the example above, verb bodies in the objects or actors referenced as <code>obj</code> and <code>cont</code> (the green pearl and the black box) are executed (if the verb is present in their definitions).</p>
</div>
</div>
<div class="sect3">
<h4 id="truetext-output-formatting"><a class="anchor" href="#truetext-output-formatting"></a>Text Output Formatting</h4>
<div class="paragraph">
<p>Text output on the screen is caused by what you have written in the Alan source code. However, since text is coming from various places it is not easy or even possible, to anticipate the full context of a particular text.</p>
</div>
<div class="paragraph">
<p>Therefore, the Alan system takes care of some specific formatting issues. First, text will always flow neatly inside the window or screen. Lines will be broken automatically without braking in the middle of words.</p>
</div>
<div class="paragraph">
<p>Secondly, a few special cases are also handled automatically:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>After a full stop (period, the character &#8216;.&#8217;), an exclamation (&#8216;!&#8217;) or a question mark (&#8216;?&#8217;) and in the beginning of paragraphs, including location headings, the first character will be guaranteed to be upper case, automatically converted if necessary. This means for example that you don&#8217;t have to consider the case when the name of an object might be printed as the first thing in a sentence. The name will automatically be capitalized. For example:</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-alan" data-lang="alan">The postmen IsA actor At postoffice …

The postoffice IsA location
  Description
    Describe postmen.
…</code></pre>
</div>
</div>
<div class="paragraph">
<p>Given the above snippet from a game source, the transcript would read:</p>
</div>
<div class="exampleblock gametranscript">
<div class="content">
<div class="paragraph">
<p><strong>Postoffice</strong><br>
Postmen are working behind the counters.</p>
</div>
</div>
</div>
<div class="paragraph">
<p>This would be the case even if the description of the postmen started with a lower case character.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Two outputs following each other will automatically be separated by a space (a blank character). Except for the following case:</p>
<div class="paragraph">
<p>If an output is immediately followed by another output starting with a full stop (period, the character &#8216;.&#8217;), an exclamation, a question mark or a comma, and it is the only character in that output or it is followed by a space (blank character), no space will be inserted before that output. This rule will make sure that the full stop in the following source is automatically adjacent to the previous text, without the need to suppress spacing.</p>
</div>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-alan" data-lang="alan">  "You can't take" Say p. "."</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="truestrict-and-safe"><a class="anchor" href="#truestrict-and-safe"></a>2.5. Strict and Safe</h3>
<div class="paragraph">
<p>The Alan language is strict and type safe. This means that the compiler will attempt to prevent any constructs that might generate a problem for the player, such as assigning values of one type to attributes of another type, accessing properties that are not guaranteed to exist on the instance, and so on.</p>
</div>
<div class="paragraph">
<p>A simple example is</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-alan" data-lang="alan">1. Every animal IsA object
2.   Has fur.
3. End Every animal.
4.
5. The house_cat IsA object …
6.   …
7.
8.   If house_cat Has fur Then …</code></pre>
</div>
</div>
<div class="paragraph">
<p>At line 8 we will get an error saying that the <em>house_cat</em> does not have the attribute <em>fur</em>.</p>
</div>
<div class="paragraph">
<p>Now, if that is true, it&#8217;s a good thing that the compiler caught the error, otherwise the game might try to access that attribute. And blow up in the face of the player.</p>
</div>
<div class="paragraph">
<p>Can you spot the problem? The <em>house_cat</em> is declared as an <em>object</em>, and not as an <em>animal</em>.</p>
</div>
<div class="paragraph">
<p>Other examples include trying to use a script for an actor (or actor subclass) that does not have one, locating something inside something that is not a container and so on.</p>
</div>
<div class="paragraph">
<p>A more complicated example is this</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-alan" data-lang="alan"> 1. The cont IsA object
 2.   Container Taking thing.
 3. End The cont.
 4.
 5. Add To Every object
 6.   Has someAttribute.
 7. End Add.
 8.
 9. The box IsA object
10.   Container Taking object.
11. End The.
12. …
13.   For Each f In box Do
14.     If f Has someAttribute Then
15. …</code></pre>
</div>
</div>
<div class="paragraph">
<p>On line 14 we will get an error saying that <em>someAttribute</em> is not available since the class <em>f</em> can only be guaranteed to be <em>thing</em>.</p>
</div>
<div class="paragraph">
<p>Is it? Well, the variable <em>f</em> (in the loop) enumerates all things in the box and since the box takes objects, it is possible that it may contain the cont. And since that takes things, and the <em>In box</em> is transitive (see xxx), <em>f</em> may take on any thing that is contained in the cont too.</p>
</div>
<div class="paragraph">
<p>There are a number of ways to fix this of course:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>change the transitivity of the filter in the loop (<code>Directly In</code>)</p>
</li>
<li>
<p>add a class-restricting filter in the loop (<code>IsA object</code>)</p>
</li>
<li>
<p>rethink your class hierarchy</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The Alan compiler is trying to protect you, and your players, but sometimes the error can be hard to spot.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="truelanguage-reference"><a class="anchor" href="#truelanguage-reference"></a>3. Language Reference</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This chapter describes the Alan language in detail. Within each section, grammar rules are used to precisely define allowed formats. A description of how these rules should be interpreted can be found in Appendix <em>L</em> on page <em>221</em>.</p>
</div>
<div class="sect2">
<h3 id="truegeneral-rules"><a class="anchor" href="#truegeneral-rules"></a>General Rules</h3>
<div class="paragraph">
<p>The Alan language is divided into syntactic components of different kinds. Each component may be composed of text and/or other components. A component is terminated by a period or full stop (&#8216;.&#8217;). This indicates that that component is complete. Some components start with a keyword or initial phrase, such as <code>Description</code> or <code>Exit east To kitchen</code>. If it is to be followed by further components, such as statements or output strings, that keyword or phrase should normally <em>not</em> be followed by a period, but by its continuing components. For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-alan" data-lang="alan">Exit east to Kitchen.</code></pre>
</div>
</div>
<div class="paragraph">
<p>But</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-alan" data-lang="alan">Exit east To Kitchen
  Check kitchenDoor Is open
  …
End Exit.</code></pre>
</div>
</div>
<div class="paragraph">
<p>Note that the first is terminated, but the second example is continued with a check, and not terminated until the <code>End Exit</code>.</p>
</div>
</div>
<div class="sect2">
<h3 id="truean-adventure"><a class="anchor" href="#truean-adventure"></a>3.1. An Adventure</h3>
<div class="paragraph">
<p>An adventure starts with an (optional) set of options (see <em>Options</em> on page <em>49</em>) followed by a set of declarations.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ebnf" data-lang="ebnf">adventure = {option} {declaration} start_section</code></pre>
</div>
</div>
<div class="paragraph">
<p>According to the rules it is actually possible to have no declarations at all (as indicated by the curly braces) but there would be no adventure without a single location, right? So, in practice you&#8217;ll need at least one declaration.</p>
</div>
<div class="paragraph">
<p>The declarations constitute the major part of the adventure. The declarations can be declared in any order and repeated freely, and are of many different possible types.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ebnf" data-lang="ebnf">declaration = import
            | class
            | instance
            | addition
            | syntax
            | verb
            | rule
            | synonyms
            | event
            | messages
            | prompt</code></pre>
</div>
</div>
<div class="paragraph">
<p>The adventure source text must end with a start section.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ebnf" data-lang="ebnf">start_section = 'START' where '.' statements</code></pre>
</div>
</div>
<div class="paragraph">
<p>It indicates where the hero is when the game starts but can also be used to set things up, welcome the player and so on. The start section is mandatory.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-alan" data-lang="alan">Start At bedroom.
  Schedule alarm_clock After 2.
    "Slowly you come to your senses, your numb limbs
     starting to feel the blood flowing through them..."</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can look up the meaning of the rules &#8220;where&#8221; and &#8220;statement&#8221; elsewhere in this chapter.</p>
</div>
</div>
<div class="sect2">
<h3 id="trueoptions"><a class="anchor" href="#trueoptions"></a>3.2. Options</h3>
<div class="paragraph">
<p>Options define things concerning the overall behaviour of the generated Alan adventure. As is implied they are optional and are only required if you need to change the value of an option from its default setting. An option follows the grammar</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ebnf" data-lang="ebnf">option = id '.'
       | id id '.'
       | id integer '.'</code></pre>
</div>
</div>
<div class="paragraph">
<p>The example below illustrate how options may be written, following the above rules.</p>
</div>
<div class="paragraph">
<p>@[source,alan]</p>
</div>
<div class="listingblock">
<div class="content">
<pre>Debug.
Language Swedish.
No Pack.
Width 128.</pre>
</div>
</div>
<div class="paragraph">
<p>The available options are</p>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Option name</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Possible values</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Default value</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Language</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">English, Swedish, German<sup class="footnote">[<a id="_footnoteref_1" class="footnote" href="#_footnote_1" title="View footnote.">1</a>]</sup></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">English</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Width</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">24-255</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">80<sup class="footnote">[<a id="_footnoteref_2" class="footnote" href="#_footnote_2" title="View footnote.">2</a>]</sup></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Length</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">5-255</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">24</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Pack</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Boolean (on or off)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Off (No Pack)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Debug</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Boolean (on or off)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Off (No Debug)</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>The Language option specifies the language in which the adventure is assumed played, and selects different default message texts. Alan is primarily designed for adventures in the English language, but it is also possible to write adventures in other languages. To make this possible, the default messages output by the interpreter may be generated in different languages. It is completely possible to write in other languages, but then you must customize all the message texts. See page <em>210</em>, Appendix section <em>Input Response Messages</em>, for a complete list of such messages.</p>
</div>
<div class="paragraph">
<p>The Alan compiler and interpreter will always allow multinational 8-bit characters as input and the default messages is generated for 8-bit character sets, internally representing national characters according to the ISO multinational character set (ISO8859-1) requiring 8 bits. On output, this is converted to the native character set of the machine (whenever possible). This means that portability between platforms should be good even for text containing multi-national (non-ASCII) characters.</p>
</div>
<div class="paragraph">
<p>Width specifies how long the lines the interpreter outputs should be (formatting is automatic!). The Length option will instruct the interpreter to how many lines to show on the screen without any player interaction (<strong>&lt;More&gt;</strong>). These values are only used if the interpreter itself cannot get the actual values.</p>
</div>
<div class="paragraph">
<p>The Pack option will cause the compiler to compress the texts to occupy less space. As a bonus, this also makes it impossible for the player to cheat by dumping the adventure code file. As a minor drawback, it does make the execution of the adventure a bit slower (noticeable only on some very old, smaller, computers).</p>
</div>
<div class="paragraph">
<p>In order to allow debugging of the generated adventure (see <em>Debugging</em> on page <em>187</em>), the debug option must be turned on. This may also be performed using the debug compiler switch (see <em>Compiler Switches,</em> on page <em>203</em>).</p>
</div>
</div>
<div class="sect2">
<h3 id="truetypes"><a class="anchor" href="#truetypes"></a>3.3. Types</h3>
<div class="paragraph">
<p>The Alan language handles information in bits, values. Each such bit of information, or data, is of a specific type. Alan is a strictly typed language, which means that assignment, comparisons and other statements will require that rules concerning the compatibility between such values are not broken.</p>
</div>
<div class="paragraph">
<p>In the Alan language, you cannot explicitly state the type of a value. Instead, this is inferred from how values are used, e.g. the initial value of an attribute or the restrictions put on a syntax parameter.</p>
</div>
<div class="sect3">
<h4 id="truebasic-simple-and-compound-types"><a class="anchor" href="#truebasic-simple-and-compound-types"></a>Basic, Simple and Compound Types</h4>
<div class="paragraph">
<p>The basic types of values available in the Alan language are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Integer – e.g. a simple integer constant, a reference to an integer typed attribute or a numeric expression using any of the mathematical operators.</p>
</li>
<li>
<p>String – e.g. a string constant or a reference to an attribute typed as a string.</p>
</li>
<li>
<p>Boolean (true or false) – comparisons yield Boolean values, Boolean attributes.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Two other simple types are available:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Instance – a reference to an instance or an attribute typed as a reference attribute that refers to an instance.</p>
</li>
<li>
<p>Event – a reference to an event or an attribute typed as a reference attribute that refers to an event.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>There is one compound type in the Alan language:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Set – an unordered list of values.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="trueinstance-type"><a class="anchor" href="#trueinstance-type"></a>Instance Type</h4>
<div class="paragraph">
<p>Every time a reference to an instance is made, it can be considered an expression of instance type. In these cases, the class of the instance also often matters. E.g. assigning a reference attribute can only be made if the new value refers to an instance that belongs to the same class or a subclass of the initial value of that attribute.</p>
</div>
<div class="paragraph">
<p>Some types of expressions return a value referring to an a class or instance in the Alan source. Examples include an identifier bound to a parameter allowing instances and a reference attribute.</p>
</div>
</div>
<div class="sect3">
<h4 id="trueevent-type"><a class="anchor" href="#trueevent-type"></a>Event Type</h4>
<div class="paragraph">
<p>Event is a set of statements that can be scheduled to execute with a specified delay. Each reference to an identifier of an Event is of course of the Event type. Events can be referenced by attributes and any reference to such an attribute is of Event type.</p>
</div>
<div class="paragraph">
<p>Expressions of Event type can be used in <code>Schedule</code> and <code>Cancel</code> statements.</p>
</div>
</div>
<div class="sect3">
<h4 id="trueset-type"><a class="anchor" href="#trueset-type"></a>Set Type</h4>
<div class="paragraph">
<p>A Set is a collection of values that may be referenced as a single value, but also investigate, added to and removed from. An example might be a set of cards in a dealt hand, the set of spells that the hero have learned, or the set of numbers guessed so far.</p>
</div>
<div class="paragraph">
<p>The order of elements in the set is not specified. Each member can only occur once in the same set, but a member can occur in multiple sets. You could for example include one set of numbers (integers) in one set and another set of numbers in another set. It is then possible to investigate the sets and remove all members that are members in both.</p>
</div>
<div class="paragraph">
<p>The Set type is a compound type since it is not complete without a member type. You can only include members in a set if the type compatibility rules allow it. A Set may include members that are instances or integers.</p>
</div>
<div class="paragraph">
<p>If the Set includes instances, the subclass compatibility rule applies. All members in the set must inherit from the same class. See the section on type compatibility below.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The fact that an instance is in a Set does not affect the instance. In fact, there is no way to find out in which Sets, if any, a particular instance is included. In particular, it does not affect the instances location.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="truetype-compatibility"><a class="anchor" href="#truetype-compatibility"></a>Type Compatibility</h4>
<div class="paragraph">
<p>Assignment and comparisons between values requires the values to be compatible. The three basic types (integer, string and Boolean) are only compatible with themselves.</p>
</div>
<div class="paragraph">
<p>Values of the Instance type can be compared without restriction, except that there is no notion of lesser or equal, so only equality can be tested. Assignment can be made if the new value is of the same class, or of a subclass, as the attribute or variable that receives the value. This class is normally inferred from the initial value of the declaration.</p>
</div>
<div class="paragraph">
<p>For example, a reference attribute (an attribute referencing an instance) is inferred to be restricted to instances of the class of its initial value. Any subsequent change of the attribute (setting it to refer to another instance) requires that the new instance be of the same class or a subclass thereof.</p>
</div>
<div class="paragraph">
<p>These rules ensure that attribute references and other properties are always retained during the execution of the whole game. Thus, it will never cause a run-time error on the player.</p>
</div>
</div>
<div class="sect3">
<h4 id="truetype-requirements"><a class="anchor" href="#truetype-requirements"></a>Type Requirements</h4>
<div class="paragraph">
<p>Some statements require their arguments to be of a specific type. This is enforced by the compiler. The compatibility rules apply here also, given that the required type is given by the statement itself.</p>
</div>
<div class="paragraph">
<p>Examples include the conditional <code>If</code> statement that requires a Boolean value (or expression) to test and the <code>Use</code> statement, which requires references to instances that are subclasses of the predefined class <code>actor</code>.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="trueimport"><a class="anchor" href="#trueimport"></a>3.4. Import</h3>
<div class="paragraph">
<p>The source text for a large adventure might become entangled and complex. A way to break up a large text is to divide it into separate files. Each such file can then be imported into the main source using the <code>import</code> statement.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ebnf" data-lang="ebnf">import = 'import' quoted_identifier '.'</code></pre>
</div>
</div>
<div class="paragraph">
<p>The quoted identifier is the name of the file to import, see <em>File</em> on page <em>157</em>. The <code>import</code> may be placed anywhere in a file where a declaration can occur, and the effect will be the same as if the contents of the named file had been inserted at that position in the file. Imports may be nested, so an imported file may in turn import more files, without limits.</p>
</div>
<div class="paragraph">
<p>An imported file is searched for first in the current directory and then in any of the directories indicated using the <code>import</code> switch as described in <em>Compiler Switches</em> on page <em>203</em>, this search is performed in the same order as the <code>import</code> switches occurred on the command line.</p>
</div>
<div class="paragraph">
<p>The import statement is the way to use the standard library (or a library of your own design). Place the library files in a directory where the compiler will find them, either in the same directory as your other source files or somewhere else (see Appendix section <em>A.2</em> <em>Compiler Switches</em> on page <em>203</em> on how to make the compiler look in more folders than the one the main source file is in). In your source you would refer to the main file of such a library by</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ebnf" data-lang="ebnf">import 'library.i'.</code></pre>
</div>
</div>
<div class="paragraph">
<p>Another use is for dividing your own source into multiple files to make them easier to handle:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ebnf" data-lang="ebnf">import 'harbor.i'.
import 'city.i'.
import 'desert.i'.
import 'actors.i'.
Start At city.</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="trueclasses"><a class="anchor" href="#trueclasses"></a>3.5. Classes</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ebnf" data-lang="ebnf">class = 'EVERY' id
            [inheritance]
            {property}
        'END' 'EVERY' [id] ['.']</code></pre>
</div>
</div>
<div class="paragraph">
<p>Classes are definitions of templates of instances. That means that a class declaration only describes instances, and does not add anything to your game in itself. Instead, you have to create an instance of the class to make it available in the game (see <em>Instances</em> below).</p>
</div>
<div class="paragraph">
<p>The <strong>id</strong> is the identifier used by the author to refer to this class throughout the source code, e.g. when referring to it in the inheritance clause of other classes and instances.</p>
</div>
<div class="paragraph">
<p>The <strong>properties</strong> are described in <em>Properties</em> on page <em>62</em>.</p>
</div>
<div class="sect3">
<h4 id="trueinheritance"><a class="anchor" href="#trueinheritance"></a>Inheritance</h4>
<div class="paragraph">
<p>Every instance must inherit from a class (see <em>Inheritance and Object Orientation</em> on page <em>33</em>). Furthermore, user-defined classes must also inherit from other classes. A class or an instance inheriting from a class will get all properties of that class. All properties explicitly declared in a class or instance inheriting from another class will extend, override or complement those properties as specified in the original, parent, class. This way, you can easily create new classes by extending existing ones.</p>
</div>
<div class="paragraph">
<p>You specify which class another class or an instance inherits from using a clause following the grammar:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ebnf" data-lang="ebnf">inheritance = 'ISA' id ['.']</code></pre>
</div>
</div>
<div class="paragraph">
<p>For example</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-alan" data-lang="alan">The door IsA object …</code></pre>
</div>
</div>
<div class="paragraph">
<p>and</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-alan" data-lang="alan">Every coin IsA treasure …</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="trueinstances"><a class="anchor" href="#trueinstances"></a>3.6. Instances</h3>
<div class="paragraph">
<p>The most important part of an Alan game source is probably the declarations of instances. Instances are the objects, locations, actors and other things that fill your game universe. The player traverses and interacts with these in his quest to negotiating your game.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ebnf" data-lang="ebnf">instance = 'THE' id
              [inheritance]
              {property}
           'END' 'THE' [id] ['.']</code></pre>
</div>
</div>
<div class="paragraph">
<p>Every instance must inherit from a class (see <em>Inherit</em> above) keeping all properties of that class. Each inherited property can be amended or overridden by specifying it in the declaration of the instance, and new attributes, exits and scripts can be added in the same way as in class declaration.</p>
</div>
<div class="paragraph">
<p>Exactly the same rules for declaring properties apply to instances. The only difference is that an instance will actually show up in the game when it is run. Remember also that properties declared in an instance are not common to any other instances (unless the declaration overrode the value of a class property).</p>
</div>
<div class="paragraph">
<p>Instances inheriting, directly or indirectly, from the predefined classes <strong>thing</strong>, <strong>entity</strong>, <strong>object</strong>, <strong>location</strong>, <strong>actor</strong> and <strong>literal,</strong> are subject to special semantics and restrictions.</p>
</div>
<div class="paragraph">
<p>Here are two examples of instance declarations following the rules above:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-alan" data-lang="alan">The red_ball
  IsA object
  At bedroom
  Name red ball
  Is hidden.
  Description
    If This Is Not hidden Then
      "An ordinary ball is laying under the bed."
    End If.
  Verb roll
    Does
      "You roll the ball a bit. Nothing exciting happens."
  End Verb.
End The red_ball.

The mr_brown
  IsA actor
  Name Mr Brown
  Article "".
  Pronoun him.
  Is working.
  Description "Mr. Brown is here, working at his desk."
End The mr_brown.</code></pre>
</div>
</div>
<div class="paragraph">
<p>In these examples the source lines between <code>The</code> and <code>End The</code> all declare various properties that we will learn more about in section <em>3.7</em> <em>Properties</em> on page <em>62</em>. The rest of the lines are fairly easy to match up to the rules of the Alan language as described by the earlier box.</p>
</div>
<div class="paragraph">
<p>All capitalized words in the examples above are keywords in the Alan language (see Appendix section <em>D.2</em> <em>Keywords</em> on page <em>222</em> for a complete list), the rest are author defined words or identifiers (with the exception of the bold words object and actor, which are identifiers predefined to be special classes).</p>
</div>
<div class="sect3">
<h4 id="trueentities"><a class="anchor" href="#trueentities"></a>Entities</h4>
<div class="paragraph">
<p>The base class <code>entity</code> represents the lowest denominator of all instances. All other pre-defined classes inherit from <code>entity</code>. So adding a property to <code>entity</code> will add it to every instance.</p>
</div>
<div class="paragraph">
<p>Entities cannot have an initial location, nor can they be located anywhere. On the other hand, they can be considered to be available everywhere. They are not described when encountered. They can only be shown by explicitly executing a <code>Describe</code> statement.</p>
</div>
<div class="paragraph">
<p>So, if you want an instance to always be available but invisible, create an instance of <code>entity</code>. It is also possible to create subclasses of <code>entity</code>. Instances of such classes will follow the same rules.</p>
</div>
</div>
<div class="sect3">
<h4 id="truethings"><a class="anchor" href="#truethings"></a>Things</h4>
<div class="paragraph">
<p><code>Thing</code> is a pre-defined subclass of <code>entity</code> that adds the property of having a location. This means that they can have an initial location and be located to locations and into containers. They will, however not show up in descriptions or listings, but the player can refer to and interact with them. They can be described by explicitly executing a <code>Describe</code> statement.</p>
</div>
<div class="paragraph">
<p>Creating an instance of <code>thing</code> is a good choice if you want an invisible instance that should only be available at particular locations, or under specific <em>*circumstances*</em>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Note that a <code>thing</code> can be put in a container, but that container will not show any visible traces of that thing. It will be rendered as empty if listed. The <code>thing</code> is however subject to other effects of being part of a container, such as the removal rules and selection by a random selection of items in the container. See <em>Random Values</em> on page <em>143</em> for a description of random selections of container items.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="trueobjects"><a class="anchor" href="#trueobjects"></a>Objects</h4>
<div class="paragraph">
<p>Objects are instances inheriting directly or indirectly from the predefined class <code>object</code>. Objects are all the things that can be manipulated by the player. They can be picked up, examined and thrown away (if the author has allowed it). In addition to the properties inherited from <code>thing</code>, any present object will by default, be described when the player enters a location or otherwise encounters it.</p>
</div>
</div>
<div class="sect3">
<h4 id="trueactors"><a class="anchor" href="#trueactors"></a>Actors</h4>
<div class="paragraph">
<p>The predefined class <code>actor</code> is intended for providing so called NPC:s, non-player characters, in your game. Like the player, they can move around but to do this they have to be scripted, i.e. programmed with some behaviour using scripts.</p>
</div>
<div class="paragraph">
<p>An instance inheriting from the <code>actor</code> class will be described when encountered. Actors can be located, as can any <code>thing</code>, but not be inside a container. In addition, they can have scripts.</p>
</div>
<div class="paragraph">
<p>Actors also exhibit special behaviour when they are described, e.g. when they are encountered. If an actor is executing a script with a description, (see <em>Script</em> on page <em>89</em>) this description will be used instead of the one declared in the description clause.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-alan" data-lang="alan">The kirk IsA actor Name Captain Kirk At control_room
  Has health 25.
  Container
    Header "Kirk is carrying"
    Else "Captain Kirk is not carrying anything."
  Description
    "Your superior, Captain Kirk, is in the room."
End The kirk.

The george IsA actor
  Name George Formby
  Description
    "George Formby is here."
  Script cleaning.
    Description
      "George Formby is here cleaning windows."
    Step ...
  Script tuning.
    Description
      "George Formby is tuning his ukelele."
  Step...
:</code></pre>
</div>
</div>
<div class="sect4">
<h5 id="truethe-hero"><a class="anchor" href="#truethe-hero"></a>The Hero</h5>
<div class="paragraph">
<p>There is one very special actor, the hero, which represents the player. This actor is always pre-declared with some basic properties, so you don&#8217;t have to declare it. But if necessary, it may be re-declared in the same way as any other actor.</p>
</div>
<div class="paragraph">
<p>One situation when this is required is if you need attributes on the hero, such as &#8220;sleepy&#8221; or &#8220;hungry&#8221;. A declaration like the following can then be used:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-alan" data-lang="alan">The hero IsA actor
  Name me
  Is Not hungry.
  Verb examine Does
    If hero Is hungry Then
      "Examining yourself reveals a poor, hungry soul."
    Else
      "You find nothing but a poor beggar."
    End If.
  End Verb examine.
End The hero.</code></pre>
</div>
</div>
<div class="paragraph">
<p>The hero is predefined with a simple container property taking objects with no limits. It seems natural to use that as the &#8220;inventory&#8221; of the player, the storage for everything the player is picking up and carrying around. You will probably need to handle carried items in some manner, and the pre-declared container is one suggestion. You can also redeclare the container property of the hero so that it suits your needs.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="truelocations"><a class="anchor" href="#truelocations"></a>Locations</h4>
<div class="paragraph">
<p>A location is a declaration of a place (a &#8220;room&#8221;) in the game that (normally) can be visited by the player, and have objects lying around, etc. In fact, the map of your game is a set of interconnected locations. A location is any instance inheriting directly or indirectly from the predefined class <code>location</code>. Inheriting from <code>location</code> implies the following semantic properties:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>only locations can be visited by the player</p>
</li>
<li>
<p>only locations may have the <code>Entered</code>-clause</p>
</li>
<li>
<p>things and locations may be located to locations</p>
</li>
<li>
<p>exits can only lead to locations and only locations can have exits</p>
</li>
<li>
<p>the start location must be a location</p>
</li>
<li>
<p>locations can&#8217;t have container properties</p>
</li>
<li>
<p>verbs in locations are executed only when the hero is at that location</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>When a location is described (for example when entering it) it is presented with a heading (the location name), the description (in the description clause) followed by descriptions of any present objects and actors not already, explicitly, described (using a <code>describe</code> statement) in the description.</p>
</div>
<div class="paragraph">
<p>An interesting property of locations is that a location can be located at another, both initially and during run-time. The result of having such nested locations is that all things present at the &#8220;outer&#8221; location are also present in the inner. This can be used in multiple levels to allow access to sky, ground and other scenery items available at many locations at once. It can also be used for grouping locations into sets of similar locations and for implementing vehicles.</p>
</div>
</div>
<div class="sect3">
<h4 id="trueliterals"><a class="anchor" href="#trueliterals"></a>Literals</h4>
<div class="paragraph">
<p>The classes <strong>literal</strong>, <strong>string</strong> and <strong>integer</strong> cannot be instantiated explicitly. Instead, you might say that they are implicitly instantiated when the player inputs a literal. For example</p>
</div>
<div class="exampleblock gametranscript">
<div class="content">
<div class="paragraph">
<p>&gt; turn dial to 12</p>
</div>
</div>
</div>
<div class="paragraph">
<p>The second parameter (see <em>Syntax Definitions</em> on page <em>92</em>) in this player command is the integer 12. This parameter is automatically considered an instance of the pre-defined class <strong>integer</strong>.</p>
</div>
<div class="paragraph">
<p>It is possible to add verbs to <strong>literal</strong> and its sub-classes. This way it is possible to create verbs that take strings and integers as parameters.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="trueproperties"><a class="anchor" href="#trueproperties"></a>3.7. Properties</h3>
<div class="paragraph">
<p>An instance or class can be given number of different properties by declaring them in the declaration of the class or instance.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ebnf" data-lang="ebnf">property = initial_location
         | name
         | pronouns
         | attributes
         | initialization
         | description
         | articles
         | mentioned
         | container_properties
         | verb
         | script
         | entered
         | exit</code></pre>
</div>
</div>
<div class="paragraph">
<p>Attributes, exits, verbs and scripts can be repeated any number of times in the same declaration. You cannot use the same identifier for more than one such property, e.g. you cannot declare two attributes with the same name.</p>
</div>
<div class="sect3">
<h4 id="trueinheriting-properties"><a class="anchor" href="#trueinheriting-properties"></a>Inheriting Properties</h4>
<div class="paragraph">
<p>A property can be inherited from the parent of the class or instance. It is not necessary to repeat the declaration in the inheriting class or instance if it should retain its inherited value. Each inherited property may be amended or overridden by specifying it also in the declaration of the inheriting class or instance according to the following table.</p>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Property</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Inherited as</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Initial location</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Overridden</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Name</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Accumulated, the inherited names are appended at the end of the list of Name clauses</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Pronoun</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Overridden, each pronoun clause inhibits inheriting pronouns from the parent class.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Attribute values</strong></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Overridden, attribute declarations using the same name as an inherited can give the attribute a different value but must match the type of the inherited.</p>
</div>
<div class="paragraph">
<p>Accumulated, you can add further attributes in a class or instance.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Initialize</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Accumulated. Inherited initialize clauses are executed first so that the base classes may do their initialization first.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Description check</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Accumulated.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Description</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Overridden.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Articles &amp; Forms</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Overridden.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Mentioned</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Overridden. Also overrides names.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Container</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Overridden, all clauses are overridden.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Verb declarations</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Accumulated. Verb bodies are accumulated for verbs with the same name as the inherited. Use qualifiers (see Verb Qualification 106) if you don&#8217;t want all of them to execute.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Scripts</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Overridden, for same script name.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Entered</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Accumulated. Entered-clauses in nested locations are executed from the outside in. Entered-clauses in parent classes are executed first. So the first clause to be executed is the parent of an outer location.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Exits</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Overridden, for same direction.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>The table also show which properties are inherited separately from the parent. E.g., you can override the description but keep the description check, or even add another (since they are accumulated). You cannot override the container limits and keep the header section since the container property is overridden in its entirety.</p>
</div>
<div class="paragraph">
<p>In an inheriting class, you can also add new properties. More attributes, verbs, exits and scripts can be added to those already present through the inheritance.</p>
</div>
<div class="paragraph">
<p>The properties available for use in classes, and thus also for instances, are described in detail in the following sections. In general, all of these can be mixed freely, however, some semantic restrictions apply as to when a particular property is or is not legal.</p>
</div>
</div>
<div class="sect3">
<h4 id="trueinitial-location"><a class="anchor" href="#trueinitial-location"></a>Initial Location</h4>
<div class="paragraph">
<p>Where an instance will be located when the game starts is set using an optional <code>Where</code> clause. If no such clause is used the instance will have no location. An instance without location is not present (in the view of the player) in the game until it is moved somewhere by a <code>Locate</code> statement.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ebnf" data-lang="ebnf">initial_location = where</code></pre>
</div>
</div>
<div class="paragraph">
<p>Only the <code>At</code> <code>what</code> and <code>In</code> <code>what</code> forms of the <code>Where</code> construct (see <em>WHERE Specifications</em> on page <em>138</em>) are allowed when describing an initial location of an instance.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-alan" data-lang="alan">The chest IsA object At treasury
…</code></pre>
</div>
</div>
<div class="paragraph">
<p>An instance inheriting from <code>location</code> cannot have an initial location that is <code>In</code> something, but it can be <code>At</code> some other location, creating a nesting of locations.</p>
</div>
</div>
<div class="sect3">
<h4 id="truenames"><a class="anchor" href="#truenames"></a>Names</h4>
<div class="paragraph">
<p>By default, the identifier (&#8220;author name&#8221;) for an instance is also the name shown to the player, and by which he will be able to refer to it. Normally you would want to override this with more elaborate and alternative names. You can do that using the <code>Name</code> clause.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ebnf" data-lang="ebnf">name = 'NAME' id {id} ['.']</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>Name</code> clause consists of a list of identifiers optionally followed by a full stop.</p>
</div>
<div class="paragraph">
<p>The identifiers given in the <code>Name</code> clause is used when the instance is presented to the player and which the player can use to refer to it. For example</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-alan" data-lang="alan">The south_door IsA object At south_of_house
  Name door
…
The south_of_house IsA location
  Name 'South of House'
…</code></pre>
</div>
</div>
<div class="paragraph">
<p>The quoted identifier used in the last example makes the name be one single text string. See <em>Words, Identifiers and Names</em> on page <em>153</em> for an explanation of this. This works for locations, which a player usually does not need to refer to, but for things the player should interact with, a more sophisticated mechanism is available.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-alan" data-lang="alan">The chair3 IsA object
  Name little wooden chair</code></pre>
</div>
</div>
<div class="paragraph">
<p>In this example, the name is a sequence of words. The semantics of this declaration is that the word &#8220;chair&#8221; is a noun and &#8220;little&#8221; and &#8220;wooden&#8221; become adjectives. When the player, in a command, want to refer to the object with the author name (identifier) <code>chair3</code>, he may use just &#8220;chair&#8221; if it is the only accessible object with &#8220;chair&#8221; as its noun, or he may distinguish between multiple chairs by also giving one or more adjectives to be more precise about which chair he meant.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The <code>Name</code> clause hides the author name, so in the example, the player will not be able to use <code>chair3</code> to refer to the instance.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>An explicit <code>Mentioned</code> clause will override the names for presenting the instance.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>It is possible to give an instance multiple names by listing a number of name clauses. Each one will define adjectives and a noun as described above. The result is that the player can use any of the names to refer to the object. For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-alan" data-lang="alan">The rod IsA object At grate
  Name rusty rod
  Name dynamite
  ...</code></pre>
</div>
</div>
<div class="paragraph">
<p>This would allow the player to refer to the object using either &#8216;rusty rod&#8217; or &#8216;dynamite&#8217;. (Or as a side effect &#8216;rusty dynamite&#8217;.) The first name clause is used for building a default description, if necessary (see <em>Description</em> on page <em>75</em>).</p>
</div>
<div class="paragraph">
<p>The character case used in any word is retained for output, but player input will always be matched without considering case. This way you can e.g. give capitalized names to people giving a correct output.</p>
</div>
<div class="sect4">
<h5 id="trueinheriting-names"><a class="anchor" href="#trueinheriting-names"></a>Inheriting Names</h5>
<div class="paragraph">
<p>Names can of course be inherited. This is done in an additive way so that any names inherited are appended to the <code>Name</code> clauses in the declaration. This ensures that the class or instance itself can control the primary name (the first <code>Name</code> clause). In addition, this has the effect that an instance inheriting from a class defining a <code>Name</code> will be possible to refer to also using the inherited name(s). Here is an example with fruits:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-alan" data-lang="alan">Every fruit IsA object Name fruit …
Every apple IsA fruit Name apple …
Every pear IsA fruit Name pear …
The gravensteiner IsA apple …
The macintosh IsA apple …</code></pre>
</div>
</div>
<div class="paragraph">
<p>In this example, both the pear and the apple would be possible to refer to using the word &#8220;fruit&#8221;. Both the gravensteiner and the macintosh would be apples, not only by name, but also by all other properties of apples.</p>
</div>
</div>
<div class="sect4">
<h5 id="truedisplaying-instances"><a class="anchor" href="#truedisplaying-instances"></a>Displaying Instances</h5>
<div class="paragraph">
<p>When an instance is to be shown to the player, it must be displayed in form of text. An instance can be printed in several different ways, it can be described or only mentioned. A description of an instance is a complete and usually more elaborate description of it (see <em>Description</em> on page <em>75</em>). However, often an instance must be mentioned as a part of a sentence, or in a list.</p>
</div>
<div class="paragraph">
<p>Such a mentioning of an instance will involve the articles, the name and possibly the <code>Mentioned</code> clause.</p>
</div>
<div class="paragraph">
<p>The basis for this mechanism is the short form, which by default is the first of the <code>Name</code>s. It will, however, be overridden by any existing <code>Mentioned</code> clause (see <em>Mentioned</em> on page <em>80</em>).</p>
</div>
<div class="paragraph">
<p>The short form can be automatically transformed to a description (for instances that have no <code>Description</code>) by inserting the article (see <em>Articles and Forms</em> on page <em>78</em>) and the short form in a default message. In the following example, output of the article is underlined and the short forms are emphasised, the rest is the default message templates.</p>
</div>
<div class="paragraph">
<p>There is a <em>little black book</em>, a <em>green pearl</em> and an <em>owl</em> here.</p>
</div>
<div class="paragraph">
<p>The interpreter also uses this principle when constructing lists of instances in container content lists (as the result of the execution of an implicit or explicit <code>List</code> statement, see page <em>121</em>).</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="truepronouns"><a class="anchor" href="#truepronouns"></a>Pronouns</h4>
<div class="paragraph">
<p>In player input, it is often handy and natural to refer to items using pronouns, such as &#8220;it&#8221;, &#8220;them&#8221; or &#8220;her&#8221;. Alan provides a means to define with which pronouns each instance can be associated.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ebnf" data-lang="ebnf">pronouns = 'PRONOUN' word { ',' word }</code></pre>
</div>
</div>
<div class="paragraph">
<p>The effect of associating a pronoun with an instance is that the player can refer to that instance explicitly in one command and then in a subsequent command use that pronoun to refer to it again. Assume the player input</p>
</div>
<div class="exampleblock gametranscript">
<div class="content">
<div class="paragraph">
<p>&gt; ask the priest about the bible</p>
</div>
</div>
</div>
<div class="paragraph">
<p>If the priest has been associated with the pronoun &#8220;him&#8221; and the bible with the pronoun &#8220;it&#8221;, the next command could be</p>
</div>
<div class="exampleblock gametranscript">
<div class="content">
<div class="paragraph">
<p>&gt; give it to him</p>
</div>
</div>
</div>
<div class="paragraph">
<p>Pronouns are inherited as any other property, but are overridden as soon as a pronoun clause is present.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The pre-defined class <code>entity</code> defines the pronoun &#8220;it&#8221; (or equivalent for other supported languages).</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="trueattributes"><a class="anchor" href="#trueattributes"></a>Attributes</h4>
<div class="paragraph">
<p>An attribute is a labelled value that instances have. The declarations of attributes are placed inside a class definition (in which case it will apply to all instances of that class or instances of any sub-class of it) or inside an instance declaration (in which case only this instance will have it, unless it overrode an already inherited attribute with new values). An attribute declaration, or a set of declarations, is introduced using one of the keywords:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ebnf" data-lang="ebnf">is = 'is'
   | 'are'
   | 'has'
   | 'can'</code></pre>
</div>
</div>
<div class="paragraph">
<p>And the actual of an attribute follows the structure:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ebnf" data-lang="ebnf">attribute_declaration = id
                      | 'NOT' id
                      | id integer
                      | id string
                      | id id
                      | id '{' values '}'</code></pre>
</div>
</div>
<div class="paragraph">
<p>An attribute can be of Boolean (having truth values), numeric, string, event, instance or set type. The type of an attribute is automatically inferred from the type of its initial value.</p>
</div>
<div class="paragraph">
<p>Combining the keywords with well chosen attribute names can give natural reading to your attributes:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-alan" data-lang="alan">The rats Are hungry
The cowboy Can shoot
The chest Is heavy
The combination_lock Has numbers {1,2,4,8}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Attributes that you want every instance of a class to have must be declared in that class. E.g. to declare a Boolean attribute that all instances of the class animal will have in common, the following code can be used:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-alan" data-lang="alan">Every animal …
  Is
    Not human.
…</code></pre>
</div>
</div>
<div class="paragraph">
<p>The attribute <code>human</code> will now be available in all instances of the class, without further declarations, and it will be false. If you want the attribute to have another value in a particular instance, you must declare it specifically in that instance and give it its desired value, which will be effective only for that instance. You can override the value in a subclass, e.g.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-alan" data-lang="alan">Every person IsA animal …
  Is
    human.
…</code></pre>
</div>
</div>
<div class="sect4">
<h5 id="trueboolean-attributes"><a class="anchor" href="#trueboolean-attributes"></a>Boolean Attributes</h5>
<div class="paragraph">
<p>A Boolean attribute is declared by simply giving the attribute name, or the name proceeded with the keyword <code>Not</code> (indicating a <strong>FALSE</strong> initial value):</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-alan" data-lang="alan">thirsty.
Not human.</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="truenumeric-and-string-attributes"><a class="anchor" href="#truenumeric-and-string-attributes"></a>Numeric and String Attributes</h5>
<div class="paragraph">
<p>Numeric and string attributes are declared by simply typing the value after the attribute name:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-alan" data-lang="alan">weight 42.
message "Enter password:".</code></pre>
</div>
</div>
<div class="paragraph">
<p>Note that string valued attributes are mainly intended for saving string parameters from the player input, like in</p>
</div>
<div class="exampleblock gametranscript">
<div class="content">
<div class="paragraph">
<p>&gt; scribble "Kilroy was here" on the wall</p>
</div>
</div>
</div>
<div class="paragraph">
<p>It is not intended for keeping long strings of descriptions, especially not as attributes to classes, as they (in the current implementation) require memory and takes time to initialise when starting the game.</p>
</div>
</div>
<div class="sect4">
<h5 id="trueevent-attributes"><a class="anchor" href="#trueevent-attributes"></a>Event Attributes</h5>
<div class="paragraph">
<p>Attributes can refer to events. Such an attribute is declared by giving the identifier of an event as its initial value.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-alan" data-lang="alan">Event e1
  "This is e1 running."
  Set e Of l To e2.
End Event.

The l IsA location
  Has e e1.
End The l.</code></pre>
</div>
</div>
<div class="paragraph">
<p>An attribute of the event type can for example be used to dynamically remember which event is scheduled, so that it can be cancelled.</p>
</div>
</div>
<div class="sect4">
<h5 id="truereference-attributes"><a class="anchor" href="#truereference-attributes"></a>Reference Attributes</h5>
<div class="paragraph">
<p>Reference attributes stores references to instances. Such an attribute is of instance type; the class is determined by the class of the initial instance that the attribute is referring. You may for example store a reference to the other side of a door.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-alan" data-lang="alan">The east_door IsA door.
  Has otherside west_door.
  …</code></pre>
</div>
</div>
<div class="paragraph">
<p>You must initialize a reference attribute with a reference to an instance belonging to a class having the required properties. Any subsequent assignment to the attribute will require that the new value is a member of the same class or a subclass of it. This ensures that operations on instances referenced by that attribute will always be possible.</p>
</div>
<div class="paragraph">
<p>Inside a class declaration, reference attributes may be initialized with a class identifier instead of a reference to an instance. This makes the attribute an <em>abstract</em> attribute, since it is defined but not initialized. Any instances inheriting from this class must then initialize the attribute, either explicitly or indirectly (by initializing it in an intermediate class). E.g.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-alan" data-lang="alan">Every door IsA object …
  Has otherside door.
End Every door.

The east_door IsA door.
  Has otherside west_door.
  …</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>If you need to set the initial value to refer to an instance of a sub-class of the actual class you want to allow, you can use an instance of the required class in the declaration and set its correct initial value in the <code>Start</code> or <code>Initialize</code> sections.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect4">
<h5 id="trueset-type-attributes"><a class="anchor" href="#trueset-type-attributes"></a>Set Type Attributes</h5>
<div class="paragraph">
<p>A Set is an unordered set of integers or instance references. Initial members must be listed in the declaration of the Set. See <em>Set Type</em> on page <em>52</em> for details on the Set type.</p>
</div>
<div class="paragraph">
<p>The type and class of allowed members is inferred from the values actually in the initial set. If they are instance references, the common ancestor of all members is used as the class of the allowed members. An empty set is only allowed as an initial value if the attribute is an inherited attribute since in this case, the member class is known from the inheritance and need not be indicated in the declaration.</p>
</div>
<div class="paragraph">
<p>You can also initialize a set type attribute with a set consisting only of a single class identifier. This will create an empty set with instance type members restricted to that particular class.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>If you require an initially empty set of another type, e.g. integer, and you cannot give the member class by inheriting it, you can initialize the set with a single value of the correct type and remove that value in the <code>Start</code> or <code>Initialize</code> sections.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect4">
<h5 id="trueinheriting-attributes"><a class="anchor" href="#trueinheriting-attributes"></a>Inheriting Attributes</h5>
<div class="paragraph">
<p>Attributes can be inherited like any other property. A declaration of an attribute with the same name as in any of the parents of the instance or class, will inherit the type of the attribute, you cannot change it in subsequent declarations. This means that any declaration of a different initial value than the inherited must follow the rules of type compatibility for assignment. (See <em>Type Compatibility</em> on page <em>53</em>.)</p>
</div>
<div class="paragraph">
<p>This also applies to classes of instances in the reference and set types attributes. Both these types allow references to instances. The initial value given at the point where the attribute is introduced determines the required class of the set members or referenced instances. This is retained throughout the complete inheritance of that attribute even if a subsequent initial value would imply a more specialised class. An example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-alan" data-lang="alan">Every door IsA object
  Has otherside someDoor.
End Every door.

Every lockable_door IsA door.
  Has otherside someLockableDoor.
End Every lockable_door.

The someDoor IsA door
  Has otherside someLockableDoor.
End The someDoor.

The someLockableDoor IsA lockable_door
  Has otherside someDoor.
End The someLockableDoor.</code></pre>
</div>
</div>
<div class="paragraph">
<p>In this example, the reference attribute <code>otherside</code> is introduced in the class <code>door</code>. Its initial value is referring to the class <code>door</code>. This makes the attribute refer to doors. In the subclass <code>lockable_door</code> the attribute is used with another initial value, here it refers to a subclass of <code>door</code>. Despite this, the attribute in the two door instances will allow reference to doors, as indicated by the first declaration (in the class <code>door</code>).</p>
</div>
<div class="paragraph">
<p>As a contrast, the same example can be used with abstract reference attributes (reference attributes that are defined, but not initialized, in the class declaration).</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-alan" data-lang="alan">Every door IsA object
  Has otherside door.
End Every door.

Every lockable_door IsA door.
  Has otherside lockable_door.
End Every lockable_door.

The someDoor IsA door
  Has otherside someLockableDoor.
End The someDoor.

The someLockableDoor IsA lockable_door
  Has otherside someDoor.
End The someLockableDoor.</code></pre>
</div>
</div>
<div class="paragraph">
<p>Now the class declarations refer to classes instead of instances in their declaration of the <code>otherside</code> attribute. This changes the semantics so that the subclass indicated by <code>lockable_door</code> actually makes it illegal to use a <code>door</code> as the declaration in <code>someLockableDoor</code> does, instead a <code>lockable_door</code> is required.</p>
</div>
<div class="paragraph">
<p>Using abstract reference attribute declarations in class declarations allows you to progressively refine the class of the instances that that attribute may refer to.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="trueinitialize"><a class="anchor" href="#trueinitialize"></a>Initialize</h4>
<div class="paragraph">
<p>The attributes of an instance can be initialized using values in the attribute declaration. This is usually sufficient for many situations. For more flexibility, the <code>Initialize</code> clause can be used.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ebnf" data-lang="ebnf">initialize = 'INITIALIZE' statements</code></pre>
</div>
</div>
<div class="paragraph">
<p>The clause makes it possible to execute arbitrary statements before the game is started. The statements are executed before the <code>Start</code> clause is executed. This enables calculation of more complex initial attribute values to be located within the instance, or class, that requires it. Of course general statements are also allowed so any prerequisites can be catered for.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-alan" data-lang="alan">Initialize
  Set first_course of This To Random In first_courses Of menu.
  Set second_course of This To Random In main_courses Of menu.
  Set third_course of This To Random In desserts Of menu.</code></pre>
</div>
</div>
<div class="paragraph">
<p>The current location is set to the start location, and the current actor is the hero during the execution of all <code>Initialize</code> clauses.</p>
</div>
<div class="paragraph">
<p>If the <code>Initialize</code> clause is inherited it will accumulate all clauses with clauses from base classes executing before the clause from the subclass. This lets the base classes do their initialization before the initialization of the more specialized, class or instance is performed.</p>
</div>
</div>
<div class="sect3">
<h4 id="truedescription"><a class="anchor" href="#truedescription"></a>Description</h4>
<div class="paragraph">
<p>The statements in the <code>Description</code> clause should print a description of the instance. These statements are executed when the hero encounters the instance. Depending on from which base class the instance inherits this can be a location description presented when the hero enters the location or when executing a <code>Look</code> statement. Other possibilities are descriptions of objects and actors. See sections <em>3.6</em> <em>Instances</em> on page <em>56</em> for descriptions of what inheriting from the predefined base classes means.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The description should not change any game state since it might not always be executed depending on the settings of the <code>Visits</code>. In particular, the description of a location should not move the hero; this might lead to a recursive loop of descriptions. This might instead be managed by the <code>Entered</code> clause.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>See also <em>Special Statements</em> on page <em>134</em>, concerning the <code>Visits</code> statement.</p>
</div>
<div class="paragraph">
<p>The syntax for simple descriptions is:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ebnf" data-lang="ebnf">description = 'DESCRIPTION' {statement}</code></pre>
</div>
</div>
<div class="paragraph">
<p>If the <code>Description</code> clause is missing for an instance (and no description is inherited), the Alan system will supply a default description such as &#8220;There is a round ball here.&#8221;. If there is a <code>Description</code> clause but it contains no statements, the object will be &#8216;invisible&#8217;, i.e. no description of it will be printed, not even a default one. This can be useful for objects already described by the location description, or of objects with particular properties.</p>
</div>
<div class="paragraph">
<p>Here are some examples of simple description declarations</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-alan" data-lang="alan">The south_of_house IsA location
  Name 'South of House'
  Is outdoors.
  Description
    "You are facing the south side of a white
     house. There is no door here, and all the
     windows are barred."
  …

The door IsA object
  Description
    "In the north wall there is a large wooden door."
    If door Is closed Then
      "It is closed."
    End If.
  …</code></pre>
</div>
</div>
<div class="paragraph">
<p>Before executing a description, you can check for various conditions to be met. A common example is the dark room. If there is no light source present, the description should not be printed. The syntax for such a description is</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ebnf" data-lang="ebnf">description = 'DESCRIPTION' [checks] [does]</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can guard the description with a check in the same form as with verb bodies (see <em>Verb Checks</em> on page <em>102</em> for a detailed description of checks). Of course, there are no qualifiers possible here. To be able to separate the checks statement from the actual description statements the keyword <code>Does</code> is required. This is an example of the checks for a dark location:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-alan" data-lang="alan">Every dark_location IsA location
  Description
    Check Sum Of light_source Here &gt; 1
      Else "It is pitch black. You are likely
            to be eaten by a grue.""
End Every dark_location.</code></pre>
</div>
</div>
<div class="paragraph">
<p>Note that it does not specify any description statements. This is because the checks and the actual description are inherited separately, as described in the table on page <em>62</em>. The actual descriptions are left for the instances.</p>
</div>
<div class="paragraph">
<p>If multiple description checks are available in the inheritance chain, they are all tested and must be met before any description is attempted. So the inheritance of description checks is &#8220;additive&#8221;.</p>
</div>
<div class="paragraph">
<p>If any check fails, the description will not be executed. This particularly also implies that the default listings and description of present objects and actors in location instances will not occur either. Note, however, that any events and actor actions <em>will</em> be shown. See <em>Locations</em> below for a description of default description mechanism for locations.</p>
</div>
<div class="paragraph">
<p>If neither a check nor any description statements occur after the keyword <code>Description</code> this <em>is</em> a description, but it is empty.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>You should <em>not</em> put statements that changes game state in the <code>Description</code> clause. Descriptions can be executed in various circumstances that the game author has no control over. Consider <code>Exit</code> statements and the <code>Entered</code> clause instead.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="truearticles-and-forms"><a class="anchor" href="#truearticles-and-forms"></a>Articles and Forms</h4>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ebnf" data-lang="ebnf">forms = indefinite | definite | negative

definite = 'DEFINITE' article_or_form

indefinite = [ 'INDEFINITE' ] article_or_form

negative = 'NEGATIVE' article_or_form

article_or_form = 'ARTICLE' {statement}
                | 'FORM' {statement}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The optional definite, indefinite and negative articles and forms can be used to define how an instance is printed in its indefinite, definite and negative forms. There are two cases for each form, either as an article prepended to the short display form of the instance (its names or <code>Mentioned</code> clause), or a complete form replacing the normal name printing.</p>
</div>
<div class="paragraph">
<p>Indefinite forms are used in e.g. inventory listings and when presenting instances that have no <code>Description</code> clause. Definitive forms are usually used in messages of the type:</p>
</div>
<div class="exampleblock gametranscript">
<div class="content">
<div class="paragraph">
<p>The door is locked.</p>
</div>
</div>
</div>
<div class="paragraph">
<p>The negative forms are used in standard messages of the type:</p>
</div>
<div class="exampleblock gametranscript">
<div class="content">
<div class="paragraph">
<p>I can&#8217;t see any door here.</p>
</div>
</div>
</div>
<div class="paragraph">
<p><code>Article</code>s and <code>Form</code>s can of course, be inherited.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The predefined base class <code>entity</code> defines the default definite, indefinite and negative article to be &#8220;the&#8221;, "a" and &#8220;any&#8221; (if using English). You may override this by using an <code>Add</code> statement.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="sect4">
<h5 id="truearticles"><a class="anchor" href="#truearticles"></a>Articles</h5>
<div class="paragraph">
<p>Printing the indefinite (or definite or negative) form of an instance having an indefinite (or definite or negative) article is simply performed by executing the article statements and then the normal printing of the instance, usually the first set of names.</p>
</div>
<div class="paragraph">
<p>For example</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-alan" data-lang="alan">The owl IsA object
  Indefinite Article "an"
:</code></pre>
</div>
</div>
<div class="paragraph">
<p>This results in output like</p>
</div>
<div class="exampleblock gametranscript">
<div class="content">
<div class="paragraph">
<p>There is an owl here.<br>
You are carrying an owl.</p>
</div>
</div>
</div>
<div class="paragraph">
<p>An article is not used when the instance is displayed when acting on multiple objects, as in:</p>
</div>
<div class="exampleblock gametranscript">
<div class="content">
<div class="paragraph">
<p>&gt; take everything<br>
(owl) Taken.</p>
</div>
</div>
</div>
<div class="paragraph">
<p>For instances that should not have any article at all, like &#8216;some money&#8217;, or &#8216;mr Andersson&#8217;, an <code>Indefinite Article</code> clause containing no statements must be used:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-alan" data-lang="alan">The money Name some money
  Article
:</code></pre>
</div>
</div>
<div class="paragraph">
<p>Instead of</p>
</div>
<div class="exampleblock gametranscript">
<div class="content">
<div class="paragraph">
<p>There is a some money here.</p>
</div>
</div>
</div>
<div class="paragraph">
<p>This will lead to the expected:</p>
</div>
<div class="exampleblock gametranscript">
<div class="content">
<div class="paragraph">
<p>There is some money here.</p>
</div>
</div>
</div>
</div>
<div class="sect4">
<h5 id="trueform"><a class="anchor" href="#trueform"></a>Form</h5>
<div class="paragraph">
<p>If an instance has a <code>Definite</code> (<code>Indefinite</code> or <code>Negative</code>) <code>Form</code>, either through declaration or inheritance, the printing of its definite, indefinite or negative form will be by executing the corresponding statements only; no article declaration is involved. In this way, the author gets complete control over the spelling and inflection of the instance name in definite, indefinite or negative forms. Some human languages will probably require more use of the <code>Form</code> form (like Swedish), and some less (like English). The forms are particularly useful if the natural language used, have different forms of the noun itself in definite an indefinite forms. An example is the Nordic languages, which use definite suffixes instead of articles.</p>
</div>
<div class="paragraph">
<p>The <code>Article</code> and <code>Form</code> are inherited as one property. That means that an instance may override its inherited form using either of the forms regardless of how its parent defined the form.</p>
</div>
</div>
<div class="sect4">
<h5 id="trueprinting"><a class="anchor" href="#trueprinting"></a>Printing</h5>
<div class="paragraph">
<p>You can use various forms of the <code>Say</code> statement (see <em>Say</em> on page <em>120</em>) to choose in which form the instance will be presented. In addition, the embedded parameter references allow selection of the form (<em>String Statement</em> on page <em>118</em>).</p>
</div>
</div>
<div class="sect4">
<h5 id="truementioned"><a class="anchor" href="#truementioned"></a>Mentioned</h5>
<div class="paragraph">
<p>The optional <code>Mentioned</code> clause overrides the name for displaying an instance in a short form that will be used when the instance is mentioned e.g. in listings of containers or when the <strong>all</strong> form of player input is used. A typical use of the <code>Mentioned</code> clause is to let some internal state of the instance be reflected in the short form, e.g. if you want the short form of a box to show if it is open or closed you cannot rely on the Names since they are static. Instead, the <code>Mentioned</code> clause can print a different short name depending on an attribute.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ebnf" data-lang="ebnf">mentioned = 'MENTIONED' {statement}</code></pre>
</div>
</div>
<div class="paragraph">
<p>For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-alan" data-lang="alan">Mentioned
  If mirror Is broken Then
    "broken"
  End If.
  "mirror"
...</code></pre>
</div>
</div>
<div class="exampleblock gametranscript">
<div class="content">
<div class="paragraph">
<p>&gt; take all<br>
(little black book) OK!<br>
(green pearl) OK!<br>
(broken mirror) OK!</p>
</div>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>A mention clause declared on a class will override the names of any instance that inherits from it.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect3">
<h4 id="truecontainer-properties"><a class="anchor" href="#truecontainer-properties"></a>Container Properties</h4>
<div class="paragraph">
<p>An instance can also be a container. This is declared by using the <code>Container</code> property clause. The grammar is</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ebnf" data-lang="ebnf">container_properties = ['WITH'] ['OPAQUE'] 'CONTAINER'
                           ['TAKING' id]
                           [limits]
                           [header]
                           [empty]
                           [extract]</code></pre>
</div>
</div>
<div class="paragraph">
<p>For example</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-alan" data-lang="alan">The chest IsA object
  With Container
    Limits …
    Header …
  Description …
  :
End The chest.</code></pre>
</div>
</div>
<div class="paragraph">
<p>A container is something that can contain instances. By default, the instances it can contain must be inheriting from the base class <code>object</code>, but by using the <code>Taking</code> clause, you can allow any instances.</p>
</div>
<div class="paragraph">
<p>Instances with the container property, &#8220;inherits&#8221; a special, pre-defined, Boolean attribute, <code>opaque</code>. This attribute can be manipulated in the same way as any other attribute. Its current value indicates if the instances inside the container are visible and accessible or not.</p>
</div>
<div class="paragraph">
<p>By default, containers expose their content, but by placing the keyword <code>Opaque</code> in the container declaration, you indicate that this container declaration will initially prohibit access to the contained instances. A typical use of this is to prohibit access to contents of closed cases, drawers and boxes. Once open such containers usually reveal the content, which then can be accessed. You can implement such behaviour by modifying the built in <code>opaque</code> attribute. For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-alan" data-lang="alan">The drawer IsA object
  With Opaque Container
    Header "The drawer contains"
  Verb open
    Does
      Make drawer Not opaque.
      List drawer.
  End Verb.
End The drawer.</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>If you want to hide the content of a container, you have to take care so that a <code>List</code> statement is not executed while the container is opaque since this will reveal the content. You can check the state of the <code>opaque</code> attribute like any other Boolean attribute.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The predefined <code>opaque</code> attribute is only available in instances and classes having the container property.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>When an instance with the container property is encountered during game play, it will be described as usual. If the instance has a default description the content of the container will be listed if it is not empty and not opaque.</p>
</div>
<div class="sect4">
<h5 id="truelimits"><a class="anchor" href="#truelimits"></a>Limits</h5>
<div class="paragraph">
<p>The <code>Limits</code> clause of the container property declaration put limitations on what and how much can be put in the container.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ebnf" data-lang="ebnf">limits = 'LIMITS' {limit}

limit = limiting_attribute 'ELSE' {statement}

limiting_attribute = attribute_definition
                   | 'COUNT' integer</code></pre>
</div>
</div>
<div class="paragraph">
<p>If any of these limits are exceeded when trying to locate anything inside the container, the statements in the corresponding <code>Else</code>-part will be executed and the players turn aborted. In fact, these checks are performed because of the execution of a <code>Locate</code> statement (usually as a result of the player issuing a command with the intent of placing something in a container). This means that the execution of a sequence of statements can actually be interrupted in the middle by these limitations.</p>
</div>
<div class="paragraph">
<p>The specification of an attribute, which must be a numeric attribute on the class the container takes (by default object), implies that the sum of this attribute of all objects in the container cannot exceed the value specified. The special attribute <code>Count</code> can be also be used and indicates a limitation on the number of instances allowed.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-alan" data-lang="alan">Container
  Limits
    weight 50 Else "You can not lift that much."
    Count 2 Else "You only have two hands!"</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The <code>Count</code> limit considers all instances in the container. This might differ from the number of instances listed e.g. if the container takes <code>Thing</code>s (which are not 'visible').</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Container properties are inherited in its entirety. Locations can&#8217;t have container properties.</p>
</div>
</div>
<div class="sect4">
<h5 id="trueheader-and-else"><a class="anchor" href="#trueheader-and-else"></a>Header and Else</h5>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ebnf" data-lang="ebnf">header = 'HEADER' {statement}

empty = 'ELSE' {statement}</code></pre>
</div>
</div>
<div class="paragraph">
<p><code>Header</code> is used when the contents of the container is listed. It is intended to produce something like</p>
</div>
<div class="exampleblock gametranscript">
<div class="content">
<div class="paragraph">
<p>"The box contains"</p>
</div>
</div>
</div>
<div class="paragraph">
<p>or</p>
</div>
<div class="exampleblock gametranscript">
<div class="content">
<div class="paragraph">
<p>"You are carrying"</p>
</div>
</div>
</div>
<div class="paragraph">
<p>It is followed by a list of instances mentioned. Section <em>Mentioned</em> on page <em>80</em> describes this listing.</p>
</div>
<div class="paragraph">
<p>The <code>Else</code>-part is used instead of the header if the container is empty.</p>
</div>
<div class="paragraph">
<p>If <code>Limits</code> or <code>Header</code> is missing, the Alan system supplies the default of no limits, and the messages output will be equivalent with</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-alan" data-lang="alan">Header
  "The &lt;container&gt; contains"
Empty
  "The &lt;container&gt; is empty."</code></pre>
</div>
</div>
<div class="paragraph">
<p>(&lt;container&gt; is replaced by the actual name of the instance.)</p>
</div>
</div>
<div class="sect4">
<h5 id="trueextract"><a class="anchor" href="#trueextract"></a>Extract</h5>
<div class="paragraph">
<p>The <code>Extract</code> clause defines what happens when anything is extracted from a container. Any <code>Locate</code> statement that moves an instance out of a container is considered an extraction. The extraction will be subject to the restrictions enforced by the <code>Extract</code> clause.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ebnf" data-lang="ebnf">extract = 'EXTRACT' [check] [does]
        | 'EXTRACT' {statement}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The extract clause, including optional <code>Check</code> and <code>Does</code> clauses, allows prohibiting the extraction of the item from the container depending on some condition. If the <code>Check</code> is present, it works the same way as for <code>Verb</code>s (see <em>Verb Checks</em> on page <em>102</em>). I.e. a <code>Check</code> without a guard expression will unconditionally prohibit extractions; a <code>Check</code> with an expression will evaluate that expression and, if false, execute its <code>Else</code> clause, and then abort the move. The <code>Does</code> clause will be executed if the optional <code>Check</code> passes, or there was no <code>Check</code>.</p>
</div>
<div class="paragraph">
<p>An <code>Extract</code> clause without a <code>Check</code>, but with a <code>Does</code>-clause, executes the Does-clause and then allows the extraction to take place. So, in a way, Checks, if triggered, prevents the extraction, and the <code>Does</code>-clause amends to it, being an extensions of the normal case, much like the <code>Check</code> and <code>Does</code>-clauses for Verbs (see section <em>3.10</em> <em>Verbs</em> on page <em>100</em>). The second form of the clause, with just the statements, is equivalent to an <code>Extract</code> with only a <code>Does</code>-clause.</p>
</div>
<div class="paragraph">
<p>An example use of the <code>Extract</code> clause is to prohibit, put restrictions on, or modify the behaviour when the hero attempts to take things carried by another actor.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-alan" data-lang="alan">The waiter IsA actor
  At bar.
  Is Not annoyed.
  Description
    "A slow-moving, traditionally dressed waiter is here."
    List waiter.
    If waiter Is annoyed Then
      "He is rather annoyed."
    End If.
  Container
    Header "The waiter is carrying"
    Else "The waiter is empty-handed."
    Extract Does "The waiter is annoyed by your presupposition."
      Make waiter annoyed.
End The waiter.</code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="trueverbs"><a class="anchor" href="#trueverbs"></a>Verbs</h4>
<div class="paragraph">
<p>Verbs declared inside an class or instance are inherited in the same way as other properties. See section <em>3.10</em> <em>Verbs</em> on page <em>100</em> for a description on how to declare verbs.</p>
</div>
<div class="paragraph">
<p>The verbs in a class or instance will only be a candidate for execution if the instance bound to a parameter is of the corresponding class, or is the instance. See <em>Verb Execution</em> on page <em>106</em> for a detailed explanation.</p>
</div>
</div>
<div class="sect3">
<h4 id="trueentered"><a class="anchor" href="#trueentered"></a>Entered</h4>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ebnf" data-lang="ebnf">entered = 'ENTERED' {statement}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>Entered</code> clause is only allowed in instances inheriting from the predefined class <code>location</code>. This clause will be executed whenever any actor enters the location. Game state changes can be made without restriction.</p>
</div>
<div class="paragraph">
<p>However, the <code>Entered</code> clause is primarily intended for setting up the location in a correct way, not for describing events, actions and states changes. For this the <code>Description</code>-clause is recommended.</p>
</div>
<div class="paragraph">
<p>The <code>Entered</code> clause can also be used to restrict the movements of actors other than the <code>Hero</code>. (The hero&#8217;s travels are controlled by exit checks as described in <em>Exits</em> on page <em>88</em>).</p>
</div>
<div class="paragraph">
<p>If some of the statements should only apply to a particular actor, it is possible to test for the <code>Current Actor</code> with a simple <code>If</code> statement.</p>
</div>
<div class="paragraph">
<p>The actor is located at the location before the clause is executed so <code>Current Location</code> will be the location having the clause.</p>
</div>
<div class="paragraph">
<p>Entered clauses are inherited and locations can be nested (see section <em>Locations</em>). The order of execution is explained by the following table:</p>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Outer Region</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>…</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Current Location</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Base class</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Outermost</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>:</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Leaf class</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Instance</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"></p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>This means that the first <code>Entered</code> clause to be executed is the clause in the base class of the outermost location, if any, then moving down the inheritance of the outermost. After that any parent classes for any intermediate locations are considered in the same way. Finally running any <code>Entered</code> clauses in the parents of the new location, ending with the clause in the location itself.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The <code>Entered</code> clause is only executed when the actor is entering the location. This goes for <em>all</em> actors, not only the player/hero. The actor will be at the location when the clause starts to execute.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>If it is the Hero that is moving, the <code>Description</code>, including the normal header containing the location name, of the new location will be executed <em>directly after</em> the <code>Entered</code> clause.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="trueexits"><a class="anchor" href="#trueexits"></a>Exits</h4>
<div class="paragraph">
<p>To build a traversable world of locations, they must be connected. This is done using exits. The syntax for an exit declaration is</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ebnf" data-lang="ebnf">exit = 'EXIT' id {',' id} 'TO' id [exit_body] '.'

exit_body = [checks] [does] 'END' 'EXIT' [id]</code></pre>
</div>
</div>
<div class="paragraph">
<p>An exit has a list of identifiers, all of which are considered directional words. I.e. when any of those words is input by the player, he will be located at the location identified as the target of the exit. It is possible to customize the exit using a <code>Check</code>, that must be satisfied to allow passage through the exit, and statements (<code>Does</code>) that will be executed when the player passes through. The checks work as described in <em>Verb Checks</em> on page <em>102</em>.</p>
</div>
<div class="paragraph">
<p>If either of the <code>Check</code> or <code>Does</code> clauses is present, the <code>End Exit</code> is required.</p>
</div>
<div class="paragraph">
<p>Two interconnected locations might be declared like:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-alan" data-lang="alan">The east_end IsA location Name 'East End of Hall'
  Description
    "This is the east end of a vast hall. Far
     away to the west you can see the west end."
  Exit w To west_end.
End The east_end.

The west_end IsA location Name 'West End of Hall'
  Description
    "From this western end of the large hall it
     is almost impossible to discern the
     opposite end to the east."
  Exit e To east_end.
End The west_end.</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>If an exit is declared from one location to another, and you want there to be an exit in the opposite direction, you have to define the reverse passage. It is not created automatically.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Exits are only allowed in classes or instances inheriting from the pre-defined class <code>location</code>.</p>
</div>
</div>
<div class="sect3">
<h4 id="truescripts"><a class="anchor" href="#truescripts"></a>Scripts</h4>
<div class="paragraph">
<p>The <code>Script</code> is the actor&#8217;s way of performing things. In a way, it corresponds to what the hero is ordered to do by the player&#8217;s typed-in commands.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ebnf" data-lang="ebnf">script = 'SCRIPT' id ['.'] [description] {step}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Every script has an identifier (the <strong>id</strong>) to identify it. A script is selected by the <code>Use</code> statement. When an actor is started following a script, it will continue with one step after the other, with all the other actors, including the hero, taking turns.</p>
</div>
<div class="paragraph">
<p>The optional description allowed in the beginning of a script is used instead of the general description (from the instance declaration) whenever the actor is executing that particular script. If it is not present, the general description is used.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-alan" data-lang="alan">Actor george
  Name George Formby
  Description "George Formby is here."
  Script cleaning.
    Description
      "George Formby is here cleaning windows."
    Step …
  Script tuning.
    Description
      "George Formby is tuning his ukelele."
    Step …
:</code></pre>
</div>
</div>
<div class="paragraph">
<p>An actor continues executing its script until</p>
</div>
<div class="ulist">
<ul>
<li>
<p>it reaches the end</p>
</li>
<li>
<p>another <code>Use</code> statement is executed for that actor</p>
</li>
<li>
<p>the actor is stopped using the <code>Stop</code> statement</p>
</li>
<li>
<p>something fails</p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>There are a few things that might fail when an actor executes. One example is an extract, which means that something is removed from a container. As container may define extract checks that action might be prevented. This means of course that that step is aborted, but also that the actor is automatically stopped, so no further steps from the script will be run. The author is responsible for handling this, e.g. by using rules to ensure that the condition is detected and handled correctly.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="sect4">
<h5 id="truesteps"><a class="anchor" href="#truesteps"></a>Steps</h5>
<div class="paragraph">
<p>A script is divided into steps. Each step contains statements representing what the actor will do in what corresponds to one player move. A step can be defined to be executed immediately next move, to wait a number of moves before it is executed or even to wait for a special situation (condition) to arise.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ebnf" data-lang="ebnf">step = 'STEP' {statement}
     | 'STEP' 'AFTER' expression {statement}
     | 'STEP' 'WAIT' 'UNTIL' expression {statement}</code></pre>
</div>
</div>
<div class="paragraph">
<p>For example</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-alan" data-lang="alan">Step Wait Until hero Here
  Locate waiter Here.
  "From the shadows a waiter emerges: $p
   '-Bonjour, monsieur', he says."
Step After ticksLeft Of train
  "The train driver enters the train, and after a brief
   moment the train starts to move."</code></pre>
</div>
</div>
<div class="paragraph">
<p>When an actor has executed the last step of the current script, it will do nothing more until the next <code>Use</code> statement is executed for this actor (the actor will not act, but still present at the location where it was). If this is not what you wanted, you can end each script with a new <code>Use</code> statement.</p>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="trueadditions"><a class="anchor" href="#trueadditions"></a>3.8. Additions</h3>
<div class="paragraph">
<p>In certain circumstances, you need to add properties to a class after it is defined. One simple such example is to add attributes to the predefined classes. To allow this the <code>Add</code> construct is available. It follows the grammar</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ebnf" data-lang="ebnf">addition = 'ADD' 'TO' 'EVERY' id
               [inheritance]
               {property}
           'END' 'ADD' ['TO'] [id] '.'</code></pre>
</div>
</div>
<div class="paragraph">
<p>Using this construct, you can add any property to a class without having access to its declaration. A standard library would make heavy use of this since it would be structured so that related verbs, their syntax and synonyms are packaged together. If such a package required particular attributes in classes, they could be added using the <code>Add</code> construct.</p>
</div>
</div>
<div class="sect2">
<h3 id="truesyntax-definitions"><a class="anchor" href="#truesyntax-definitions"></a>3.9. Syntax Definitions</h3>
<div class="paragraph">
<p>The syntax construct is used to specify the allowed structure of the input from the player. Each definition defines the syntax for one <code>Verb</code>. The effects triggered by the player input are declared using the <code>Verb</code> construct (see <em>Verbs</em> on page <em>100</em>).</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ebnf" data-lang="ebnf">syntaxes = 'SYNTAX' {syntax}

syntax = id '=' {element} syntax_end

element = id
        | '(' id ')' [indicator]

syntax_end = parameter_restrictions
           | '.'</code></pre>
</div>
</div>
<div class="paragraph">
<p>The syntax is defined as a number of <em>syntax elements</em> each being either a player word (a single <strong>id</strong>) or the name of a parameter (an identifier enclosed in parenthesis). Parameters may be in any position, including the first, a syntax with only parameters might be tricky for the interpreter to match to your intentions, as the complete set of allowed input then easily becomes ambiguous.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-alan" data-lang="alan">Syntax
  quit = 'quit'.
  examine = 'examine' (obj).
  command_north = (act) 'north'.
  unlock_with = 'unlock' (l) 'with' (k).</code></pre>
</div>
</div>
<div class="paragraph">
<p>When the player types a command, it is compared to the set of declared syntaxes. This provides a very flexible way to extend the allowed command set (see also <em>Player Input</em> on page <em>160</em> for details on general player input).</p>
</div>
<div class="paragraph">
<p>After the player input has been matched to an allowed syntax, the parameters are bound to the instances referred to by the player. The parameter identifiers in the syntax declaration then refer to those entities. Reference to attributes etc. will be done in the instance referred by the parameter.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-alan" data-lang="alan">Syntax open = open (obj).
:
  If obj Is open Then …
:</code></pre>
</div>
</div>
<div class="paragraph">
<p>In the example above, the parameter, <code>obj</code>, can be used in the declaration of the <code>open</code> verb and will, at execution time, refer to such a bound instance. The following table explains which instances in the game a parameter identifier (l &amp; k, from the <code>unlock_with</code> syntax above) will actually refer to.</p>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Player input</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">l</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">k</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">&gt; unlock the door with the key</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">door</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">key</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">&gt; unlock the bottom drawer with the rusty knife</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">bottom drawer</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">rusty knife</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">&gt; unlock the skeleton with the tiny blue chair</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">skeleton</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">tiny blue chair</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>This, of course, provided that there is an instance that will match the player input, given the adjectives and nouns in the input and in instance declarations.</p>
</div>
<div class="paragraph">
<p>It is allowed to define multiple syntaxes for the same identifier (verb). See section <em>Syntax Synonyms</em> on page <em>97</em>.</p>
</div>
<div class="sect3">
<h4 id="trueindicators"><a class="anchor" href="#trueindicators"></a>Indicators</h4>
<div class="paragraph">
<p>Following a parameter, indicators are allowed in syntax declarations.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ebnf" data-lang="ebnf">indicator = '*'' | '!''</code></pre>
</div>
</div>
<div class="paragraph">
<p>There are two indicators available:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>&#8216;<code>+</code>&#8217; This parameter can reference multiple instances (for example by the player using <strong>all</strong> or concatenating a number of parameters using a conjunction like <strong>and</strong>, see <em>Player Input</em> on page <em>160</em>).</p>
</li>
<li>
<p>&#8216;<code>!</code>&#8217; The parameter (the instance the player refers to in this position in the syntax) need not be present at the current location. The default case is that the Alan interpreter requires that a referenced instance must be present at the same location as the hero (if the parameter inherits from <code>thing</code>. Note that <strong>entities</strong> are always accessible). For cases when the player must be able to refer to objects and actors that are not present (e.g. in a verb like <code>talk_about</code>) this omnipotent indicator can be used to force the interpreter to accept references to any object or actor.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>An example</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-alan" data-lang="alan">Syntax
  take = 'take' (obj)*.
  drop = 'drop' (obj).</code></pre>
</div>
</div>
<div class="paragraph">
<p>This shows the syntax definitions for the verbs <code>take</code> and <code>drop</code>. <code>take</code> also allows multiple objects. This would make the following inputs possible</p>
</div>
<div class="exampleblock gametranscript">
<div class="content">
<div class="paragraph">
<p>&gt; take everything except the pillow</p>
</div>
<div class="paragraph">
<p>&gt; drop the vase</p>
</div>
</div>
</div>
<div class="paragraph">
<p>Refer to <em>Player Input</em> on page <em>160</em> for details on the input of references to multiple parameters (such as objects). The above declarations would force the interpreter to reject player input like</p>
</div>
<div class="exampleblock gametranscript">
<div class="content">
<div class="paragraph">
<p>&gt; drop the shovel and the bucket</p>
</div>
</div>
</div>
<div class="paragraph">
<p>This is because the syntax for the verb <code>drop</code> does not allow multiple references by not including the multiple-indicator. Another example using the <code>!</code> indicator:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-alan" data-lang="alan">Syntax
  talk_about = 'talk' 'to' (act) 'about' (subj)!.
  find = 'find' (obj)!.</code></pre>
</div>
</div>
<div class="paragraph">
<p>Even if the robber or the key is not present, it will allow the player to say</p>
</div>
<div class="exampleblock gametranscript">
<div class="content">
<div class="paragraph">
<p>&gt; talk to the policeman about the robber</p>
</div>
<div class="paragraph">
<p>&gt; find the key</p>
</div>
</div>
</div>
<div class="paragraph">
<p>For more information on player inputs, refer to <em>Player Input</em> on page <em>160</em>.</p>
</div>
<div class="paragraph">
<p>Indicators given in one syntax declaration can affect other syntaxes if they have identical beginnings, like</p>
</div>
<div class="exampleblock gametranscript">
<div class="content">
<div class="paragraph">
<p>&gt; put everything on</p>
</div>
</div>
</div>
<div class="paragraph">
<p>and</p>
</div>
<div class="exampleblock gametranscript">
<div class="content">
<div class="paragraph">
<p>&gt; put everything on the table</p>
</div>
</div>
</div>
<div class="paragraph">
<p>Even if only one of the syntax declarations indicate that the first parameter should allow multiple instances, both syntaxes will actually allow this because they have the same syntax part before the parameter, in this case the verb &#8220;put&#8221;.</p>
</div>
</div>
<div class="sect3">
<h4 id="trueparameter-restrictions"><a class="anchor" href="#trueparameter-restrictions"></a>Parameter Restrictions</h4>
<div class="paragraph">
<p>To restrict the types of entities the player may refer to in the place of a parameter, its class can be defined by using explicit test in the syntax declaration.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ebnf" data-lang="ebnf">parameter_restrictions = 'WHERE' restriction
                             {'AND' restriction}

restriction = id 'ISA' restriction_class
                  'ELSE' {statement}

restriction_class = id
                  | 'CONTAINER'</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Any predefined or user defined class can be used. Particularly note that integer and string are pre-defined classes (see <em>The Pre-defined Classes</em> on page <em>34</em>).</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The following example describes the syntax for a verb that only allows <code>object</code>s as its parameters (this is however also the default, see below).</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-alan" data-lang="alan">Syntax
  take = 'take' (obj)
    Where obj IsA object
      Else "You can't take that."</code></pre>
</div>
</div>
<div class="paragraph">
<p>Each parameter may be restricted to refer only to instances of particular classes or instances with the container property, or numeric or string literals. The statements following the <code>Else</code> will be executed if that restriction is not met, i.e. if the player refers to an instance not in the specified class or classes. The default restriction is <code>Object</code>, i.e. if no class restriction is supplied for that parameter identifier the player may only refer to objects at that position in his input.</p>
</div>
<div class="paragraph">
<p>A more elaborate example of prerequisites for conversation might look like:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-alan" data-lang="alan">Syntax
  talk_about = 'talk' 'to' (act) 'about' (sub)!
    Where act IsA actor
      Else "Don't you think talking to a person
            might be better?!?!"
    And sub IsA subject
      Else
        Say act. "does not know anything about
                  that."
…</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can combine multiple restrictions, even for the same parameter. If they refer to the same parameter, they must be successively more restricted.</p>
</div>
<div class="paragraph">
<p>For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-alan" data-lang="alan">Where obj IsA object Else …
  And obj IsA openable_object Else …
  And obj IsA door Else …</code></pre>
</div>
</div>
<div class="paragraph">
<p>References to attributes in the source are only allowed if it can be guaranteed that they exist during run-time. The class restrictions placed on a parameter are used by the compiler to make this guarantee for code executed by player input (verb bodies). The same applies for other semantic restrictions, e.g. you can only use a parameter in a <code>List</code> statement if it has been restricted to having the container property.</p>
</div>
<div class="paragraph">
<p>You can use <code>IsA Container</code> to restrict instances to only those entities that are containers (have the container property).</p>
</div>
<div class="paragraph">
<p>If there is no restriction for a parameter, it is restricted to the class <code>object</code>.</p>
</div>
</div>
<div class="sect3">
<h4 id="truesyntax-synonyms"><a class="anchor" href="#truesyntax-synonyms"></a>Syntax Synonyms</h4>
<div class="paragraph">
<p>It is possible to create multiple syntax declarations for the same verb. The semantics of this is that any of the input formats will be accepted and trigger the same verb action. This is a way to define syntactical synonyms, which are useful to allow multiple forms of input for the same action, increasing chances that the player will find the correct form. For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-alan" data-lang="alan">Syntax give = give (o) to (p) …
Syntax give = give (p) (o) …</code></pre>
</div>
</div>
<div class="paragraph">
<p>The syntaxes must be compatible in the sense that the parameters must be named the same. However, the order of the parameters may differ, they will automatically be mapped as appropriate.</p>
</div>
<div class="paragraph">
<p>Restrictions are only allowed in the first of such syntax declarations. These restrictions will be applied regardless of which syntax was used.</p>
</div>
</div>
<div class="sect3">
<h4 id="truedefault-syntax"><a class="anchor" href="#truedefault-syntax"></a>Default Syntax</h4>
<div class="paragraph">
<p>If no <code>Syntax</code> is defined for a <code>Verb</code> at all, this is handled with one of two default syntaxes according to the two templates below:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-alan" data-lang="alan">Syntax &lt;1&gt; = &lt;1&gt;.
Syntax &lt;1&gt; = &lt;1&gt; (&lt;2&gt;).</code></pre>
</div>
</div>
<div class="paragraph">
<p>The place-holders represents 1) the name of the verb, and 2) the class in which the verb is first encountered.</p>
</div>
<div class="paragraph">
<p>The first template is used for verbs that are declared globally, i.e. outside of any class or instance. Since these are only applied when no parameters are used, this will effectively work for simple &#8216;verb-only&#8217; <code>Verb</code>s, such as <code>quit</code>, <code>look</code>, <code>save</code> etc.</p>
</div>
<div class="paragraph">
<p>Verbs declared in an instance or a class, for which there is no syntax, by default receives a syntax of the common verb/object type corresponding to the second template above. This is a reasonable syntax for many cases and restricts the parameters to instances of the class where the verb was declared. It also implies that the default name for the single parameter is the same as the name of that class, e.g. <code>object</code>, <code>actor</code>, <code>thing</code>, etc. (See <em>WHAT Specifications</em> on page <em>140</em> for the implications of this.)</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>A verb which is declared in a number of classes, or instances of various heritage, can not be handled with the default rules, since that would imply that the parameter should be restricted to multiple classes at the same time. This case must be handled explicitly.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>A verb with no declared syntax, which is declared in a location, will receive a default syntax restricting the parameter to the class <code>location</code>, which probably is not what you wanted.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="truescope"><a class="anchor" href="#truescope"></a>Scope</h4>
<div class="paragraph">
<p>If the player inputs a command following a syntax which requires parameters, the interpreter first determines if the referenced instance is in scope. This is performed even before the restrictions are executed.</p>
</div>
<div class="paragraph">
<p>There are a number of ways to get an instance into scope:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Instances of <code>entity</code>, and of any user defined subclasses thereof, are always in scope.</p>
</li>
<li>
<p>An instance of <code>thing</code> and its subclasses at the current location, including any nested locations, is in scope.</p>
</li>
<li>
<p>An instance of any class inside a container that is in scope is in scope, unless that container is opaque and closed. See <em>Container Properties</em> on page <em>81</em> for details.</p>
</li>
<li>
<p>If the syntax indicated a parameter as omni-potent, any instance is in scope for that parameter position.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>If the interpreter finds multiple instances matching the input (the set of given adjectives and noun), it will try to disambiguate with preference to instances present, i.e. at the location of the hero. If there still are multiple candidates after this, the interpreter will print a message and abort execution of the current command.</p>
</div>
<div class="paragraph">
<p>When all parameter positions in the syntax have been resolved in this way, the restrictions are executed.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="trueverbs-2"><a class="anchor" href="#trueverbs-2"></a>3.10. Verbs</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ebnf" data-lang="ebnf">verb = ['META'] 'VERB' id {',' id}
           verb_body
       'END' 'VERB' [id] '.'

verb_body = simple_verb_body
          | {verb_alternative}

simple_verb_body = [check] [does]</code></pre>
</div>
</div>
<div class="paragraph">
<p>A verb declaration specifies what to check and the effects of something the player does (i.e. commands using a syntactically legal input).</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-alan" data-lang="alan">Verb take, get
  …
End Verb take.</code></pre>
</div>
</div>
<div class="paragraph">
<p>Verbs can be declared at two different levels, global (outside any other declaration) or inside a declaration of a class or instance, including inside an <code>Add</code> construct.</p>
</div>
<div class="paragraph">
<p>A global declaration will only be considered when the verb is not applied to any instance (i.e. such as the player referring to an object). In fact, a global verb cannot include any parameters in their syntax declaration.</p>
</div>
<div class="paragraph">
<p>A verb declaration inside a class definition or an instance will be considered if that instance (or an instance inheriting from that class) is used as a parameter in the input.</p>
</div>
<div class="paragraph">
<p>The identifiers in the list (<code>take</code> and <code>get</code> in the example above) will be player words that by default can be used to invoke the verb. But if a <code>Syntax</code> is declared for the <code>Verb</code> (see <em>Syntax Definitions</em> on page <em>92</em>), the identifiers in the list will not be accessible to the player, instead the sequence of words and parameters specified in the <code>Syntax</code> must be used.</p>
</div>
<div class="paragraph">
<p>If there is more than one identifier in the list, as in the example above, this can be viewed as a short hand for declaring identical checks and bodies for all the verbs in the list. This will create synonymous actions for different verbs on the level where the verb declaration is. They may differ in implementation at other places, i.e. if they are declared in the same verb declaration on one level in an inheritance tree, they can still have different bodies on another level.</p>
</div>
<div class="sect3">
<h4 id="truemeta-verbs"><a class="anchor" href="#truemeta-verbs"></a>Meta Verbs</h4>
<div class="paragraph">
<p>Any action from the player usually takes one 'tick' in the default simulated game time. Sometimes you want a player command to <em>not</em> take a 'tick', for example administrative commands like 'help', 'score' etc.</p>
</div>
<div class="paragraph">
<p>You can do this by attaching <code>Meta</code> in front of the verb definition:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-alan" data-lang="alan">Meta Verb 'score'
  Does
    Score.
End Verb.</code></pre>
</div>
</div>
<div class="paragraph">
<p>If your verb has multiple definitions, e.g. for various classes, applying <code>Meta</code> to any one of them will make the verb a meta verb, meaning that if the player uses that verb in any context and on any instance, it will take no tick, even if that particular definition did not have the <code>Meta</code> property explicitly expressed. A library might decide that 'score' was a meta verb and there is nothing you, as an author, can do to override that short of editing the library source.</p>
</div>
<div class="paragraph">
<p>A <code>Meta</code> verb also does not trigger evaluation of rules and events so they are genuinely &#8220;outside&#8221; the game and should only be used with verbs that are not considered part of the players progression inside the game.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The meta verb feature only applies to the built in timing mechanism known as 'ticks', where every player command counts as 1 tick. It is possible to implement your own timing mechanism, in which case the <code>Meta</code> does not help.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="trueverbs-in-locations"><a class="anchor" href="#trueverbs-in-locations"></a>Verbs in Locations</h4>
<div class="paragraph">
<p>A special case is a verb declared in, or inherited by, the location where the player currently is located. If this verb is used, any checks or body of that verb will be considered before the verbs in the parameters. An example might be a location representing walking on a high wire. Anything dropped at the following location will disappear:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-alan" data-lang="alan">The high_wire IsA location
  Verb drop
    Does Only
      Locate o At limbo. –- Instead of "here".
  End Verb.
End The.</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="trueverb-checks"><a class="anchor" href="#trueverb-checks"></a>Verb Checks</h4>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ebnf" data-lang="ebnf">check = unconditional_check
      | check_list

unconditional_check = 'CHECK' {statement}

check_list = 'CHECK' expression 'ELSE' {statement}
             {'AND' expression 'ELSE' {statement}</code></pre>
</div>
</div>
<div class="paragraph">
<p>To determine if the action is possible to carry out, the <code>Check</code>s are executed. Which checks to run, is determined by the class of the instances bound by the parameters to the verb. All checks in the inheritance tree are tried by starting at the base class. In this way, the most general checks are tried first, then more specific.</p>
</div>
<div class="paragraph">
<p>A typical use of a check is to verify if the parameter has a particular property:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-alan" data-lang="alan">Verb take
  Check obj Is moveable
    Else "You can't take that."
  …
End Verb take.</code></pre>
</div>
</div>
<div class="paragraph">
<p>If no expression is specified for a check, that check will always fail, in effect becoming an unconditional check. This is useful for preventing certain actions, such as at specific locations, since the checks are always executed first.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-alan" data-lang="alan">The jumpless IsA Location
  Verb jump
    Check "You can't do that here."
  End Verb jump.
End The jumpless.</code></pre>
</div>
</div>
<div class="paragraph">
<p>If any check should fail, the execution of the current verb is interrupted and the statements following the failing check are executed. The user (player) is then prompted for another command. So in the above example, the verb &#8220;jump&#8221; will always result in &#8220;You can&#8217;t do that here.&#8221; at the location &#8220;jumpless&#8221;.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p><code>Check</code>s are intended to take care of any <em>exceptions</em> for executing the normal case. The normal, or positive/affirmative, case should be handled by the <code>Does</code>-clause.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>With this in mind, <code>Check</code>s are also used when handling the user input <strong>all</strong> (see <em>Player Input</em> on page <em>160</em> for details on possible player input). The mechanisms for this involve examining all objects at the current location and evaluating all checks for the verb. Any objects that do not pass the checks are not considered for execution. This limits the handling of <strong>all</strong> to only executing the verb bodies for objects that are reasonable, i.e. that will not fail in the <code>Check</code>s.</p>
</div>
<div class="paragraph">
<p>For example assuming the above definition of the verb take and a location containing the two objects, <code>ball</code> and <code>box</code>, of which only the <code>ball</code> is <code>takeable</code> the player input</p>
</div>
<div class="exampleblock gametranscript">
<div class="content">
<div class="paragraph">
<p>&gt; take all</p>
</div>
</div>
</div>
<div class="paragraph">
<p>would result in <strong>all</strong> representing only the ball. See <em>Player Input</em> on page <em>160</em> for an explanation of the player view of this.</p>
</div>
</div>
<div class="sect3">
<h4 id="truedoes-clause"><a class="anchor" href="#truedoes-clause"></a>Does-clause</h4>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ebnf" data-lang="ebnf">does = [qualifier] {statement}

qualifier = 'BEFORE'
          | 'AFTER'
          | 'ONLY'</code></pre>
</div>
</div>
<div class="paragraph">
<p>If all checks succeed, the execution of the verb will be carried out. Multiple verb bodies may be involved. The order is by default to first execute the body of any verb declaration for the current location (including verb bodies inherited by it). Each parameter is then examined to find any declarations of that verb for the instance (including inherited verb bodies). These verb bodies are then executed in the order in which the parameters occurred in the syntax declaration, for each parameter starting with the body in the most basic class. By default, all of the involved verb bodies are executed. This is the most natural order and covers most cases.</p>
</div>
<div class="paragraph">
<p>In some infrequent situations, another order may be necessary. By using the qualifiers, <strong>Before/After/Only,</strong> the author can decide which verb bodies will be executed and in which order (see <em>Verb Qualification</em> below for details).</p>
</div>
<div class="paragraph">
<p>A simple verb example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-alan" data-lang="alan">Verb take
  Check obj Not In inventory
    Else "You already have that."
  Does
    Locate obj In inventory.
End Verb take.</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="trueverb-alternatives"><a class="anchor" href="#trueverb-alternatives"></a>Verb Alternatives</h4>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ebnf" data-lang="ebnf">verb_alternatives = 'WHEN' id simple_verb_body</code></pre>
</div>
</div>
<div class="paragraph">
<p>When a <code>Verb</code> is declared within an instance declaration, verb alternatives are allowed. These alternatives are used in conjunction with the <code>Syntax</code> declaration defined for the verb and allows differentiating between the instances occurring in different places in the input.</p>
</div>
<div class="paragraph">
<p>When a player inputs a command, each parameter in the syntax (see above) is bound to an actual instance or receives the value of a literal, depending on the specified syntax. To determine the checks to test and verb bodies to execute the parameters are examined in turn according to the algorithm described in the section <em>Verb Qualification</em> below. Each instance may have different verb bodies executed depending on at which position it occurred (to which parameter it was bound).</p>
</div>
<div class="paragraph">
<p>For example, assume the following syntax definition</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-alan" data-lang="alan">Syntax break_with = 'break' (o) 'with' (w).</code></pre>
</div>
</div>
<div class="paragraph">
<p>If used with the <code>delicate_vase</code> actions could differ if it occurs as the direct object (o), or if it occurs as the indirect object (w). To implement this the <code>Verb</code> body for <code>break_with</code> should also differ. For each parameter in the syntax, you may define different actions by supplying a verb alternative for each parameter identifier. The verb declaration could look like</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-alan" data-lang="alan">The feather IsA object
  Verb break_with
    When o Does
      "The feather is even more flat than before."
      Make feather flat.
    When w Does
      "There is not much that you can break with a feather!"
  End Verb break_with.
End The feather.</code></pre>
</div>
</div>
<div class="paragraph">
<p>If no alternative is explicitly specified the verb body will be considered for all positions in the syntax. The compiler will warn for this if the syntax allowed the class of instance to occur in all the parameter positions.</p>
</div>
</div>
<div class="sect3">
<h4 id="trueverb-qualification"><a class="anchor" href="#trueverb-qualification"></a>Verb Qualification</h4>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ebnf" data-lang="ebnf">qualifier = 'BEFORE'
          | 'AFTER'
          | 'ONLY'</code></pre>
</div>
</div>
<div class="paragraph">
<p>The order in which the different verb bodies are executed is normally from the most general to the most specific. But, to allow for local differences, i.e. special handling of the verb at this location, a any possible definition of this verb in the current location (included inherited verb bodies) are considered first. Then, the verb bodies in the parameters (in the order they appeared in the syntax definition) on which the verb was applied are examined to find and execute their verb definitions. For each parameter, its most general definition is executed first, verb bodies down the inheritance tree next, ending with any verb body declared in the specific instance bound to that parameter.</p>
</div>
<div class="paragraph">
<p>In most circumstances, this is the most logical order, but if another order is required, the verb qualifiers <code>After</code>, <code>Before</code> and <code>Only</code> may be used to alter this behaviour. The qualifiers alter the order of execution and a strict definition of this is described below.</p>
</div>
</div>
<div class="sect3">
<h4 id="trueverb-execution"><a class="anchor" href="#trueverb-execution"></a>Verb Execution</h4>
<div class="paragraph">
<p>First all parameters are evaluated according to the syntax restrictions (see <em>Parameter Restrictions</em> on page <em>96</em>). Then, if they passed, the checks of all verb declarations are evaluated (see <em>Verb Checks</em> on page <em>102</em>). Finally the verb bodies are executed in the normal order as explained by the table below.</p>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 14.2857%;">
<col style="width: 14.2857%;">
<col style="width: 14.2857%;">
<col style="width: 14.2857%;">
<col style="width: 14.2857%;">
<col style="width: 14.2857%;">
<col style="width: 14.2858%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Outer Region</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>…</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Current Location</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>First parameter</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>…</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Last parameter</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Base class (entity)</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Outermost</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>:</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Leaf class</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Instance</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Innermost</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>The table above illustrates the normal order of execution of verb bodies and checks. Starting with any base classes to the outermost region (containing location), continuing to the actual instance of that location, as illustrated by the first column. It then continues with any inner regions (second column) and the current location itself (third column). The execution then proceeds to the parameters of the syntax in order (columns four through six), traversing the inheritance tree from the base class to the instance.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>If you add a verb to the class <code>entity</code>, it will be inherited by all instances, including locations and objects. This will result in the execution of that verb body multiple times, since it will be in every column in the table above.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="sect4">
<h5 id="truecontrolling-execution-with-qualifiers"><a class="anchor" href="#truecontrolling-execution-with-qualifiers"></a>Controlling Execution with Qualifiers</h5>
<div class="paragraph">
<p>There are cases where you don&#8217;t want all the bodies to be executed, or there is a special need to execute them in a different order. The most common case is to prohibit other bodies to be executed, e.g. a verb body in a location might want to stop the player from throwing any object. This verb body must then ensure that it is the only verb bodies to be executed. This can be done using the <code>Only</code> qualifier (see <em>Verb Qualification</em> on page <em>106</em>).</p>
</div>
<div class="paragraph">
<p>Qualifiers control the order of execution of verb bodies. How does this work?</p>
</div>
<div class="paragraph">
<p>First, starting at the &#8220;innermost&#8221; according to the table above, the verb in the last parameter (if any) is investigated and, if any of its (inherited) verb bodies have the <code>Before</code> or <code>Only</code> qualifier it is executed. If the qualifier was <code>Only</code> the execution is also aborted at this stage and no more verb definitions are examined, otherwise the other parameters are examined in the same way.</p>
</div>
<div class="paragraph">
<p>In the next step, the current location is examined and, if it contains (or inherits) a verb definition with a <code>Before</code> or <code>Only</code> qualifier, that definition is now executed (and if the qualifier was <code>Only</code>, execution is aborted). Since locations can be nested, the surrounding locations are then examined in the same way.</p>
</div>
<div class="paragraph">
<p>As a result of this behaviour, a <code>Before</code> qualifier in the verb definition in an object parameter will supersede an <code>Only</code> qualifier in the location.</p>
</div>
<div class="paragraph">
<p>At this stage, all <code>Before</code> and <code>Only</code> qualifiers are handled appropriately. This only leaves the definitions without any qualifier or with the <code>After</code> qualifier. The outermost verb body (as indicated in the table above) is examined and if it did not have the <code>After</code> specification, it is executed (if it had an <code>Only</code> qualifier execution is stopped after executing it). Any definition of the verb in the current location is again examined and, if it did not have the <code>After</code> qualifier, it is executed. What remains is to execute the verb definition in the parameters if they have not been executed already, and to execute the location definition if they where declared with the <code>After</code> qualifier.</p>
</div>
<div class="paragraph">
<p>So in short (with base class definitions of the outermost location being the outermost and the instance bound to the last syntax parameter the innermost):</p>
</div>
<div class="ulist">
<ul>
<li>
<p>From the outside in, find any <code>Before</code> or <code>Only</code> definitions and execute them (stop if <code>Only</code> found).</p>
</li>
<li>
<p>From the inside out, execute any definitions not already executed and not declared with the <code>After</code> qualifier.</p>
</li>
<li>
<p>Execute the remaining verb definitions (those with an <code>After</code> qualifier) from the outside in.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The second item in the above list is equivalent to the normal order of execution.</p>
</div>
<div class="paragraph">
<p>The qualifiers are a powerful but confusing concept. The normal order of execution is usually appropriate and only in special cases should qualifiers be used. When they are needed, you will find that one qualifier at the correct definition will normally do the trick. The above algorithm is used to get a strict definition of the execution order. It is not expected that all this complex behaviour will be needed in practice.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>All checks for a <code>Verb</code> will always be run in the normal order regardless of any <code>Before</code>/<code>After</code>/<code>Only</code> qualifiers.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>An example of the use of qualifiers is to ensure that only the verb body within the object is executed:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-alan" data-lang="alan">The bomb IsA object
  Verb examine
    Does Only
      "Your curious fingering at the intricate
       mechanism sets it of. BOOOM!"
      Quit.
  End Verb examine.
End The bomb.</code></pre>
</div>
</div>
<div class="paragraph">
<p>This also illustrates the fact that the most commonly used qualifier is the <code>Only</code> qualifier since it is used whenever all other behaviour is replaced by some special behaviour.</p>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="trueevents"><a class="anchor" href="#trueevents"></a>3.11. Events</h3>
<div class="paragraph">
<p>An event is a sequence of statements executed at a specified time (count of turns). It is also executed at some specific location. An event can e.g. be used to create an explosion where the bomb is three moves from now or to let the ceiling of the cave fall down in five moves.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-alan" data-lang="alan">Event nearby_explosion
  "Somewhere in the distance there is an explosion."
  Make bomb gone_off.
  Schedule small_avalanche After 2.
End Event.</code></pre>
</div>
</div>
<div class="paragraph">
<p>The body of an event can be any sequence of statements. They can however not refer to any parameters, since no verb is executing, or the <code>Current Actor</code>. See <em>Run-time Contexts</em> on page <em>162</em>.</p>
</div>
<div class="paragraph">
<p>Events may be scheduled and cancelled with the <code>Schedule</code> and <code>Cancel</code> statements (see <em>Event Statements</em> on page <em>125</em>).</p>
</div>
</div>
<div class="sect2">
<h3 id="truerules"><a class="anchor" href="#truerules"></a>3.12. Rules</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ebnf" data-lang="ebnf">rule = 'WHEN' expression ('THEN' | '=&gt;')
           {statement}
       ['END' 'WHEN' '.' ]</code></pre>
</div>
</div>
<div class="paragraph">
<p>A rule is an arbitrary expression, which, when true, results in the execution of some given statements. Rules can only be declared on the global level (not inside classes or instances). The main intended use of rules is to detect particular situations and then trigger some action. Typically they can be used to make things happen when certain situations arise, such as starting an actor when the hero enters the cave.</p>
</div>
<div class="paragraph">
<p>Here is an example that investigates if the hero is in the cave and if so, activates the monster:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-alan" data-lang="alan">When hero At cave And monster Not active Then
  Use Script hunting For monster.
End When.</code></pre>
</div>
</div>
<div class="paragraph">
<p>The expression that is tested may of course have any level of complexity:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>When hero At cave
  And (monster Is hungry Or monster Is angry)
  And sword Not In hero
=&gt;
  Use Script eat_hero For monster.
End When.</pre>
</div>
</div>
<div class="paragraph">
<p>Each actor action and event execution is considered atomic (it can&#8217;t be divided into smaller parts). All rule conditionals are evaluated after each actor (including the player) has acted (script step and player command respectively) and after each event has executed. In effect this will mean that a change in state will be detected almost immediately, if there is a rule for detecting that change.</p>
</div>
<div class="paragraph">
<p>The statements within the rule are triggered when the condition <em>becomes</em> true. In the first example, this means that if the monster is not active, the statements will be executed when the hero enters the cave ('hero At cave' becomes true). A rule body can never be executed twice in succession unless the conditional has been evaluated to false in between. In the example above, the triggering of the hunting script for the monster will not happen again unless either the hero has left the cave and entered it again, or the monster has been active and then become not active again.</p>
</div>
<div class="paragraph">
<p>The use of parameters, <code>Current Actor</code>, <code>Current Location</code>, <code>Here</code> and <code>Nearby</code> is not allowed in rules conditionals or bodies.</p>
</div>
<div class="paragraph">
<p>Rules are executed at no location. Therefore it is not possible to communicate directly with the player in the rule with output statements (since the hero cannot be where the rule is executing, see <em>Output Statements</em> on page <em>117</em>). Triggering an event that handles the output intended for the player, is the recommended solution to this.</p>
</div>
<div class="paragraph">
<p>The following is a complete game using a rule:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-alan" data-lang="alan">The kitchen IsA location
  Exit x To kitchen.
End The kitchen.

When Count IsA actor, At kitchen = 1
  Then Schedule whee At actor After 0.
End When.

Event whee
  "Whee!"
End Event.

Start At kitchen.</code></pre>
</div>
</div>
<div class="paragraph">
<p>In this example the rule conditional (the text marked with grey) is using an aggregation (<code>count</code>, see <em>Aggregates</em> on page <em>150</em>) over two filters (see section <em>3.21</em> <em>Filters</em> on page <em>151</em>) that will count the number of actors at the kitchen, and when that number becomes one, the rule will trigger and execute the statements, in this case scheduling an event that handles the presentation of the output to the player.</p>
</div>
<div class="paragraph">
<p>Again, remember that rules are checked after each actor has moved. What happens if there are more actors in play and they move in and out of the kitchen, is left as an exercise to the reader.</p>
</div>
</div>
<div class="sect2">
<h3 id="truesynonyms"><a class="anchor" href="#truesynonyms"></a>3.13. Synonyms</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ebnf" data-lang="ebnf">synonyms = 'SYNONYMS' {synonym_declaration}

synonym_declaration = word {',' word} '=' word '.'</code></pre>
</div>
</div>
<div class="paragraph">
<p>A synonym declaration declare words that, when used in player input, are always interchangeable. For example</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-alan" data-lang="alan">Synonyms
  'i', 'invent' = 'inventory'.
  'q' = 'quit'.</code></pre>
</div>
</div>
<div class="paragraph">
<p>The word on the right hand side of the equal sign must be a word defined elsewhere in the adventure source, such as (part of) an instance name (a noun or adjective), a direction or a verb. The list of words on the left-hand side contains new words (<em>not</em> defined elsewhere) that always will be interpreted as being replaced by the word on the right in the player input.</p>
</div>
<div class="paragraph">
<p>Synonyms are player words that can be interchanged. Defining synonyms for verb names will not always give you the result that you expect. The following example is incorrect.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-alan" data-lang="alan">Synonyms
  'examine' = look_at.
Syntax
  look_at = 'look' 'at' (obj).
Verb look_at …</code></pre>
</div>
</div>
<div class="paragraph">
<p>This will result in an error message indicating that the synonym word <code>look_at</code> is not defined. This is because the <code>Syntax</code> (see section <em>3.8</em>) defined the verb <code>look_at</code> to have the specified syntax (including the player words &#8216;look&#8217; and &#8216;at&#8217;), the player word <code>look_at</code> is not defined, which is as well as the player would not be able to input a word with an underscore (see <em>Player Input</em> on page <em>160</em>).</p>
</div>
<div class="paragraph">
<p>You can achieve the desired effect by instead giving multiple verb identifiers in the verb declarations; this will give the same verb bodies (checks and actions) to multiple verbs. See the section on <em>Verbs</em> on page <em>100</em> for details on verb declarations.</p>
</div>
<div class="paragraph">
<p>It is also possible to define multiple names for an instance to achieve other effects similar to synonyms. See <em>Names</em> on page <em>65</em> for a description of this.</p>
</div>
</div>
<div class="sect2">
<h3 id="truemessages"><a class="anchor" href="#truemessages"></a>3.14. Messages</h3>
<div class="paragraph">
<p>The Alan system has a number of standard messages built in. These messages are presented to the player in various situations, both normal and otherwise. An example is the following:</p>
</div>
<div class="exampleblock gametranscript">
<div class="content">
<div class="paragraph">
<p>&gt; go north<br>
You can&#8217;t go that way.</p>
</div>
</div>
</div>
<div class="paragraph">
<p>The response "You can&#8217;t go that way." is a typical example of such system messages (for details see Appendix <em>C.1</em>, <em>Input Response Messages</em>).</p>
</div>
<div class="paragraph">
<p>To make the user dialogue more adapted to the settings you select, Alan allows you to define your own version of these messages. The grammar for this is</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ebnf" data-lang="ebnf">messages = 'MESSAGE' {message}

message = id ':' {statement}</code></pre>
</div>
</div>
<div class="paragraph">
<p>An example would be:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-alan" data-lang="alan">Message
  NOWAY: "There is no exit in that direction."</code></pre>
</div>
</div>
<div class="paragraph">
<p>If the above where used in the source for the same game as the previous example, it would instead look like:</p>
</div>
<div class="exampleblock gametranscript">
<div class="content">
<div class="paragraph">
<p>&gt; go north<br>
There is no exit in that direction.</p>
</div>
</div>
</div>
<div class="paragraph">
<p>The <code>Message</code> constructs allows general statements following the message identifier:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-alan" data-lang="alan">Message NOWAY:
  If Random 1 To 2 = 1 Then
    "There is no way in that direction."
  Else
    "You can't go there."
  End If.</code></pre>
</div>
</div>
<div class="paragraph">
<p>The standard message for <code>Noway</code> is replaced by the output from the statements in the definition. For a complete list of all the identifiers of messages and their use, see Appendix <em>R</em> on page <em>209</em>.</p>
</div>
<div class="sect3">
<h4 id="truemessage-parameters"><a class="anchor" href="#truemessage-parameters"></a>Message parameters</h4>
<div class="paragraph">
<p>Message sections must be declared at the global level, but to make it possible to create high-quality messages the message sections have parameters available. Which parameters are available vary depending on the message, the details for each message is available in Appendix <em>Input Response Messages</em> on page <em>210</em>.</p>
</div>
<div class="paragraph">
<p>The parameters can be used in the same way as in verb bodies. The names of the parameters are &#8220;parameter1&#8221;, &#8220;parameter2&#8221;, etc. The type of the parameters will also vary.</p>
</div>
<div class="paragraph">
<p>For some messages, a parameter is an instance. In these cases, the instance is always of the pre-defined <code>entity</code> class. Any attribute available for this class will be available in message sections with instance parameters.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>If the message must be modified according to the case of the noun, which is the case with adjectives and negative forms in many languages, an attribute available on all instances can be used to select the correct form.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect2">
<h3 id="trueprompt-section"><a class="anchor" href="#trueprompt-section"></a>3.15. Prompt Section</h3>
<div class="paragraph">
<p>The Prompt section allows you to customize the way players are prompted for their input.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ebnf" data-lang="ebnf">prompt = 'PROMPT' {statement}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The default prompt for player input, which will be used if no <code>Prompt</code> section is declared, looks like</p>
</div>
<div class="exampleblock gametranscript">
<div class="content">
<div class="paragraph">
<p>&gt;</p>
</div>
</div>
</div>
<div class="paragraph">
<p>Using the following <code>Prompt</code> section it can be set to something else:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-alan" data-lang="alan">Prompt "What now?""</code></pre>
</div>
</div>
<div class="paragraph">
<p>Then the player will of course see</p>
</div>
<div class="exampleblock gametranscript">
<div class="content">
<div class="paragraph">
<p>What now?</p>
</div>
</div>
</div>
<div class="paragraph">
<p>In fact, the <code>Prompt</code> section allows any statements, not just strings. So you can have the prompt change during the game.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-alan" data-lang="alan">Prompt
  "Hello" Say hero. "!$n"
  "Where do you want to go from"
  Say Current Location. "?"</code></pre>
</div>
</div>
<div class="paragraph">
<p>This will give the following output:</p>
</div>
<div class="exampleblock gametranscript">
<div class="content">
<div class="paragraph">
<p><strong>Pirates Bay Harbor</strong><br>
You can see the town of Pirates Bay to the north, and your ship is at the docks, to the south.<br>
Hello Jack Sparrow!<br>
Where do you want to go from Pirates Bay Harbor?</p>
</div>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The prompt section is global and applies to the whole game. There is currently no way to dynamically customize the prompt except by using the statements inside the Prompt section itself.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="truestart-section"><a class="anchor" href="#truestart-section"></a>3.16. Start Section</h3>
<div class="paragraph">
<p>The start section defines where the player (the hero) will be at the start of the game. This must be a location. Optionally this may be followed by statements to be executed at the beginning of the game, such as hello-messages or short instructions as well as starting any actors and scheduling events.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ebnf" data-lang="ebnf">start_section = 'START' where '.' {statement}</code></pre>
</div>
</div>
<div class="paragraph">
<p>An example would be</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-alan" data-lang="alan">Start At outside_house.
  Schedule bird_chirp After 5.</code></pre>
</div>
</div>
<div class="paragraph">
<p>Only the <code>At What</code> form of the <code>Where</code> construct (see <em>WHERE Specifications</em> on page <em>138</em>) is allowed in the <code>Start</code> section. Any statements are allowed in the start section but they cannot refer to any parameters.</p>
</div>
<div class="paragraph">
<p>The start section must be the last declaration in an Alan source.</p>
</div>
</div>
<div class="sect2">
<h3 id="truestatements"><a class="anchor" href="#truestatements"></a>3.17. Statements</h3>
<div class="sect3">
<h4 id="trueoutput-statements"><a class="anchor" href="#trueoutput-statements"></a>Output Statements</h4>
<div class="paragraph">
<p>There are various ways to present output to the player, string output, descriptions, printing expressions, listing container content and showing pictures.</p>
</div>
<div class="paragraph">
<p>The interpreter intersperses your output with spaces whenever needed. This might for example occur between two output strings:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-alan" data-lang="alan">"There is a door into the kitchen."
If kitchenDoor Is open Then
  "It is open."
End If.</code></pre>
</div>
</div>
<div class="paragraph">
<p>If handled simple-mindedly the two texts would be adjoined and you as an author would need to cater for this. Instead Alan realizes that a space is required between them. This space is automatically inserted by the interpreter during game play. This is also the case if the output from a <code>Say</code> statement is followed by an output string.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-alan" data-lang="alan">"Your wristwatch shows" Say hours Of watch.
". Time to go."</code></pre>
</div>
</div>
<div class="paragraph">
<p>However, as in this example, this is not always the intended output. Particularly, if the <code>Say</code> statement terminated the previous sentence, as in the example, we want the full stop to be placed immediately after the output. So, the Alan interpreter will leave out the space between two outputs if the second starts with a period (full stop) followed by a space, or is the single character in the string. This special handling also applies to strings starting with a comma.</p>
</div>
<div class="paragraph">
<p>Whenever an output statement is executed, the result will be printed on the players terminal with the following important exception: if an output statement is executed at a location in the game where the hero not presently is, the output will not be shown. This important feature will relieve the author from the burden of constantly considering what the player will see. It can be used in the following way:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-alan" data-lang="alan">"Charlie Chaplin leaves the house through the front door."
Locate charlie_chaplin At outside_house.
"Charlie Chaplin comes out from the nearest house."</code></pre>
</div>
</div>
<div class="paragraph">
<p>If the hero is inside the house or out in the street, he will get different views of the situation. This feature ensures that the player only sees what is going on at the current location, and allows for easy adaptation to various viewpoints on the events without the need for any special tests. But see section <em>6.4</em> <em>Distant Events</em> on page <em>172</em> for a solution in the case the hero need to be informed about things happening where he isn&#8217;t.</p>
</div>
<div class="sect4">
<h5 id="truestring-statement"><a class="anchor" href="#truestring-statement"></a>String Statement</h5>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ebnf" data-lang="ebnf">output_statement = STRING</code></pre>
</div>
</div>
<div class="paragraph">
<p>The simplest case of output is just a string, i.e. any text, possibly stretching over multiple lines, surrounded by double quotes. See also section <em>4.4</em> <em>Strings</em> on page <em>156</em> for some detailed descriptions on the definition of strings.</p>
</div>
<div class="paragraph">
<p>Some character combinations have special meaning for the printout:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>$p    New paragraph (usually one empty line)
$n    New line
$i    Indent on a new line
$t    Insert a tabulation
$$    Escape from automatic space insertion and capitalization
$a    The name of the actor that is executing
$l    The name of the current location
$v    The verb the player used (the first word)
$_    Print this as a '$' if in conflict with other symbols</pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>You might want to output &#8220;$400&#8221; but &#8220;$4&#8221; will be interpreted as the indefinite form of the fourth parameter, as described below. So you need to use the &#8216;&#95;&#8217; to make that happen (&#8220;$&#95;400&#8221;).</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The following can be used to refer to parameters while executing a verb, but the <code>Say</code> statement (see below) is safer and preferred whenever possible:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>$&lt;n&gt;     The parameter &lt;n&gt; (&lt;n&gt; is a digit &gt; 0, e.g. "$1")
$+&lt;n&gt;    Definite form of parameter &lt;n&gt;
$0&lt;n&gt;    Indefinite form of parameter &lt;n&gt;
$-&lt;n&gt;    Negative form of parameter &lt;n&gt;
$!&lt;n&gt;    Pronoun for the parameter &lt;n&gt;
$o       The current object (first parameter)</pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The <code>$&lt;n&gt;</code> formats must be used with care as they are not checked at compile time, e.g. you can use &#8220;<code>$+1</code>&#8221; in a context where no parameter is defined which would lead to a run-time error. To avoid the risk of any run-time problems use the <code>Say</code> statement with the parameter name wherever possible. See section <em>Say Statement</em> <em>below</em>.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The use of <code>$o</code> is deprecated. The <code>&lt;n&gt;</code> variants are better, but the recommended use is to refer to the parameters using their parameter names in a <code>Say</code> statement instead. This will ensure full reference analysis by the compiler protecting against any runtime error.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect4">
<h5 id="truestyle-statement"><a class="anchor" href="#truestyle-statement"></a>Style Statement</h5>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ebnf" data-lang="ebnf">style_statement = 'STYLE' style '.'

style = 'NORMAL'
      | 'EMPHASIZED'
      | 'PREFORMATTED'
      | 'ALERT'
      | 'QUOTE'</code></pre>
</div>
</div>
<div class="paragraph">
<p>The style of the text output can be controlled using the <code>Style</code> statement. With the exception of the <code>Emphasized</code> style, the styles are intended to be applied to whole paragraphs. The style indicated in the statement applies until another <code>Style</code> statement is executed.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The exact visual appearance of the styles is implementation dependent. In fact, there is no guarantee that the styles will actually differ.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect4">
<h5 id="truedescribe-statement"><a class="anchor" href="#truedescribe-statement"></a>Describe Statement</h5>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ebnf" data-lang="ebnf">output_statement = 'DESCRIBE' what '.'</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>Describe</code> statement executes the description part for an instance, such as an actor, an object or a location. If no such description exists a default description, such as</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-alan" data-lang="alan">"There is a coin here."</code></pre>
</div>
</div>
<div class="paragraph">
<p>is used instead. In this case, if the instance has the container property, a <code>List</code> statement is also executed for that object automatically (see below).</p>
</div>
<div class="paragraph">
<p>If a <code>Describe</code> statement is executed for another instance during the execution of the description clause, the system will recognise this and make sure that the second instance is not described more than once. This makes it possible to use instances as parts of a location and embedding their description at the correct place in the longer description of the location.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-alan" data-lang="alan">"This office is dusty and probably hasn't been used for
 many years."
DESCRIBE desk.
"To the west is an open door, and to the east you can see the
 staircase.""</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="truesay-statement"><a class="anchor" href="#truesay-statement"></a>Say Statement</h5>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ebnf" data-lang="ebnf">output_statement = 'SAY' [form] expression '.'

form = 'THE' | 'AN' | 'IT' | 'NO'</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>Say</code> statement will output a short description of what is referred to by the expression. If it refers to an instance, it will print the name of it or execute its <code>Mentioned</code> clause if one is available. If it refers to an attribute, it will print its value, such as an integer or a string. Parameter names are also allowed in the <code>Say</code> statement, which, of course will result in a short description of the instance to which it is bound, or a printing of the literal (if the parameter was a <strong>String</strong> or <strong>Integer</strong> parameter).</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-alan" data-lang="alan">If contents Of bottle &gt; 0 Then
  "In the bottle there are still"
  Say contents OF bottle.
  "litres of water left."
Else
  "The bottle is empty."
End If.</code></pre>
</div>
</div>
<div class="paragraph">
<p>If the <strong>what</strong> part refers to an instance, the optional <code>form</code> may be used to control in which form the instance will be output.</p>
</div>
<div class="paragraph">
<p>If <code>THE</code> is used the form used will be the definite form, usually the short form preceded by a definite article. Correspondingly, the use of <code>AN</code> indicates an indefinite form. A third form, using <code>NO</code>, is available. It indicates that the negative form as defined by the negative article or form should be output. Refer to <em>Articles and Forms</em> on page <em>78</em> for a description of the definite/indefinite articles and forms. Finally, the <code>IT</code> form will print the pronoun associated with the instance.</p>
</div>
</div>
<div class="sect4">
<h5 id="truelist-statement"><a class="anchor" href="#truelist-statement"></a>List Statement</h5>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ebnf" data-lang="ebnf">output_statement = 'LIST' expression '.'</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>List</code> statement lists all objects in a container together with the header as specified for the container. If the container is empty, the statements in the empty clause of the container are executed instead.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-alan" data-lang="alan">"The chest is heavy."
If chest Is open Then
  List chest.
End If.</code></pre>
</div>
</div>
<div class="paragraph">
<p>Of course, the instance being listed must be an instance that has the container property, which may be inherited. This instance can be referred to by being bound to a parameter or a reference attribute for example.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="truemulti-media-statements"><a class="anchor" href="#truemulti-media-statements"></a>Multi-media Statements</h4>
<div class="paragraph">
<p>Alan has some multimedia provisions, although they may not be available on every platform and implementation. The <code>Show</code> statement, presents an image in the output window, and the <code>Play</code> statement plays a sound.</p>
</div>
<div class="paragraph">
<p>The Alan compiler will always support the multi-media statements, but a particular interpreter might not do so. Most GLK-based interpreters will support it but others might also. The game will still play fine, but the multi-media resources will silently be ignored. There is also no way to check for this in your source code. So, don&#8217;t rely on them for your story, particularly do not give the player necessary information only through pictures.</p>
</div>
<div class="paragraph">
<p>Image and sound files are analyzed by the compiler and copied into an Alan v3 resource file (file extension <strong>.a3r</strong>) that must be distributed with your game file, otherwise they will not be available during game play. The original file will be left untouched.</p>
</div>
<div class="paragraph">
<p>The format of the resource file follows the standard Interactive Fiction resource file format &#8220;blorb&#8221; and supports images of JPEG and PNG types, and sounds of MOD and AIFF formats.</p>
</div>
<div class="paragraph">
<p>If a resource file is referenced from multiple statements, it will only be copied once. The Alan compiler uses the file extension to determine the media type of the file. The following extensions are recognized: <strong>.jpg</strong>, <strong>.jpeg</strong>, <strong>.png</strong>, <strong>.mod</strong>, <strong>.aif</strong> and <strong>.aiff</strong>.</p>
</div>
<div class="sect4">
<h5 id="trueshow-statement"><a class="anchor" href="#trueshow-statement"></a>Show Statement</h5>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ebnf" data-lang="ebnf">output_statement = 'SHOW' id '.'</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <strong>id</strong> should be the name of an image file. Since filenames may contain various special characters, a quoted identifier (see <em>File</em> on page <em>157</em>) is usually required.</p>
</div>
<div class="paragraph">
<p>Alan currently supports the PNG and JPEG formats only.</p>
</div>
</div>
<div class="sect4">
<h5 id="trueplay-statement"><a class="anchor" href="#trueplay-statement"></a>Play Statement</h5>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ebnf" data-lang="ebnf">output_statement = 'PLAY' id '.'</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <strong>id</strong> should be the name of a sound file. Since filenames may contain various special characters, a quoted identifier (see <em>File</em> on page <em>157</em>) is usually required.</p>
</div>
<div class="paragraph">
<p>Alan currently supports the MOD and AIFF formats only.<a id="X30946"></a></p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="truemanipulation-statements"><a class="anchor" href="#truemanipulation-statements"></a>Manipulation Statements</h4>
<div class="paragraph">
<p>+</p>
</div>
<div class="sect4">
<h5 id="truelocate-statement"><a class="anchor" href="#truelocate-statement"></a>Locate Statement</h5>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ebnf" data-lang="ebnf">locate_statement = 'LOCATE' what where '.'</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>Locate</code> statement is a way of transferring instances to new locations. When executed, the indicated instance will be placed at the location given. For a description on how to specify where, see <em>WHERE Specifications</em> on page <em>138</em>. When an actor is located at a new location the <code>DOES</code> clause of that location is always executed.</p>
</div>
<div class="paragraph">
<p>One special case of the <code>Locate</code> statement is when the predefined actor <code>hero</code> is located somewhere. This is analogous to the player typing a direction, i.e. the hero will be located at the appropriate location. Under particular circumstances, you may want to locate the player at a different location as a side effect of another action. For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-alan" data-lang="alan">Event explosion
  "Suddenly the door seems to bulge outwards, it bursts
   open throwing rocks and splinters everywhere. The
   impact of the explosion literally throws you back
   out in the hallway."
  Locate hero At hallway.
End Event explosion.</code></pre>
</div>
</div>
<div class="paragraph">
<p>In this case, the new location will be described and the <code>Does</code> clause of that location executed.</p>
</div>
<div class="paragraph">
<p>Another special case is when locating something inside a container. The <code>Locate</code> statement will then cause the execution of the limits of that container, and if any of the limits are exceeded the complete player turn is aborted immediately, resulting in no more statements being executed. So, if a player command should result in the location of an object inside a container, a good thing is to place the <code>Locate</code> statement as early as possible, as this enforces the limit checks in the beginning of this player turn.</p>
</div>
<div class="paragraph">
<p>A very special third case is locating a location at another location. Locations can in this way be nested, resulting in an outer location working as a region or surrounding for the inner location. The effect of this is that any instances present in the outer location are reachable from the inner.</p>
</div>
</div>
<div class="sect4">
<h5 id="trueempty-statement"><a class="anchor" href="#trueempty-statement"></a>Empty Statement</h5>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ebnf" data-lang="ebnf">empty_statement = 'EMPTY' what [where] '.'</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>Empty</code> statement locates all instances currently located inside the given container (instance with the <code>Container</code> property) at a certain location. The meaning of the <code>where</code> part, is the same as in the <code>Locate</code> statement. If it is not specified the instances will be placed at the current location.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-alan" data-lang="alan">Empty inventory Here.
"You seem to have lost most of your possessions. Well,
 you can't have everything."
Locate hero At restart_point.</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="truestrip-statement"><a class="anchor" href="#truestrip-statement"></a>Strip Statement</h5>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ebnf" data-lang="ebnf">strip_statement = 'STRIP' [direction] [count] [size]
                    from_clause [into_clause] '.'

direction = 'FIRST' | 'LAST'

count = expression

size = 'WORDS' | 'CHARACTERS'

from_clause = 'FROM' expression

into_clause = 'INTO' expression</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>Strip</code> statement is used to manipulate the contents of strings content. You can use it to remove words or characters from a string, starting from the beginning or the end. The words or characters that are removed may be placed in an attribute as specified by the optional <strong>into clause</strong>. If the statement is used to manipulate words, blanks and separators are used to separate the words. In this case, any resulting string is also free of leading and trailing blanks.</p>
</div>
<div class="paragraph">
<p>A short example</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-alan" data-lang="alan">The eliza IsA actor
  Has topic "".
  Verb talk_to
    Does
      Set topic Of eliza To "sailing music cooking reading".
      Strip Random 0 To 2 Words From topic Of eliza.
      Strip First Word From topic Into topic.
      "And how do you feel about" Say topic Of eliza. "?"
  End Verb.
End The eliza.</code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="trueevent-statements"><a class="anchor" href="#trueevent-statements"></a>Event Statements</h4>
<div class="sect4">
<h5 id="trueschedule-statement"><a class="anchor" href="#trueschedule-statement"></a>Schedule Statement</h5>
<div class="paragraph">
<p><code>Schedule</code> will queue an event to occur at a specified location after the number of player turns specified by the expression.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ebnf" data-lang="ebnf">event_statement = 'SCHEDULE' what [where]
                    'AFTER' expression '.'</code></pre>
</div>
</div>
<div class="paragraph">
<p>For example</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-alan" data-lang="alan">Schedule ringing At clock After 60 - minutes Of clock.</code></pre>
</div>
</div>
<div class="paragraph">
<p>The number of moves can be zero, i.e. <code>After 0</code> means that the event will occur now (during this player turn, probably last, though). If no location is specified, <code>Here</code> is assumed, i.e. it will be executed at the current location, the location where the statement itself was executed.</p>
</div>
<div class="paragraph">
<p>An important case is when a <code>Schedule</code> statement without a <code>where</code>-clause is executed inside a <code>Rule</code>. Since rules are executed at nowhere so will the event. This means that any printout will be done nowhere and thus will be invisible to the player.</p>
</div>
<div class="paragraph">
<p>If the <code>where</code>-expression has the form <code>At id</code>, and the identifier represents an instance not inheriting from <code>location</code>, the event will occur wherever that instance is when the event occurs. The event will &#8216;follow&#8217; the instance.</p>
</div>
<div class="paragraph">
<p>Executing a second <code>Schedule</code> statement for the same event before it has occurred will reschedule the event to the new time. An event can only be scheduled for one execution at a time.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The event can be specified by giving an event identifier or referring to an attribute of Event type.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect4">
<h5 id="truecancel-statement"><a class="anchor" href="#truecancel-statement"></a>Cancel Statement</h5>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ebnf" data-lang="ebnf">cancel_statement = 'CANCEL' what '.'</code></pre>
</div>
</div>
<div class="paragraph">
<p><code>Cancel</code> will remove the event referenced from the queue of scheduled events. It is not an error to remove an Event, which is not currently scheduled.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-alan" data-lang="alan">Event ticking
  "Tick..."
  If timer Of bomb = 0 Then
    Schedule explosion After 1.
  Else
    Decrease timer Of bomb.
    Schedule ticking After 1.
  End If.
End Event ticking.

Verb defuse
  Does
    Cancel ticking.
    Cancel explosion.
    "Phuuui! That was close."
End Verb defuse.

Start At office.
  "The bomb is ticking..."
  Schedule ticking After 1.</code></pre>
</div>
</div>
<div class="paragraph">
<p>The event can be referenced using any expression of Event type, e.g. an attribute.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="trueassignment-statements"><a class="anchor" href="#trueassignment-statements"></a>Assignment Statements</h4>
<div class="paragraph">
<p>There are a number of statements for changing values of attributes.</p>
</div>
<div class="sect4">
<h5 id="truemake-statement"><a class="anchor" href="#truemake-statement"></a>Make Statement</h5>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ebnf" data-lang="ebnf">make_statement = 'MAKE' what something '.'

something = ['NOT'] id</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>Make</code> statement is used to set or reset Boolean attributes.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-alan" data-lang="alan">Make door open.
Make door Not open.</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="trueincrease-and-decrease-statements"><a class="anchor" href="#trueincrease-and-decrease-statements"></a>Increase and Decrease Statements</h5>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ebnf" data-lang="ebnf">increase_statement = 'INCREASE' what [by] '.'

decrease_statement = 'DECREASE' what [by] '.'

by = 'BY' expression</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>Increase</code> and <code>Decrease</code> statements modifies the values of numeric attributes by increasing or decreasing them by the value of the expression given in the optional <code>By</code> clause. If no <code>By</code> clause is specified the attributes are changed by one.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-alan" data-lang="alan">Increase level Of bottle By contents Of mug.
Decrease lives Of hero.</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="trueset-statement"><a class="anchor" href="#trueset-statement"></a>Set Statement</h5>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ebnf" data-lang="ebnf">set_statement = 'SET' what 'TO' expression '.'</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>Set</code> statement is used when assigning values to numeric, string, reference of set valued attributes.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-alan" data-lang="alan">Set mood Of king_tut To 3.
Set hour Of clock To hour Of clock + 1.</code></pre>
</div>
</div>
<div class="paragraph">
<p>Setting attributes of reference or set type requires that the expression follow the type and subclass compatibility rules. For example, you can only assign</p>
</div>
<div class="ulist">
<ul>
<li>
<p>integer type expressions to an integer attribute</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-alan" data-lang="alan">Set intAttr To 4. -- Correct if intAttr is of Integer type
Set intAttr To "hi". -- Incorrect</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>an expression that refers to an instance if the attribute being assigned to is a reference attribute which has a class of which the class of the expression is a subclass</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-alan" data-lang="alan">Has suspect butler.
Set suspect Of detective To someLocation. -- Incorrect</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>a set valued expression to a set type attribute if all members are instances of some subclass of the member class of the target attribute. Here are some examples, given the natural types of the instances</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-alan" data-lang="alan">Has friends {monica, ross, chandler, rachel, phoebe, joey}. -- persons
Set friends Of mine To {book}. -- Incorrect, probably not a person
Set friends Of mine To {}. -- Correct, empty set is always OK
Set friends Of mine To {suspect Of detective}. -- Correct maybe</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="trueinclude-statement"><a class="anchor" href="#trueinclude-statement"></a>Include Statement</h5>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ebnf" data-lang="ebnf">include_statement = 'INCLUDE' expression 'IN' set '.'</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>Include</code> statement is used to include a new member in a Set. Typically, this is used to an instance or value to a collection of such. See section <em>Set Type</em> on page <em>52</em> for an explanation of the Set type. A member already in the Set will silently be accepted but not generate duplicate entries.</p>
</div>
<div class="paragraph">
<p>The set may be identified using an expression involving reference attributes:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-alan" data-lang="alan">Include hitchhiker In friends Of driver Of car.</code></pre>
</div>
</div>
<div class="paragraph">
<p>And vice versa:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-alan" data-lang="alan">Include driver Of car In friends Of hitchhiker.</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="trueexclude-statement"><a class="anchor" href="#trueexclude-statement"></a>Exclude Statement</h5>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ebnf" data-lang="ebnf">exclude_statement = 'EXCLUDE' expression 'FROM' set '.'</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>Exclude</code> statement is the reverse of the <code>Include</code> statement. It removes a member from a Set. An attempt to remove something not included in the Set will be silently ignored, so that after the execution of the statement it is guaranteed that the member is not in the Set.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The inclusion or exclusion of an instance will not affect its location. A member may be included in multiple Sets.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect3">
<h4 id="trueconditional-statements"><a class="anchor" href="#trueconditional-statements"></a>Conditional Statements</h4>
<div class="paragraph">
<p>In Alan there are two conditional statements, the common <code>If</code> statement and the <code>Depending On</code> statement.</p>
</div>
<div class="sect4">
<h5 id="trueif-statement"><a class="anchor" href="#trueif-statement"></a>If Statement</h5>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ebnf" data-lang="ebnf">if statement = 'IF' expression 'THEN' statements
                   { elsif_part }
                   [ else_part ]
               'END' 'IF' '.'

elsif_part = 'ELSIF' expression 'THEN' statements

else_part = 'ELSE' expression 'THEN' statements</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>If</code> statement is essential for varying output and otherwise change the activities in the game. The expression is evaluated (see <em>Expressions</em> on page <em>141</em> for details and examples of expression) and if it evaluates to true, the statements following the <code>Then</code> are executed. Otherwise, the expressions in any following <code>ElsIf</code> clauses are evaluated (in order) and the statements following the first expression that results in a true value is executed. If none of the expressions in the <code>ElsIf</code> clauses evaluated to true, or there are no <code>ElsIf</code> clauses, the statements following the <code>Else</code> are executed. The <code>Else</code> clause is optional.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-alan" data-lang="alan">If minute Of clock = 59 Then
  Set minute Of clock To 0.
  Increase hour Of clock.
Else
  Increase minute OF clock.
End If.
If level Of bottle = 0 Then
  "You have no water."
ElsIf level Of bottle &lt; 5 Then
  "You have almost no water left."
Else
  "You have plenty of water."
End If.</code></pre>
</div>
</div>
<div class="paragraph">
<p><code>If</code> statements which have an <code>IsA</code>-expression (see <em>Class Expressions</em> on page <em>145</em>) are particularly important. As an <code>IsA</code>-expression test for the class of an instance, an <code>If</code> statement like</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-alan" data-lang="alan">If i IsA actor Then …</code></pre>
</div>
</div>
<div class="paragraph">
<p>will quarantee that for any statement inside the <code>Then</code>-part of that statement, the <code>i</code> will be of the class <code>actor</code>. This means that references to attributes, container properties and actor scripts etc. as if <code>i</code> belongs to the class <code>actor</code>, even if that was not known outside of the If-statement.</p>
</div>
<div class="paragraph">
<p>A typical example where this is helpful is inside verbs where parameters can be restricted to more general classes by the syntax and the actual action can still perform specific actions only allowed on more specialized classes. Another would be in a loop over some unknown set of instances.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-alan" data-lang="alan">For Each e IsA entity, Here Do
  If e IsA actor Then …
  If e IsA object Then …
  If e IsA container_object Then …
End For.</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="truedepending-on-statement"><a class="anchor" href="#truedepending-on-statement"></a>Depending On Statement</h5>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ebnf" data-lang="ebnf">depend_statement = 'DEPENDING' 'ON' expression
                       {case}
                   'END' 'DEPEND' '.'

case = right_hand_side 'THEN' statements
     | 'ELSE' statements</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>Depending On</code> statement is a provided to select one of a number of possible conditional cases depending on an expression. The expression can be any expression. The right-hand side is the right hand side of any valid expression. When combined with expression (as the left hand side of the expression) they will be a complete expression, that is evaluated.</p>
</div>
<div class="paragraph">
<p>A simple example of the <code>Depending On</code> statement is:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-alan" data-lang="alan">Depending On weight Of obj
  = 1 Then "light as a feather"
  Between 2 And 10 Then "carryable"
  Between 10 And 20 Then "heavy"
  &gt; 20 Then "immobile"
  Else "weightless"
End Depend.</code></pre>
</div>
</div>
<div class="paragraph">
<p>The meaning of this example is to test the <code>weight Of obj</code> and select one of the cases depending on the value of it. If it is equal to one the first case will be executed. If none of the cases match, the optional <code>Else</code> case will be executed (in this case it will only be executed for weights of zero or less).</p>
</div>
<div class="paragraph">
<p>The cases are tested in the order specified. At most, one case will be executed. In the example, a weight of ten will render as "carryable".</p>
</div>
<div class="paragraph">
<p>The tests are thus equivalent to</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-alan" data-lang="alan">If weight Of object = 1 Then "light as a feather"
ElsIf weight Of object Between 2 And 10 Then "carryable"
ElsIf weight Of object Between 10 And 20 Then "heavy"
ElsIf weight Of object &gt; 20 Then "immobile"
Else "weightless"
End If.</code></pre>
</div>
</div>
<div class="paragraph">
<p>A <code>Depending On</code> statement is preferable to a chain of <code>If</code> statements when the same expression will be tested for multiple matches.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="trueactor-statements"><a class="anchor" href="#trueactor-statements"></a>Actor Statements</h4>
<div class="paragraph">
<p>Actor statements are statements that are used to control actors.</p>
</div>
<div class="sect4">
<h5 id="trueuse-statement"><a class="anchor" href="#trueuse-statement"></a>Use Statement</h5>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ebnf" data-lang="ebnf">use_statement = 'USE' script ['FOR' actor] '.'</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>Use</code> statement starts execution of a given script for a given actor. The <code>For actor</code> clause is optional when writing code within a certain actor; in this case that the statement applies to the actor that the code is in.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-alan" data-lang="alan">Use Script playing For george.</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>You can use an expression such as a simple identifier, a parameter reference or a reference attribute as the actor clause.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect4">
<h5 id="truestop-statement"><a class="anchor" href="#truestop-statement"></a>Stop Statement</h5>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ebnf" data-lang="ebnf">stop_statement = 'STOP' actor '.'

actor = expression</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>Stop</code> statement stops an actor from proceeding with any script it may be executing. In effect, it will abort it and put the actor in an idle state. The most common case is the direct reference to an actor using its identifier. More complex expressions resulting in an actor type value, such as a parameter reference or a reference attribute, can be used as the actor clause.</p>
</div>
</div>
<div class="sect4">
<h5 id="truerepetition-statements"><a class="anchor" href="#truerepetition-statements"></a>Repetition Statements</h5>
<div class="paragraph">
<p>The Alan language provides one compound statement for repetition, the <code>For Each</code> statement.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ebnf" data-lang="ebnf">repetition_statement = 'FOR' 'EACH' id [filters] 'DO'
                           statements
                       'END' 'FOR' 'EACH' '.'

filters = filter { ',' filter }
        | 'BETWEEN' expression 'AND' expression</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can optionally leave out either <code>For</code> or <code>Each</code> but not both.</p>
</div>
<div class="paragraph">
<p>The identifier is called the loop variable and will have similar semantics as a syntax parameter. It will dynamically be bound to instances, one for each repetition. In the body of the loop, the statements, this variable can be referenced in the same way as a syntax parameter.</p>
</div>
<div class="paragraph">
<p>The optional filters can be used to restrict the values in the loop. If the <code>Between</code> form is used, the loop becomes an integer loop, resulting in the loop variable having integer type and range from the two expressions inclusive. Otherwise, the loop variable will be of instance type and will consecutively assume the value of each instance fulfilling the filters. See <em>Filters</em> on page <em>151</em> for an explanation of filters.</p>
</div>
<div class="paragraph">
<p>Any references to the loop variable within the repetition will refer to the instance bound, or integer value, in this repetition.</p>
</div>
<div class="paragraph">
<p>You can use any statements inside the repetition, e.g. to check for further conditions before operating on the instance. For example</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-alan" data-lang="alan">For Each creature IsA actor Do
  If creature Here Then
    …
  End If.
End For.</code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="truespecial-statements"><a class="anchor" href="#truespecial-statements"></a>Special Statements</h4>
<div class="sect4">
<h5 id="truequit-statement"><a class="anchor" href="#truequit-statement"></a>Quit Statement</h5>
<div class="paragraph">
<p><code>Quit</code> prints a question giving the player the choice of restarting the game, reloading a previously saved game or to quit. Any scoring or other printouts have to be made explicitly before executing the <code>Quit</code> statement.</p>
</div>
</div>
<div class="sect4">
<h5 id="truelook-statement"><a class="anchor" href="#truelook-statement"></a>Look Statement</h5>
<div class="paragraph">
<p><code>Look</code> describes the current location (the current location is dependent on in which context it is executed) and what it contains to the player. First the location name is output, then the <code>Description</code> part for the location is executed. If you do not want the name of the location to be included you can use a <code>Describe</code> statement instead.</p>
</div>
<div class="paragraph">
<p>Then all object and actors at the location will automatically be executed by means of an implicit <code>Describe</code> for each of them. Any objects or actors that were explicitly described using a <code>Describe</code> statements, will be excluded from this automatic <code>Describe</code>.</p>
</div>
<div class="paragraph">
<p>The equivalent of a <code>Look</code> is automatically performed when the hero enters a new location.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>As the player will only see output generated at the same location as the hero, a <code>Look</code> executed by another actor at some other location will not be seen by the player. See <em>Output Statements</em> on page <em>117</em> for more details on this important consideration.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect4">
<h5 id="truesave-and-restore-statements"><a class="anchor" href="#truesave-and-restore-statements"></a>Save and Restore Statements</h5>
<div class="paragraph">
<p><code>Save</code> saves the game on a file for later use with <code>Restore</code>. Both <code>save</code> and <code>restore</code> asks the player for a file name to use for storing and restoring. This allows the player to use unlimited number of save files.</p>
</div>
<div class="paragraph">
<p>If the player should be shown the current surroundings after a <code>Restore</code>, you will have to implement a player verb like</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-alan" data-lang="alan">Verb restore
  Does
    Restore.
    Look.
End Verb restore.</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="truescore-statement"><a class="anchor" href="#truescore-statement"></a>Score Statement</h5>
<div class="paragraph">
<p><code>Score</code> is a way of rewarding the player by giving points for certain actions. This is done using the statement</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ebnf" data-lang="ebnf">score_statement = 'SCORE' integer '.'</code></pre>
</div>
</div>
<div class="paragraph">
<p>For example</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-alan" data-lang="alan">Score 25.</code></pre>
</div>
</div>
<div class="paragraph">
<p>The first time every such statement is executed the points given are added to the player&#8217;s current score. <code>Score</code> without any arguments prints a message indicating the current accumulated score.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The <code>Score</code> statements assume a simple model of scoring; a number of actions are necessary to complete the game and all those are necessary to achieve the maximum number of points. Negative scores are not allowed and once a score is awarded it cannot be revoked, neither will it be awarded twice. For adventures having a more complex and varied scoring system (particularly if the game can be successfully finished without performing all scoring actions or in multiple ways), manual scoring should instead be implemented using attributes (e.g. on the hero) and suitable manipulation and test statements.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect4">
<h5 id="truevisits-statement"><a class="anchor" href="#truevisits-statement"></a>Visits Statement</h5>
<div class="paragraph">
<p>The <code>Visits</code> statement changes the number of times a location can be visited before the long description is presented again:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ebnf" data-lang="ebnf">visits_statement = 'VISITS' count '.'</code></pre>
</div>
</div>
<div class="paragraph">
<p>The value of the argument (<strong>count,</strong> which must be an integer number) controls the number of visits to a particular location between full descriptions. The initial setting of 0 (zero) indicates that every time a particular location is visited its full description will be shown (which can also be expressed as: the full description will <em>not</em> be shown 0 times in between). Thus, a setting of 1 (one) would give a full description every second time the same location is visited. So</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-alan" data-lang="alan">Visits 0.</code></pre>
</div>
</div>
<div class="paragraph">
<p>will always show full descriptions (which is also the initial setting).</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The classic and familiar commands <strong>verbose</strong>, <strong>brief</strong> etc. can be imitated using different values in the <code>Visits</code> statement.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The handling of descriptions is rather conservative in that it also takes modified attributes into account. If the visits calculation would indicate no full description, a modified attribute of the location will cause the full description to be shown the next time. That attribute might have caused the description of the location to change. So the visits handling ensures that the player will &#8220;see&#8221; all changes to the location. If you set attributes of the location every time they are visited, the built-in visits handling will not work as you expect.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Associated with this is a pre-defined attribute, <code>visits</code>, that exists for all instances inheriting from <code>location</code>. It will count how many times the player have visited the location. For example</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-alan" data-lang="alan">The secret_cave IsA location
  Description
    "This is the secret cave. You have visited it"
    Say visits Of This.
    "times before."
End The secret_cave.</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="truetranscript-statement"><a class="anchor" href="#truetranscript-statement"></a>Transcript Statement</h5>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ebnf" data-lang="ebnf">transcript_statement = 'TRANSCRIPT' ('ON' | 'OFF') '.'</code></pre>
</div>
</div>
<div class="paragraph">
<p>Using the <code>Transcript</code> statement you can turn transcripting on or off. When transcripting is turned on all player input and game output is recorded in a file (or similar) which can be studied afterwards. Example uses are</p>
</div>
<div class="ulist">
<ul>
<li>
<p>reading the game output as a novel (player)</p>
</li>
<li>
<p>comparing the output to output from previous versions of the game (author)</p>
</li>
<li>
<p>comparing output to the output of a v2 game (porting from v2)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>To enable player access to the transcripting function you need to implement global verbs:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-alan" data-lang="alan">Syntax script_on = 'script' 'on'.
Verb script_on
  Does
    Transcript On.
    "Transcript turned on."
End Verb.

Syntax script_off = 'script' 'off'.
Verb script_off
  Does
    Transcript Off.
    "Transcript turned off."
End Verb.</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="truewhere-specifications"><a class="anchor" href="#truewhere-specifications"></a>3.18. WHERE Specifications</h3>
<div class="paragraph">
<p>Many constructs in the Alan language require a specification of where the construct should operate. The general intention of such a <code>Where</code>-specification is to specify a location.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ebnf" data-lang="ebnf">where = 'HERE'
      | 'NEARBY'
      | 'NEAR' what
      | 'AT' what
      | 'IN' what</code></pre>
</div>
</div>
<div class="paragraph">
<p>The meaning of the different constructs is as follows</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>Here</code> is the location where the current activity is performed. Often this means where the hero is, but if the expression is evaluated in another run-time context this context is used. See <em>Run-time Contexts</em> on page <em>162</em> for a detailed discussion, but examples include an event scheduled at a particular location, in which case that location is <code>Here</code>. Note that <code>Here</code> is equivalent to <code>At Current Location</code>.</p>
</li>
<li>
<p><code>Nearby</code> means at any adjacent location. An adjacent location means that there exists an exit from the other location to <code>Here</code> (note that the direction is from <code>Nearby</code> to <code>Here</code>). It is allowed to refer to any instance using an identifier or expression. In particular, instances inheriting from <code>location</code> are allowed, which can be used to see if someone at that location can use an exit to get here.</p>
</li>
<li>
<p><code>Near what</code> has a similar meaning to <code>Nearby</code> except that it refers to some other instance (the what) instead of the current location. The results is a truth value indicating if that other instance is at a location which is nearby (has an exit to) that of the location of the first instance.</p>
</li>
<li>
<p><code>At what</code> means at the location of the instance referenced by the <code>what</code> specification (see <em>WHAT Specifications</em> on page <em>140</em>). Note that an instance is always <code>At</code> itself, i.e. <code>x At x</code> is always true. This can come as a surprise, especially if you try to aggregate or loop over instances. (See <em>Aggregates</em> on page <em>150</em> and <em>Repetition Statements</em> on page <em>133</em>.)</p>
</li>
<li>
<p><code>In what</code> must refer to a container and the expression refers to inside of that container.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>These forms can be used in <code>Locate</code> statements and in some expressions for example. When used in their basic form in expressions they all look inside containers (and container in containers) to evaluate the expression. See <em>The Whereabouts of an Entity</em> on page <em>148</em> for more information about <code>Where</code> expressions.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Not all kinds of <code>Where</code> specifications are meaningful in all constructs. Examples are <code>Nearby</code> and <code>Near</code>. They cannot be used in a <code>Locate</code> statement, as it requires a specific location to locate to.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="truewhat-specifications"><a class="anchor" href="#truewhat-specifications"></a>3.19. WHAT Specifications</h3>
<div class="paragraph">
<p>Constructs in the grammar for the Alan language often refer to some class or instance defined in the Alan source. This is generally called a <code>what</code> specification, as it specifies what the construct refers to. An example is the <code>Locate</code> statement that must refer to something that should be relocated.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ebnf" data-lang="ebnf">what = 'CURRENT' 'ACTOR'
     | 'CURRENT' 'LOCATION'
     | 'THIS'
     | id
     | attribute_reference</code></pre>
</div>
</div>
<div class="paragraph">
<p>The meaning of the different forms of the <code>what</code> specification are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>Current Actor</code> is always set to the actor currently active, e.g. when a non-player actor is running a script this refers to the actor instance that is running.</p>
</li>
<li>
<p><code>Current Location</code> is the current location, i.e. the location where the current activity is performed. Normally this is the location where the hero is, but may also be where an event is executed or the location where a scripted actor currently is executing. See <em>Run-time Contexts</em> on page <em>162</em> for more details.</p>
</li>
<li>
<p><code>This</code> refers to the instance in which code, such as a verb body or a script, is run. This can for example be used to test or set attributes in inherited code, thus testing or setting attributes in the instance while the code is defined in a class that the instance inherits from. It cannot be used in events or global verbs.</p>
</li>
<li>
<p>An identifier, <strong>id</strong>, refers to the class or instance with that name, a syntax parameter, script or loop variable with that name. A syntax parameter may have the same name as an class or instance declared elsewhere in the source in which case the parameter has precedence.</p>
</li>
<li>
<p>A reference to an attribute, as described in section <em>Attribute References</em> on page <em>142</em>, might be used depending on its type and the context of the usage of the <code>what</code>-expression.</p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Not all kinds of <code>What</code> specifications are meaningful in all contexts. For example it is not possible to use <code>Current Location</code> (nor an identifier referring to an instance inheriting from location) as the <code>what</code>-part of a <code>Locate In</code> statement. (Since it is illogical to locate locations in containers.)</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="trueexpressions"><a class="anchor" href="#trueexpressions"></a>3.20. Expressions</h3>
<div class="paragraph">
<p>The grammar for Alan refers to expression. This is a generic name for a number of constructs yielding a value. The following sections describe the different kinds of expressions available in the Alan language.</p>
</div>
<div class="sect3">
<h4 id="truetypes-of-expressions"><a class="anchor" href="#truetypes-of-expressions"></a>Types of Expressions</h4>
<div class="paragraph">
<p>Expressions are used e.g. in <code>If</code> and <code>Set</code> statements. The <code>If</code> statement requires a Boolean expression, i.e. an expression yielding a true or false value, while the <code>Set</code> statement can handle all other types of values. See section <em>Types</em> on page <em>51</em> for details on types.</p>
</div>
</div>
<div class="sect3">
<h4 id="trueliteral-values"><a class="anchor" href="#trueliteral-values"></a>Literal Values</h4>
<div class="paragraph">
<p>A single integer (e.g. 42) is a numeric expression. A string is an expression and represents a string value, e.g.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-alan" data-lang="alan">Set password Of terminal To "xyzzy".</code></pre>
</div>
</div>
<div class="paragraph">
<p>A value of the set type can be constructed directly as an expression. This can be used in a <code>Set</code> statement or another expression. E.g.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-alan" data-lang="alan">Set suspectedWeapons Of detective To {gun, bat, axe}.</code></pre>
</div>
</div>
<div class="paragraph">
<p>Each member in the set expression can be an expression of integer or reference type in itself.</p>
</div>
</div>
<div class="sect3">
<h4 id="trueattribute-references"><a class="anchor" href="#trueattribute-references"></a>Attribute References</h4>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ebnf" data-lang="ebnf">attribute_reference = id 'OF' expression
                    | expression ':' id</code></pre>
</div>
</div>
<div class="paragraph">
<p>A references to an attribute can be used as part of any expression provided its type matches the semantics of the context. The type of the expression is the type of the attribute.</p>
</div>
<div class="paragraph">
<p>There are two formats available, of which the first resembles plain English.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-alan" data-lang="alan">Set password Of terminal To password Of manual.</code></pre>
</div>
</div>
<div class="paragraph">
<p>The second format is more compact, which might be preferable when referring to chains of attributes referring to other attributes. See <em>Reference Attributes</em> on page <em>70</em> for an explanation on how this works.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-alan" data-lang="alan">Say detective:suspect:weapon.</code></pre>
</div>
</div>
<div class="paragraph">
<p>It might help to read the ':' as a replacement for <strong>´s</strong>. In this example the detective must be known to have a reference attribute, 'suspect', which can only refer to instances of a class that have an attribute named 'weapon'. It would be the same as</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-alan" data-lang="alan">Say weapon Of suspect Of detective.</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can test Boolean attributes of an instance by following the pattern</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ebnf" data-lang="ebnf">expression = expression 'IS' something</code></pre>
</div>
</div>
<div class="paragraph">
<p>For example</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-alan" data-lang="alan">If bottle Is empty Then …</code></pre>
</div>
</div>
<div class="paragraph">
<p>The test can be reversed by adding a <code>Not</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-alan" data-lang="alan">If hero Is Not hungry Then …</code></pre>
</div>
</div>
<div class="sect4">
<h5 id="truelocation-of"><a class="anchor" href="#truelocation-of"></a>Location Of</h5>
<div class="paragraph">
<p>There is a particularly useful pre-defined pseudo-attribute, <code>location</code>, that can be used to query an instance of which location it is currently at.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-alan" data-lang="alan">Make location Of magic_lantern lit.</code></pre>
</div>
</div>
<div class="paragraph">
<p>This attribute is pre-defined on all instances and is guaranteed to return an instance of the class location, and it will be the innermost location of the instance (bearing in mind that locations may be nested).</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="truerandom-values"><a class="anchor" href="#truerandom-values"></a>Random Values</h4>
<div class="paragraph">
<p>There are three types of random expressions. The first is the traditional random integer expression.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ebnf" data-lang="ebnf">expression = 'RANDOM' expression 'TO' expression</code></pre>
</div>
</div>
<div class="paragraph">
<p>The random integer expression returns a numeric value that is randomly selected between and including the values of the two expressions. Arbitrary expressions yielding an integer value can be used as the boundary expressions.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-alan" data-lang="alan">Set eyes Of first_die To Random 1 To 6.
Decrease temp Of room By Random 0 To temp Of Room.</code></pre>
</div>
</div>
<div class="paragraph">
<p>The second and third types return a random member in a set or in a container respectively.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ebnf" data-lang="ebnf">expression = 'RANDOM' ['DIRECTLY'] 'IN' expression</code></pre>
</div>
</div>
<div class="paragraph">
<p>If the expression refers to a container, the expression returns one of the instances currently in that container. The type of the entire expression is instances of the class accepted by the container. See <em>Container Properties</em> on page <em>81</em> for details on how to determine the class of instances allowed inside a container.</p>
</div>
<div class="paragraph">
<p>If the expression refers to a set, the result is one of the members in the set. The type and class of the entire expression is determined by the allowed members in the set. See <em>Set Type Attributes</em> on page <em>72</em>.</p>
</div>
<div class="paragraph">
<p>The optional keyword <code>Directly</code> is only allowed if the expression refers to a container. The semantics is the same as for the <code>Where</code> expression, see <em>The Whereabouts of an Entity</em> on page <em>148</em>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Attempting to apply a random selection from an empty set or container is one of the very few situations that could lead to a runtime error. It is the responsibility of the author to ensure that this is not attempted. You should always surround a random member expression with an <code>If</code> statement that ensures that the set or container is not empty to guard against such runtime errors. See <em>Aggregates</em> on page <em>150</em> for descriptions on how to count members in a set or container.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>A <code>thing</code> or <code>entity</code> inside a container, which normally do not exhibit themselves, will be candidates for being selected by a <code>Random In</code> statement, as any other instance.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="truelogical-expressions"><a class="anchor" href="#truelogical-expressions"></a>Logical Expressions</h4>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ebnf" data-lang="ebnf">expression = expression ('AND' | 'OR'] expression</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>And</code> and <code>Or</code> operators are standard binary Boolean operators, meaning that the result of an expression is true or false depending on the right and left expressions, which must also be boolean values or expressions. For <code>And</code> both expressions need to be true for the expression to be true. If using <code>Or</code> either of them need to true. Otherwise the expression will be evaluated to false.</p>
</div>
<div class="paragraph">
<p><code>And</code> has higher priority, but parenthesis may be used to change the order of evaluation.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-alan" data-lang="alan">If kalif Here And mood Of sultan Is 0 Then …
If o IsA treasure And (size Of o &gt; capacity Of c
  Or thief Is greedy) Then …</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="trueclass-expressions"><a class="anchor" href="#trueclass-expressions"></a>Class Expressions</h4>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ebnf" data-lang="ebnf">expression = something 'ISA' class_id</code></pre>
</div>
</div>
<div class="paragraph">
<p>It is possible to check if an instance belongs to, or inherits from, a particular class. The resulting value is a Boolean type value.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-alan" data-lang="alan">If p IsA object Then …
If opponent IsA enemy Then …</code></pre>
</div>
</div>
<div class="paragraph">
<p>There is a subtle but very important side effect of checking for an instance class in an <code>If</code>-statement like the above. Doing that will ensure that the instance or parameter that is checked has all the properties. This holds true for all statements in the <code>Then</code>-part of the <code>If</code>-statement.</p>
</div>
<div class="paragraph">
<p>This is used by the compiler to allow references to attributes, scripts, container properties etc. that otherwise would not be allowed.</p>
</div>
<div class="paragraph">
<p>A very common use of this is to restrict parameters in a <code>Syntax</code> to a more general class, like thing or entity, and then doing &#8220;manual&#8221; restrictions using <code>If</code>-statements to ensure that usage does not conflict with the actual properties of the instance. Also see the section on <em>If Statement</em> on page <em>130</em>.</p>
</div>
</div>
<div class="sect3">
<h4 id="truebinary-operators"><a class="anchor" href="#truebinary-operators"></a>Binary Operators</h4>
<div class="paragraph">
<p>All binary operators (plus, minus, multiplication, division) may be used on integer expressions. The result is another integer expression. The exact set of available operators is</p>
</div>
<div class="literalblock">
<div class="content">
<pre>+, -, *, /</pre>
</div>
</div>
<div class="paragraph">
<p>For example</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-alan" data-lang="alan">age Of golden_child + 4</code></pre>
</div>
</div>
<div class="paragraph">
<p>The plus operator (+) may also be used on strings for concatenation. The meaning of such an expression is that the two strings are concatenated into a resulting string. For example</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-alan" data-lang="alan">string1 + " " + anotherString</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="truerelational-and-equality-operators"><a class="anchor" href="#truerelational-and-equality-operators"></a>Relational and Equality Operators</h4>
<div class="paragraph">
<p>Equality (<code>=</code>, meaning equals) and relational operators (<code>&lt;</code>, <code>&gt;</code>, <code>&lt;=</code>, <code>&gt;=</code>, meaning: less than, greater than, less than or equal, greater than or equal respectively) are used to compare expressions. The result is true or false and may be negated by using an optional <code>Not</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-alan" data-lang="alan">If temperature Of oven Not &gt; 100 Then …
If weather Of world Not &lt; protection Of hero Then …</code></pre>
</div>
</div>
<div class="paragraph">
<p>Comparing two string expressions using the binary equality operator <code>=</code> will make a case insensitive comparison, i.e. it will give a true value if the strings are the same without considering the case of the characters. The special identity operator, <code>==</code>, only works on strings and compares the strings for an exact match (i.e. considering character case).</p>
</div>
<div class="paragraph">
<p>Two values of instance type may be compared with the <code>=</code> and <code>&lt;&gt;</code> operators, and may e.g. be used to test if a parameter refers to a particular instance or is the same as another parameter. For example</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-alan" data-lang="alan">Syntax put_in = 'put' (o) 'in' (c)
  Where c IsA Container
    Else "You can't put anything in the" Say c.
Verb put_in
  Check o &lt;&gt; c
    Else "That would be a good trick if you could do it!!"
  Does
…</code></pre>
</div>
</div>
<div class="paragraph">
<p>Relational operations are not allowed on entities or strings, nor is it possible to compare values of different types.</p>
</div>
<div class="paragraph">
<p>A special relational operator is the <code>Between</code> operator which makes it possible to test if a numeric expression is within a range of values. The range is inclusive, i.e. the values are included in the accepted range. For example</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-alan" data-lang="alan">If level Of water Between 2 And capacity Of bottle Then …</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="truestring-containment"><a class="anchor" href="#truestring-containment"></a>String Containment</h4>
<div class="paragraph">
<p>There is a string containment operator, <code>Contains</code>, which can be used to test if a string contains another string. The test ignores any differences in character case. An example of an expression that is true is</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-alan" data-lang="alan">"A string" Contains "a S"</code></pre>
</div>
</div>
<div class="paragraph">
<p>An optional <code>Not</code> (before <code>Contains</code>) can be used to reverse the test.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-alan" data-lang="alan">"A string" Not Contains "a S"</code></pre>
</div>
</div>
<div class="paragraph">
<p>The expression yields a Boolean value.</p>
</div>
</div>
<div class="sect3">
<h4 id="truecurrent-entities"><a class="anchor" href="#truecurrent-entities"></a>Current Entities</h4>
<div class="paragraph">
<p>There are two particularly interesting entities that you might want to know something about or which they are. They are</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>Current Actor</code></p>
</li>
<li>
<p><code>Current Location</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>These two expressions can be used wherever a reference to an instance can be used. They will refer to the currently executing actor and the current location respectively. Details about execution contexts can be found in <em>Run-time Contexts</em> on page <em>162</em>.</p>
</div>
</div>
<div class="sect3">
<h4 id="truethis-instance"><a class="anchor" href="#truethis-instance"></a>This Instance</h4>
<div class="paragraph">
<p>You can also refer to the instance that is actually executing the code containing the expression. This is particularly useful when using inheritance since the class defining the code have no way of knowing which instance will actually execute it. This expression is <code>This</code>.</p>
</div>
<div class="paragraph">
<p>An example is the code for objects that can be opened:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-alan" data-lang="alan">Every openable IsA object
  Is Not open.
  Verb open
    Check …
    Does
      Make This open.
  End Verb.
End Every openable.

The door IsA openable
End The door.</code></pre>
</div>
</div>
<div class="exampleblock gametranscript">
<div class="content">
<div class="paragraph">
<p>&gt; <strong>open the door</strong></p>
</div>
</div>
</div>
<div class="paragraph">
<p>Given these two declarations and some syntax declarations the door will inherit the <code>open</code> attribute. When the verb body, also inherited from <code>openable</code>, is executed, it will set the attribute on <em>the door</em>, because this instance is running the code.</p>
</div>
</div>
<div class="sect3">
<h4 id="truethe-whereabouts-of-an-entity"><a class="anchor" href="#truethe-whereabouts-of-an-entity"></a>The Whereabouts of an Entity</h4>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ebnf" data-lang="ebnf">expression = what ['NOT'] [transitivity] where</code></pre>
</div>
</div>
<div class="paragraph">
<p>An expression following the above pattern can be used to test if a particular instance, as specified by the <code>what</code>, is (or is <code>Not</code>), at the place indicated by the <code>where</code>, as in</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-alan" data-lang="alan">If bottle In inventory Then …</code></pre>
</div>
</div>
<div class="paragraph">
<p>or</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-alan" data-lang="alan">If hero Not Nearby Then …</code></pre>
</div>
</div>
<div class="paragraph">
<p>The forms available for the <code>Where</code> expression are described in detail in <em>WHERE Specifications</em> on page <em>138</em>.</p>
</div>
<div class="paragraph">
<p>The default behaviour of a <code>Where</code> expression is to evaluate recursively through containers, e.g. if the bottle was inside a bag which was in the inventory, the first expression above would still be true. This implicitly transitive evaluation can also be made explicit through the use of the keyword <code>Indirectly</code>. This would result in exactly the same semantics, but it is explicitly expressed, which can be useful.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ebnf" data-lang="ebnf">transitivity =
             | 'DIRECTLY'
             | 'INDIRECTLY'
             | 'TRANSITIVELY'</code></pre>
</div>
</div>
<div class="paragraph">
<p>In addition, another qualifying keyword, <code>Directly</code>, can be used to indicate that the expression should <em>not</em> evaluate recursively into containers. To test if an instance is at a particular location but not in a container at that location you can use:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-alan" data-lang="alan">If key Directly At treasury Then …</code></pre>
</div>
</div>
<div class="paragraph">
<p>The qualifying keyword <code>Directly</code> works in the same way with all <code>Where</code> expressions. Adding a <code>Directly</code> qualifier to the first example above would change the expression to only be true if the bottle was in the container but not inside any other container even if that container was in the inventory. See <em>Containment , Classes and Transitivity</em> on page <em>37</em> for some background information.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>If the transitivity is not Directly, the compiler analyses the container to see which classes of instances might be contained transitively. This includes all existing instances of the class that the container takes, and if any of those are containers, those containers and all instances of the classes they take and so on.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="trueaggregates"><a class="anchor" href="#trueaggregates"></a>Aggregates</h4>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ebnf" data-lang="ebnf">aggregate_expression = aggregate filters

aggregate = 'COUNT' | 'SUM' | 'MAX' | 'MIN'</code></pre>
</div>
</div>
<div class="paragraph">
<p>Aggregates are functions to calculate values from sets of instances. There are four aggregates available, <code>Count</code>, <code>Sum</code>, <code>Min</code> and <code>Max</code>. Aggregates work by inspecting all instances available, applying the filters, which may remove some, or even all, from the set of instances, and then calculate the value from the remaining instances.</p>
</div>
<div class="paragraph">
<p>You can use filters to filter out instances belonging to a particular class, at a particular location or having a particular Boolean attribute. See <em>Filters</em> on page <em>151</em> for an explanation of filters.</p>
</div>
<div class="paragraph">
<p><code>Count</code> counts the number of instances in the set, e.g.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-alan" data-lang="alan">"You are carrying"
Say Count IsA object, In inventory, Is big.
"big objects."</code></pre>
</div>
</div>
<div class="paragraph">
<p>In this example there are three filters applied, <code>IsA object</code>, <code>In inventory</code> and <code>Is big</code>. All of these filters must pass before an instance is counted. The result of that count is an integer, which is then printed using the <code>Say</code> statement.</p>
</div>
<div class="paragraph">
<p>The <code>Sum</code>, <code>Min</code> and <code>Max</code> aggregates return the sum, minimum and maximum value respectively, of an attribute of all instances in the filtered set.</p>
</div>
<div class="paragraph">
<p>Any attribute referred to either in the aggregation itself or in the filters, must be an attribute of some class in order to ensure that the attribute is available for all instances. You must ensure this by filtering out only instances of the relevant class, e.g. objects, using a class filter.</p>
</div>
<div class="paragraph">
<p>Some examples:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-alan" data-lang="alan">If Sum Of weight At bridge &gt; 500 Then …
If Max Of size In inventory &gt; size Of small_door Then …
If Count IsA lightsource, Is lit, Here &gt; 0 Then
  "Let there be light...""
End If.</code></pre>
</div>
</div>
<div class="paragraph">
<p>These examples could be used to create various restrictions in the possible travels of the hero.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="truefilters"><a class="anchor" href="#truefilters"></a>3.21. Filters</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ebnf" data-lang="ebnf">filters = filter { ',' filter }

filter = 'ISA' class
       | is attribute
       | where</code></pre>
</div>
</div>
<div class="paragraph">
<p>Filters can be used to filter out only particular instances to loop or aggregate over. If one of the filters is a <strong>IsA &lt;class&gt;</strong>, only instances of that class will be bound to the loop variable or considered in the aggregation. In particular this is required if any of the other filters refer to attributes, which is only allowed if the class is known and that class is guaranteed to have that attribute. Other ways to restrict the filtered instances is to use a <code>Where</code> filter which implicitly restricts to instances available at or in that location, container or set. See <em>The Whereabouts of an Entity</em> on page <em>148</em> for details on the various forms of the <code>Where</code> expression.</p>
</div>
<div class="paragraph">
<p>Multiple filters can be listed separated with a comma. Each filter must enumerate the set of values to a compatible set, e.g. using two <code>IsA</code> filters for actors and locations respectively is not allowed since those two sets can never be compatible.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="truelexical-definitions"><a class="anchor" href="#truelexical-definitions"></a>4. Lexical Definitions</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="truecomments"><a class="anchor" href="#truecomments"></a>4.1. Comments</h3>
<div class="paragraph">
<p>Comments may be placed anywhere in the Alan source. A comment starts with double hyphens (<code>--</code>) and extends to the end of the line.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-alan" data-lang="alan">-- This is a comment</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="truewords-identifiers-and-names"><a class="anchor" href="#truewords-identifiers-and-names"></a>4.2. Words, Identifiers and Names</h3>
<div class="paragraph">
<p>An identifier is a word in the Alan source, which is used as a reference to a construct, such as an instance. Identifiers may only be composed of letters, digits and underscores. The first character must be a letter.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ebnf" data-lang="ebnf">identifier = letter {letter | digit | underscore}</code></pre>
</div>
</div>
<div class="paragraph">
<p>There is also a second kind of identifier, namely the quoted identifier.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ebnf" data-lang="ebnf">id = identifier
   | quoted_identifier

quoted_identifier = quote {any_character} quote</code></pre>
</div>
</div>
<div class="paragraph">
<p>A quoted identifier starts and ends with single quotes and may contain any character except quotes (including spaces). By quoting any sequence of characters can become an identifier. A quoted identifier may also be used to make an identifier out of a reserved word such as <code>Look</code>. This is useful in the definition of the verb <code>look</code>. It would look like:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-alan" data-lang="alan">Verb 'look'
  Does
    Look.
End Verb 'look'.</code></pre>
</div>
</div>
<div class="paragraph">
<p>Quoted identifiers retain their exact content. They may contain spaces and other special characters, which make them useful as long names for locations as in</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-alan" data-lang="alan">The pluto IsA location Name 'At the Rim of Pluto Crater'
  Description
    …</code></pre>
</div>
</div>
<div class="paragraph">
<p>One single-quoted identifier is used as the whole name of the location to preserve editing and avoiding clashes with the reserved words <code>At</code> and <code>Of</code>. (This could also have been avoided by quoting just those words.)</p>
</div>
<div class="paragraph">
<p>Identifiers and words retain their capitalization. An example is</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-alan" data-lang="alan">The eiffel_tower Name Eiffel tower …</code></pre>
</div>
</div>
<div class="paragraph">
<p>The first word in the name will always be printed with a capital &#8216;E&#8217;. However, when comparing the word to player input and other occurrences of the same word in the source, case will be ignored. This means that you cannot have two words or identifiers that differ only in case, they will be the same and stored in the game data as one of the occurrences, which one is implementation dependent.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Do <em>NOT</em> use a single quoted identifier with spaces or special characters in them as the name for anything other than locations, as the words in names are analysed separately and are assumed to be adjectives and nouns (where it is assumed that the last is the noun). Except for this you should only quote single words to avoid clashes with reserved words.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Any one of the occurrences of a word might define its capitalization, which one is unspecified. This might affect the output if you use capitalization for names of locations, such as &#8220;Name Shore of Great Sea&#8221;. Such names can inadvertently make the game use &#8220;Great&#8221; for all &#8220;great&#8221; things in your game. You can avoid this by using a quoted identifier for the complete name of the location.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Be careful when using quoted identifiers, especially if the player is supposed to use the word. A player cannot input words containing spaces or other special characters or separators. The only exception being underscores and dashes. A player input word must start with a letter.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>To get a single quote within a quoted identifier repeat it (<code>'Tom''s Diner'</code>).</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Some of the identifiers in the source for an Alan game are by default used as player words. This is for example the case with verb names (unless a <code>Syntax</code> statement has been declared for the <code>Verb</code>) and object names (unless a <code>Name</code> clause has been used). If these contain special characters, the player cannot enter them.</p>
</div>
</div>
<div class="sect2">
<h3 id="truenumbers"><a class="anchor" href="#truenumbers"></a>4.3. Numbers</h3>
<div class="paragraph">
<p>Numbers in Alan are only integers and thus may consist only of digits.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ebnf" data-lang="ebnf">number = digit {digit}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="truestrings"><a class="anchor" href="#truestrings"></a>4.4. Strings</h3>
<div class="paragraph">
<p>The string is the main lexical component in an Alan source. This is how you describe the surroundings and events to the player. Strings, therefore, are easy to enter and consist simply of a pair of double quotes surrounding any number of characters. The text may include newline characters and thus may cover multiple lines in the source.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ebnf" data-lang="ebnf">string = double_quote {any_character} double_quote</code></pre>
</div>
</div>
<div class="paragraph">
<p>When processed by the Alan compiler, any multiple spaces, newlines and tabs will be compressed to one single space as the formatting to fit the screen is done automatically during execution of the game (except for embedded formatting information, as specified in <em>Output Statements</em> on page <em>117</em>). You may therefore write your strings any way you like; they will always be neatly formatted on the player&#8217;s screen. You can use special codes (see <em>String Statement</em> on page <em>118</em> for a list) to indicate (but not precisely control) the formatting.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>As strings may contain any character, a missing double quote may lead to many seemingly strange error messages. If the compiler points to the first word after a double quote and indicates that it has deleted a lot if IDs (identifiers), this is probably due to a missing end quote in the previous string.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>To get a double quote within strings repeat it ("The sailor said ""Hello!"".").</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="truefilenames"><a class="anchor" href="#truefilenames"></a>4.5. Filenames</h3>
<div class="paragraph">
<p>It is possible to write one adventure using many source files, having different parts in different files, and thus giving an opportunity for some rudimentary kind of modularisation. The method for this is the <code>import</code> statement.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ebnf" data-lang="ebnf">import = 'import' quoted_identifier '.'</code></pre>
</div>
</div>
<div class="paragraph">
<p>The import statement requires a filename, which must be given as a quoted identifier (see section <em>4.2</em>).</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="truerunning-an-adventure"><a class="anchor" href="#truerunning-an-adventure"></a>5. Running An Adventure</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="truea-turn-of-events"><a class="anchor" href="#truea-turn-of-events"></a>5.1. A Turn of Events</h3>
<div class="paragraph">
<p>The player controls the execution of an Alan adventure. Each of his inputs are taken care of and acted upon by the run-time system in the interpreter. The execution of an Alan adventure starts by executing the start section. The player is then placed in the location indicated in the start section, the location is described, and the player is prompted for a command.</p>
</div>
<div class="paragraph">
<p>The player input is analysed according to the explicit and implicit syntax rules and converted to an execution of verb checks and bodies. Global verb checks and bodies are used for verbs taking no parameters, otherwise the verb bodies are found in the parameter instances or their classes. In case the player typed a directional command the corresponding exit check and code is executed.</p>
</div>
<div class="paragraph">
<p>After the players command has been taken care of, all rules are evaluated and possibly executed. Then each of the other actors executes one step in their scripts (if active) and for each actor the rules are evaluated again. Finally, each event that is scheduled for this round is fired, and the rules evaluated yet again. Finally the player is prompted for another command.</p>
</div>
<div class="paragraph">
<p>So, to summarise:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>get and execute a player command
evaluate all rules
for each actor
  execute one step (if active)
  evaluate all rules as above
end for
for each pending event
  execute it
  evaluate all rules
end for</pre>
</div>
</div>
<div class="paragraph">
<p>A player command may be either a verb or a direction. A verb is executed by checking the syntax of the input, performing any preconditions (checks) and then executing the verb bodies (as described in <em>Verbs</em> and <em>Scope</em> on page <em>99</em>). A directional command is executed by finding any exit in that direction, evaluating the checks and the body (if any) of that exit and locating the <em>hero</em> at the new location.</p>
</div>
<div class="paragraph">
<p>If the player inputs an empty command, this is equivalent to forfeiting his turn. The empty command will simply be ignored. The events and other actors, including turn counting, then proceeds as if the player had input a proper input, before returning to the player prompt.</p>
</div>
</div>
<div class="sect2">
<h3 id="trueplayer-input"><a class="anchor" href="#trueplayer-input"></a>5.2. Player Input</h3>
<div class="paragraph">
<p>The syntax defined in the Alan source is the basis for what the player is allowed to input. Commands with the formats expressed in the syntaxes form the basic statements available to the player. In addition, there are various combinations and variations are possible using special characters and words. The words are of course different for different languages, but in the following generic English words, like &#8220;<strong>AND</strong>-word&#8221;, will be used to denote all words that can be used in the same manner. The exact list of these words for every language with built-in support is available in Appendix <em>E</em>.</p>
</div>
<div class="paragraph">
<p>The following built in syntax variations are available to the player:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Concatenating of statements using <strong>AND</strong>-words like</p>
</li>
</ul>
</div>
<div class="exampleblock gametranscript">
<div class="content">
<div class="paragraph">
<p>&gt; open the door then enter<br>
&gt; take the book and read it<br>
&gt; west. north. east</p>
</div>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>The use of pronouns to refer to the last object mentioned in the previous command, e.g.</p>
</li>
</ul>
</div>
<div class="exampleblock gametranscript">
<div class="content">
<div class="paragraph">
<p>&gt; take the book and read it<br>
&gt; give key to guard and ask him to open the door with it</p>
</div>
</div>
</div>
<div class="paragraph">
<p>The pronouns have to be defined by the author in his source (see <em>Pronouns</em> on page <em>68</em>) or by a library. The only built-in pronoun is the <strong>IT</strong>-word, which is automatically defined on the class <code>thing</code>.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>References to multiple objects using <strong>AND</strong>-word. This allows</p>
</li>
</ul>
</div>
<div class="exampleblock gametranscript">
<div class="content">
<div class="paragraph">
<p>&gt; take the blue vase and the pillow<br>
&gt; the red key, the glass bowl and the compass</p>
</div>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Reference to multiple objects using <strong>ALL</strong>-word</p>
</li>
</ul>
</div>
<div class="exampleblock gametranscript">
<div class="content">
<div class="paragraph">
<p>&gt; drop all</p>
</div>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Excluding objects using a <strong>BUT</strong>-word, like:</p>
</li>
</ul>
</div>
<div class="exampleblock gametranscript">
<div class="content">
<div class="paragraph">
<p>&gt; wear everything except the bowler hat</p>
</div>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>The use of a <strong>THEM</strong>–word to refer to the multiple objects referenced in the previous command, e.g.</p>
</li>
</ul>
</div>
<div class="exampleblock gametranscript">
<div class="content">
<div class="paragraph">
<p>&gt; remove the hat and the scarf then drop them</p>
</div>
</div>
</div>
<div class="paragraph">
<p>The reference to multiple objects (or actors) in a position is only possible if the adventure author has allowed it by using a multiple indicator in the syntax definition (see <em>Syntax Definitions</em> on page <em>91</em>). All the variations above are built in and handled automatically by the run-time system.</p>
</div>
<div class="paragraph">
<p>The interpreter also automatically restricts parameter references to things reachable according to the semantic rules of each built-in base class (see <em>Instances</em> on page <em>56</em> for the complete details). For example objects are only possible to refer to if they are present at the current location, except if the syntax for the command uses the omnipotent <code>!</code> indicator (see <em>Syntax Definitions</em> on page <em>91</em> for details). For some hints on ways to allow the player to refer to objects and actors that are not at the current location, refer to <em>Distant &amp; Imaginary Objects</em> on page <em>183</em>.</p>
</div>
<div class="paragraph">
<p>If the player uses <strong>ALL</strong> instead of a reference to an instance in his command, the verb will be applied to all appropriate instances at the current location, <em>except</em> the ones that do not pass all checks for the verb (see <em>Verbs</em> on page <em>100</em> for further details on this).</p>
</div>
<div class="paragraph">
<p>A restriction placed on the player input by the interpreter is that the words the player is allowed to use can only contain alphanumeric characters, underscores and dash. This must be kept in mind when naming verbs that use the default syntax (an explicit <code>Syntax</code> statement can always specify other player words to trigger the verb).</p>
</div>
</div>
<div class="sect2">
<h3 id="truerun-time-contexts"><a class="anchor" href="#truerun-time-contexts"></a>5.3. Run-time Contexts</h3>
<div class="paragraph">
<p>When the player enters a command, the Alan run-time system evaluates the various constructs from the adventure description (source) as described above. Depending on the player&#8217;s command evaluation of different parts of the adventure may be triggered. These parts all have different conditions under which they are evaluated and have different contexts. Four different execution contexts can be identified:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Execution of a verb. During the execution of a verb (the syntax and verb checks and the verb bodies), which is the result of the player entering a command that was not a directional command, parameters are defined and may be referenced in the statements and expressions. In addition, the <code>Current Actor</code> is set to the hero and <code>Current Location</code> to the location where the hero is (<code>Here</code> refers to the location of the hero).</p>
</li>
<li>
<p>Execution of descriptions. These are started as the response to a directional command, a <code>Look</code> or <code>Describe</code> statement, or a <code>Locate</code> statement operating on the hero. During this, no parameters are defined, <code>Current Actor</code> is set to the hero, and <code>Current Location</code> of course to the location being described. The description clauses for objects and locations, as well as the <code>Entered</code> clause of locations, are evaluated in this context. <code>Entered</code> clauses are executed for all actors entering a location with <code>Current Actor</code> set to the moving actor.</p>
</li>
<li>
<p>Execution of actors. When an actor performs his script step there are no parameters defined but <code>Current Actor</code> is set to the actor currently executing. <code>Current Location</code> is set to that of the executing actor (<code>Here</code> refers to where the executing actor is).</p>
</li>
<li>
<p>Execution of events, no parameters and no actor is defined. The location is set to where the event was scheduled to execute.</p>
</li>
<li>
<p>Execution of rules. Rules are executed without location, so neither parameters, <code>Current Location</code> or <code>Current Actor</code> is defined. Any output statement will in this context be completely useless since the hero can never be at the same location as the execution of the rule.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>So, the execution of various parts of the adventure source can also be said to have a number of different focuses, meaning where the action is considered to take place:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The hero - the actions of the player are always focused on the hero and the actions performed are always related to where the hero is</p>
</li>
<li>
<p>An actor - steps executed by an actor are always focused where the actor is</p>
</li>
<li>
<p>An event - code executed in events are focused where the event was specified to take place</p>
</li>
<li>
<p>A rule - rules are executed after each actor (including the hero) and after each event with the focus set to the complete game world</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="truemoving-actors"><a class="anchor" href="#truemoving-actors"></a>5.4. Moving Actors</h3>
<div class="paragraph">
<p>The main way to move the hero is through the exits (see <em>Exits</em> on page <em>88</em>). They are executed if the player inputs a directional command, i.e. a word defined as the name for an exit in any location. First, the current location is investigated for an exit in the indicated direction, if there is none an error message is printed. Otherwise, that exit is examined for <code>Check</code>s, which are run according to normal rules (see <em>Verb Checks</em> on page <em>102</em>). If there was no <code>Check</code> or if the check passed the statements in the body (the <code>Does</code>-part) is executed. The hero is then located at the location indicated in the exit header, which will result in the description of the location (by executing the <code>Description</code>-clause of the location) and any objects or actors present (by executing their <code>Description</code>s, explicit or implicit).</p>
</div>
<div class="paragraph">
<p>When any actor (including the hero) is located at a location, the <code>Entered</code> clause of that location is executed as if the actor had moved into that <code>Location</code>. The actor that was moved will be the <code>Current Actor</code> even if the movement was not caused by him (but the result of an event, for example). Therefore, this is also the last step in the sequence of events caused by locating the hero somewhere.</p>
</div>
</div>
<div class="sect2">
<h3 id="trueundoing"><a class="anchor" href="#trueundoing"></a>5.5. Undoing</h3>
<div class="paragraph">
<p>A player might occasionally regret a command that he gave, perhaps realising that it was not the correct one. The Alan interpreter supports such undoing of commands. This means that the player can backup commands that (s)he later regretted. The interpreter stores each game state as soon as it has changed and an <code>undo</code> command resets the game state to the last saved one. This works completely automatically and as many states as memory permits is saved, giving almost unlimited <code>undo</code> capability.</p>
</div>
<div class="paragraph">
<p>The player command to restore a previous game state is handled directly by the interpreter. It must consist of the single word <code>undo</code>.</p>
</div>
</div>
<div class="sect2">
<h3 id="truescripting-and-commenting"><a class="anchor" href="#truescripting-and-commenting"></a>5.6. Scripting and Commenting</h3>
<div class="paragraph">
<p>Most versions of the Alan interpreter, Arun, supports both taking a transcript of a game in progress and playing it back as input to the interpreter.</p>
</div>
<div class="paragraph">
<p>This is very convenient during development of a game where you can play through the game up to a point and start from there, or even automatically test your game.</p>
</div>
<div class="paragraph">
<p>To make Arun read input from a script file you can use the special command character &#8216;<code>@</code>&#8217;, which should be followed by the name of the text file in which your commands are listed.</p>
</div>
<div class="paragraph">
<p>You can add comments to each line in a script file. The interpreter will not read beyond a semicolon, &#8216;<code>;</code>&#8217;, so anything after it can be seen as a comment. Note that this also works for direct player input.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="truehints-and-tips"><a class="anchor" href="#truehints-and-tips"></a>6. Hints And Tips</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This chapter will give you some ideas about how the various features of Alan may be used to implement common features in an adventure game. These are only suggestions and you are, of course, welcome to invent your own, but these are probably some ideas that can get you started.</p>
</div>
<div class="paragraph">
<p>Using the import mechanism of the Alan language (see <em>Import</em> on page <em>54</em>) you can reuse snippets that you invent in multiple games or works. By building such a library you don&#8217;t have to reinvent the same thing every time.</p>
</div>
<div class="paragraph">
<p>A very easy way to get a lot of functionality, and learn about using the language, is to use the Alan standard library. You you can download it from the Alan Home Pages. It implements many of the things described below, and loads of other handy things for you to use directly. For details on how to use that library, refer to its documentation.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The following examples, hints and tips does <em>not</em> use any library, only plain vanilla Alan code.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="sect2">
<h3 id="trueuse-of-attributes"><a class="anchor" href="#trueuse-of-attributes"></a>6.1. Use of Attributes</h3>
<div class="paragraph">
<p>Attributes are primarily used for holding status information about the instance to which it belongs. This allows, for example, a water bottle to contain three levels of water.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-alan" data-lang="alan">The bottle IsA object
  Has level 3.
  Verb drink
    Does
    If level Of bottle &gt; 0 Then
      "You take sip from the bottle."
      Decrease level OF bottle.
    Else
      "There is no more water in the bottle."
    End If.
  End Verb drink.
End The bottle.</code></pre>
</div>
</div>
<div class="paragraph">
<p>Another example is the broken mirror.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-alan" data-lang="alan">The mirror IsA object
  Is Not broken.
  Verb break
    Does
      Make mirror broken.
  End Verb break.
End The mirror.</code></pre>
</div>
</div>
<div class="paragraph">
<p>The appropriate verbs defined in the instances may then modify the attributes and thus update the status information.</p>
</div>
<div class="paragraph">
<p>Attributes defined for a whole class of instances also allow an extra dimension of classification of the instances. If the following declaration is made</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-alan" data-lang="alan">Add To Every object
  Not takeable.</code></pre>
</div>
</div>
<div class="paragraph">
<p>then all objects receive the attribute &#8220;takeable&#8221; and unless the attribute is specifically redeclared for a particular instance they will not be take-able. Note however that the semantic meaning (what actually happens, such as preventing the &#8220;taking&#8221;) of &#8220;takeable&#8221; must be implemented e.g. in the verb &#8220;take&#8221;:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-alan" data-lang="alan">Verb take
  Check Object Is takeable
    Else "You can't take the $o."
  Does
    Locate Object In inventory.
End Verb take.</code></pre>
</div>
</div>
<div class="paragraph">
<p>In the same way restrictions concerning what is possible to eat, drink, open etc. may be implemented. This use of attributes to classify instances is &#8220;action-oriented&#8221;, i.e. they imply that a particular action (verb) is applicable to the instance.</p>
</div>
<div class="paragraph">
<p>An alternate approach is to use attributes to classify instances after their characteristics. Consider:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-alan" data-lang="alan">Verb take
  Check o Is Not heavy
    Else "That is much too heavy."
  And o Is Not animal
    Else "$+1 moves quickly away, just far enough
          for you not to reach it."
  Does
    Locate o In hero.
    "You take" Say The o. "."
End Verb take.</code></pre>
</div>
</div>
<div class="paragraph">
<p>With this approach you need to keep track of which properties a particular verb will accept or require. This could be extended one step further, having verbs check actual dimensions, such as weight or size, instead.</p>
</div>
<div class="paragraph">
<p>An while we are talking about classification, the Alan 3 class concept can help. Often a classification can be made, clearly and succinctly, by defining a sub-class, for which every property pertaining to that type of instances can be collected. Often, the need for an attribute disappears.</p>
</div>
<div class="paragraph">
<p>Further more, you don&#8217;t need to define a syntax for a single parameter verb if it only accepts instances from a particular class. Consider the following definitions:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-alan" data-lang="alan">Every vehicle IsA object
End Every vehicle.

Every car IsA vehicle
  Verb drive
    Does "Yoooohooooo!"
  End Verb.
End Every car.

Every bus IsA vehicle
End Every bus.

The car1 IsA car At l
End The car1.

The bus1 IsA bus At l
End The bus1.</code></pre>
</div>
</div>
<div class="paragraph">
<p>Without any syntax definition what so ever, Alan will supply a default syntax for the drive verb which restricts the use of it to only instances of car:</p>
</div>
<div class="exampleblock gametranscript">
<div class="content">
<div class="paragraph">
<p>&gt; look</p>
</div>
<div class="paragraph">
<p>There is a car1 and a bus1 here.</p>
</div>
<div class="paragraph">
<p>&gt; drive bus1<br>
You can&#8217;t do that.</p>
</div>
<div class="paragraph">
<p>&gt; drive car1<br>
Yoooohooooo!</p>
</div>
</div>
</div>
<div class="paragraph">
<p>So the class mechanism not only allows for another way to classify your instances, but also makes it much easier to get player input handled correctly.</p>
</div>
</div>
<div class="sect2">
<h3 id="truedescriptions"><a class="anchor" href="#truedescriptions"></a>6.2. Descriptions</h3>
<div class="paragraph">
<p>Attributes come in handy when presenting information about instances to the player. The attributes can be tested in <code>If</code>-statements to modify the <code>Description</code>s and possibly even the short description in the <code>Mentioned</code> sections.</p>
</div>
<div class="paragraph">
<p>For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-alan" data-lang="alan">The mirror IsA object
  Is Not broken.
  Description
    "On the wall there is a beautiful mirror with an
     elaborate golden frame."
    If mirror Is broken Then
      "Some moron has broken the glass in it."
    End If.
  Verb break
    Does
      Make mirror broken.
  End Verb break.
End The mirror.</code></pre>
</div>
</div>
<div class="paragraph">
<p>If you also use this feature with the short descriptions will make the adventure feel a bit more consistent.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-alan" data-lang="alan">The bottle IsA object
  Has level 3.
  Article ""
  Mentioned
    If level Of bottle &gt; 0 Then
      "a bottle of water"
    Else
      "an empty bottle"
    End IF.
End The bottle.</code></pre>
</div>
</div>
<div class="paragraph">
<p>If the bottle had level 0 and was in the hero&#8217;s container, this would result in</p>
</div>
<div class="exampleblock gametranscript">
<div class="content">
<div class="paragraph">
<p>&gt; inventory<br>
You are carrying an empty bottle.</p>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="truecommon-verbs"><a class="anchor" href="#truecommon-verbs"></a>6.3. Common Verbs</h3>
<div class="paragraph">
<p>As your library of adventures grow you will find that some verbs are often needed, and always function the same way. Examples are &#8220;take&#8221;, &#8220;drop&#8221;, &#8220;invent&#8221;, &#8220;look&#8221;, &#8220;quit&#8221; and so on. It is advisable to put them in a file which may then be imported into your games. See section <em>3.4</em> <em>Import</em> on page <em>54</em> about the import mechanism. The files may then containing these common verbs as well as their syntax definitions and any synonyms. Attributes needed for these particular verbs could also be placed in a default attribute declaration in this file.</p>
</div>
<div class="paragraph">
<p>All your adventures may then import this file (or files), making these features immediately accessible when you start a new adventure. All that this takes is some thought as to what names to use for the attributes as discussed in <em>Use of Attributes</em> on page <em>167</em>.</p>
</div>
<div class="paragraph">
<p>And of course there is already an extensive library available from the Alan website, <a href="http://www.alanif.se/"><em>http://www.alanif.se</em></a>. It also includes a lot of other features common to most adventure games.</p>
</div>
</div>
<div class="sect2">
<h3 id="truedistant-events"><a class="anchor" href="#truedistant-events"></a>6.4. Distant Events</h3>
<div class="paragraph">
<p>An effect of the feature that output is not visible unless the hero is present, is that the description of an event might not always be presented to the player.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-alan" data-lang="alan">Event explosion
  "A gigantic explosion fills the whole room with smoke
   and dust. Your ears ring from the loud noise. After
   a while cracks start to show in the ceiling,
   widening fast, stones and debris falling in
   increasing size and numbers until finally the
   complete roof falls down from the heavy explosion."
  Make Location destroyed.
End Event.</code></pre>
</div>
</div>
<div class="paragraph">
<p>If the hero isn&#8217;t at the location where the event is executed, he will never know anything about what has happened. The solution is to create an event that goes of where the hero is.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>Event distant_explosion
  "Somewhere far away you can hear an explosion."
End Event.
…
If Hero Nearby Then
  Schedule distant_explosion At Hero After 0.
…</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="truedoors"><a class="anchor" href="#truedoors"></a>6.5. Doors</h3>
<div class="paragraph">
<p>A common feature in adventure games is the closed door. Here&#8217;s one way implement it:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-alan" data-lang="alan">The treasury_door IsA object At hallway
  Name treasury door
  Is Not open.
  Verb open
    Does
      Make treasury_door open.
      Make hallway_door open.
  End Verb open.
End The treasury_door.

The hallway IsA location
  Exit east To treasury
    Check treasury_door Is open
      Else "The door to the treasury is closed."
  End Exit.
End The hallway.

The hallway_door IsA object At treasury
  Name hallway door
  Is Not open.
  Verb open
    Does
      Make treasury_door open.
      Make hallway_door open.
  End Verb open.
End The hallway_door.

The treasury IsA location
  Exit west TO hallway
    Check hallway_door Is open
      Else "The door to the hallway is closed."
  End Exit.
End The treasury.</code></pre>
</div>
</div>
<div class="paragraph">
<p>Note that we need two doors, one at each location, but they are synchronised by always making them both opened or closed at the same time. The check in the <code>Exit</code>s makes sure that the hero cannot pass through a closed door.</p>
</div>
</div>
<div class="sect2">
<h3 id="truequestions-and-answers"><a class="anchor" href="#truequestions-and-answers"></a>6.6. Questions and Answers</h3>
<div class="paragraph">
<p>Sometimes it may be necessary to ask the player for an answer to some question. One example is if you want to confirm an action. The following example delineates one simple way to do this, which could be adopted for various circumstances.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-alan" data-lang="alan">The hero IsA actor
  Is Not quitting.
End The hero.

Syntax
  'quit' = 'quit'.
  yes = yes.

Synonyms
  y = yes.
  q = 'quit'.

Verb 'quit'
  Does "Do you really want to give up?
        Type 'yes' to quit, or to carry on just
        type your next command."
  Make hero quitting.
  Schedule unquit After 1.
End Verb 'quit'.

Verb yes
  Check hero Is quitting
    Else "That does not seem to answer any question."
  Does Quit.
End Verb yes.

Event unquit
  Make hero Not quitting.
End Event unquit.</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="trueactors-2"><a class="anchor" href="#trueactors-2"></a>6.7. Actors</h3>
<div class="paragraph">
<p>Actors are vital components to make a story dynamic. They move around and act according to their scripts. To make the player aware of the other actor&#8217;s actions they need to be described. This must be done so that the player always get the correct perspective on the actions of the actors.</p>
</div>
<div class="paragraph">
<p>A way to ensure this is to rely on the fact that output statements are not shown unless the hero is at the location where the output is taking place. This means that for every actor action, especially movement, you need to first describe the actions, then let the actor perform them and, finally, possibly describe the effects.</p>
</div>
<div class="paragraph">
<p>An example is the movement of an actor from one location to another. In this case the step could look something like</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-alan" data-lang="alan">"Charlie Chaplin goes down the stairs to the hallway."
Locate charlie_chaplin At hallway.
"Charlie Chaplin comes down the stairs and
 leaves the house through the front door."
Locate charlie_chaplin At outside_house.
"Charlie Chaplin comes out from the nearest house."</code></pre>
</div>
</div>
<div class="paragraph">
<p>An actor is described, for example, when a location is entered or as the result of a <strong>Look,</strong> in the same way as objects are. This means that a good idea is to include the description of an actor&#8217;s activities in the description of him. One way to do this would be to use attributes to keep track of the actors state and test these in the description clause.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-alan" data-lang="alan">The george IsA actor
  Name George Formby
  Is
    Not cleaning_windows.
    Not tuning.
  Description
    If george Is cleaning_windows Then
      "George Formby is here cleaning windows."
    ElsIf george Is tuning Then
      "George Formby is tuning his ukelele."
    Else
      "George Formby is here."
    End If.
…</code></pre>
</div>
</div>
<div class="paragraph">
<p>Although quite feasible, this is a bit tedious. As, at least a part of, the state is indicated by the script the actor is executing, this could be used to avoid the potentially large <code>If</code>-chain. The optional descriptions tied to each script will be executed instead of the main description when the actor is following that script. So this would allow us to simplify to:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-alan" data-lang="alan">The george IsA actor
  Name George Formby
  Description
    "George Formby is here."
  Script cleaning.
    Description
      "George Formby is here cleaning windows."
    Step
      …
  Script tuning.
    Description
      "George Formby is tuning his ukelele."
    Step
      …
…</code></pre>
</div>
</div>
<div class="paragraph">
<p>This makes it easier to keep track of what an actor is doing. Another hint here is to describe the change in an actor&#8217;s activities at the same time as executing the <code>Use</code> statement, like</p>
</div>
<div class="paragraph">
<p>Event start_cleaning<br>
Use Script cleaning For george.<br>
"All of a sudden, George starts to clean the windows."<br>
End Event.</p>
</div>
<div class="paragraph">
<p>This makes the descriptions of changes to be shown when it takes place and the description of the actor is always consistent. You can, of course, still have attributes describing the actor&#8217;s state to customize the description of the actor on an even more detailed level, but it generally suffices to describe an actor in terms of what script he is executing.</p>
</div>
</div>
<div class="sect2">
<h3 id="truevehicles"><a class="anchor" href="#truevehicles"></a>6.8. Vehicles</h3>
<div class="paragraph">
<p>The current version of Alan does not support actors being inside containers or inside other actors, which could be a straight forward way to implement vehicles. However, as the reader/player does not need to know how the output is generated we can use a location and a row of events to substitute for the vehicle.</p>
</div>
<div class="paragraph">
<p>Let&#8217;s start with the geography:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-alan" data-lang="alan">The garage IsA location
End The garage.

The parking_lot IsA location Name 'Large Parking Lot'
End The parking_lot.</code></pre>
</div>
</div>
<div class="paragraph">
<p>Then we need the actual car:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-alan" data-lang="alan">The car IsA object Name little red sporty ferrari Name car
  At garage
  Is Not running.
  Has position 0.

  Verb enter
    Does
      Locate hero At inside_car.
  End Verb enter.

End The car.</code></pre>
</div>
</div>
<div class="paragraph">
<p>We also need a description of the inside of it. We will use another location for this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-alan" data-lang="alan">The inside_car IsA location Name 'Inside the Ferrari'
  Description
    "This sporty little red vehicle can really take you
     places..."
  Exit out TO inside_car
    Check car Is Not running
      Else "I think you should stop the car before getting
            out..."
    Does
      Depending On position Of car
        = 0 Then Locate hero At garage.
        = 1 Then Locate hero At parking_lot.
        --- Etc.
    End Depend.
  End Exit.

  Verb drive
    Check car Is Not running
      Else "You are already driving it!"
    Does
      Make car running.
      If car At garage Then Schedule drive_to_parking After 0.
      Else Schedule drive_to_garage After 0.
      End If.
  End Verb drive.

  Verb park
    Check car Is running
      Else "You are not driving it!"
    Does
      "You slow to a stop and turn the engine off."
      Make car Not running.
      Cancel drive_to_parking. Cancel drive_to_garage.
  End Verb park.

End The inside_car.</code></pre>
</div>
</div>
<div class="paragraph">
<p>We must make sure that the player can just say &#8220;drive&#8221; and &#8220;park&#8221; by defining the syntax for those single word commands:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-alan" data-lang="alan">Syntax drive = drive.
Syntax park = park.</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can also see from the code above that there are (at least) two events that need to be defined too. They handle the movement of the car from one place to another:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-alan" data-lang="alan">Event drive_to_parking
  "You drive out from your garage and approach a large
   parking lot."
  Set position Of car To 1.
  Locate car At parking_lot.
  Schedule drive_to_garage After 1.
End Event drive_to_parking.

Event drive_to_garage
  "You drive out from the parking lot and approach your own
   garage."
  Set position Of car To 0.
  Locate car At garage.
  Schedule drive_to_parking After 1.
End Event drive_to_garage.</code></pre>
</div>
</div>
<div class="paragraph">
<p>The main idea is that the player/reader is inside the car, and the events are executed at this location thus emulating movement.</p>
</div>
<div class="paragraph">
<p>There is a multitude of solutions for this problem. One possibility is to exchange the car object for an actor and the events for script steps. However, in this solution the car object is not where the hero is (<code>inside_car</code>) so the output from the scripts for the car will not automatically be shown to the player. There are (at least) two different ways to deal with this (one involving attributes, the other involving an extra object), but the solutions are left as an exercise to the reader!</p>
</div>
<div class="paragraph">
<p>As Alan allows nesting locations (locating a location at another as if it was an object or actor), yet another solution would be to actually move the car location between the garage and the parking lot.</p>
</div>
<div class="paragraph">
<p>Sincere thanks go to Walt (<a href="mailto:sandsquish@aol.com">sandsquish@aol.com</a>) for inspiring communication that brought this example to life.</p>
</div>
</div>
<div class="sect2">
<h3 id="truefloating-objects"><a class="anchor" href="#truefloating-objects"></a>6.9. Floating Objects</h3>
<div class="paragraph">
<p>Floating objects is a term used for objects that are available everywhere, or at least at many places. Usually they are available wherever the hero is, and we want to avoid creating duplicate objects, so in a way we make them float along with the hero, or some other actor, instead.</p>
</div>
<div class="sect3">
<h4 id="truebody-parts"><a class="anchor" href="#truebody-parts"></a>Body Parts</h4>
<div class="paragraph">
<p>One example of floating objects is the various parts of the hero&#8217;s body.</p>
</div>
<div class="paragraph">
<p>To create floating objects you can use a particular feature of entities, namely the fact that they are always located where the hero is. Such an entity can of course have the container property to allow it to contain a number of other instances.</p>
</div>
<div class="paragraph">
<p>So to have the hero&#8217;s body parts available wherever the hero goes you can use:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-alan" data-lang="alan">The body_parts IsA entity
  Container
End The body_parts.

The right_arm IsA object Name right arm In body_parts …
The head IsA object Name head In body_parts …</code></pre>
</div>
</div>
<div class="paragraph">
<p>Using entity containers is also a simple way to create other compartments on the hero, such as a belt.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-alan" data-lang="alan">The belt IsA entity
  Container
    Header
      If Count In hero &gt; 0 Then "and"
      Else "but" End If.
        "in your belt you have"
      Else
        ""
End The belt.</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can combine that with the following definitions of the hero and the 'invent' verb:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-alan" data-lang="alan">The hero IsA actor
  Container
    Header "You are carrying"
    Else "You are empty-handed"
      If Count In belt = 0 Then "." End If.
End The hero.

Verb invent
  Does
    List hero.
    List belt.
End Verb invent.</code></pre>
</div>
</div>
<div class="paragraph">
<p>And the following output could result:</p>
</div>
<div class="exampleblock gametranscript">
<div class="content">
<div class="paragraph">
<p>&gt; invent<br>
You are empty-handed but in your belt you have a knife.</p>
</div>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The example use the count aggregate to see if the other container is empty or not, and select appropriate output depending on that.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="trueoutdoors-and-indoors"><a class="anchor" href="#trueoutdoors-and-indoors"></a>Outdoors and Indoors</h4>
<div class="paragraph">
<p>Another example of floating objects are semi-abstract objects like the air, the ground and walls. Some of these also have the extra complexity that they should be available only under certain conditions.</p>
</div>
<div class="paragraph">
<p>Of course, you would not want outdoor things to be available when you are indoors. To solve this, simply create yet another container object where we can store the outdoor things when they should not be accessible and place it where the hero can never be. Now we only need to make sure that the objects are transferred between the two storages:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-alan" data-lang="alan">The outdoor_things IsA entity
  Container
End The outdoor_things.

The outdoor_things_storage IsA object At limbo
  Container
End The outdoor_things_storage.

The air IsA object In outdoor_things_storage …
The sky IsA object In outdoor_things_storage …

When location Of hero Is outdoors =&gt;
  Empty outdoor_things_storage In outdoor_things.
When location Of hero Is Not outdoors =&gt;
  Empty outdoor_things In outdoor_things_storage.</code></pre>
</div>
</div>
<div class="paragraph">
<p>You need to add the boolean attribute <code>outdoors</code> to every location to the make the rules work, of course.</p>
</div>
<div class="paragraph">
<p>And Voilà, every time the hero arrives at an outdoor location he will find the air and the sky. And every time he enters a location that has the attribute <code>outdoors</code> set to false he will not find them available.</p>
</div>
<div class="paragraph">
<p>Well, perhaps he would like to have the air available indoors too, but that is left as an exercise for the reader!</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>An alternative to the location attribute, is to use classes. Define an outdoor_location class and an indoor_location class. Then inherit as appropriate, and the rules could instead look like:</p>
</div>
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-alan" data-lang="alan">When location Of hero IsA outdoors_location =&gt; …
When location Of hero IsA indoors_location =&gt; …</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="truenested-locations-as-a-solution"><a class="anchor" href="#truenested-locations-as-a-solution"></a>Nested Locations as a Solution</h4>
<div class="paragraph">
<p>Yet another option would be to make use of the nested locations feature. Put all your outdoor locations in a outdoor location where the outdoor_storage entity is also present (this is just a hint):</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-alan" data-lang="alan">The outdoor_region IsA location
End The outdoor_region.

The park IsA location At outdoor_region
End The park.</code></pre>
</div>
</div>
<div class="paragraph">
<p>Then the outdoor items can stay at this &#8220;region&#8221; location, no need for rules or extra containers.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="truedarkness-and-light-sources"><a class="anchor" href="#truedarkness-and-light-sources"></a>6.10. Darkness and Light Sources</h3>
<div class="paragraph">
<p>A very common puzzle in old time adventures (so much so that it has possibly been exploited beyond its potential) is the problem of dark locations and finding a source of light.</p>
</div>
<div class="paragraph">
<p>Darkness and light sources can be implemented in Alan in different ways. Again we basically have the choice between attributes and classes. The solutions are both general and rather similar so we will have a look at the solution using attributes and leave the other solution to the reader. (A good exercise to really understand the Alan class concept, so please take a stab at it. If you want to have a look at one solution, you can study the Alan standard library, which uses classes to implement light sources.)</p>
</div>
<div class="paragraph">
<p>First we need an attribute that all objects have. We know we only need to consider objects because light sources need to be transported by the player, so they can not just be anywhere, like entities.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-alan" data-lang="alan">Add To Every object
  Is
    Not lightsource.
End Add To.</code></pre>
</div>
</div>
<div class="paragraph">
<p>This ensures that all objects have the boolean (true/false valued) attribute <code>lightsource</code> with the default not being a light source. Any object that provides light need to explicitly state that they are instead. For some instances this attribute might change value dynamically, e.g. when the lamp is lit and extinguished.</p>
</div>
<div class="paragraph">
<p>Locations then must declare themselves as lit or not:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-alan" data-lang="alan">Add To Every location
  Is lit.
End Add To.</code></pre>
</div>
</div>
<div class="paragraph">
<p>Here we assume most locations are lit, dark locations need to declare themselves <code>Not lit</code>.</p>
</div>
<div class="paragraph">
<p>We can now count the number of instances at the current location having the attribute <code>lightsource</code> set and if there are one or more there is some light provided. So, the <code>look</code> verb could be reworked to:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-alan" data-lang="alan">Verb 'look'
  Check Current Location Is lit
    Or Count IsA object, Is lightsource, Here &gt; 0
  Else
    "You cannot see anything without any light."
  Does
    Look.
End Verb.</code></pre>
</div>
</div>
<div class="paragraph">
<p>The check of the <code>look</code> verb now checks the current locations need for light and then counts instances of object, that are light sources and present, to see if there is light.</p>
</div>
<div class="paragraph">
<p>Of course, we must also modify the dark locations so that they don&#8217;t display their descriptions upon entrance. This is easy to do using another addition to every location, a description check, similar to the check in the <code>look</code> verb:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-alan" data-lang="alan">Add To Every location
  Description
  Check Current Location Is lit
    Or Count IsA object, Is lightsource, Here &gt; 0
  Else
    "You cannot see anything without any light."
End Add To.</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="truedistant-imaginary-objects"><a class="anchor" href="#truedistant-imaginary-objects"></a>6.11. Distant &amp; Imaginary Objects</h3>
<div class="paragraph">
<p>Sometimes you need to make it possible for the player to refer to things either far away, that are not really objects or that may be at many places at once. Examples of these are a distant mountain that may be examined through a set of binoculars, the melody in &#8220;whistle the melody&#8221;, and water or walls. One way of handling this is to use entities, since they are &#8220;everywhere&#8221;. But sometimes you need better control over when they are available and when not.</p>
</div>
<div class="sect3">
<h4 id="truea-mountain"><a class="anchor" href="#truea-mountain"></a>A Mountain</h4>
<div class="paragraph">
<p>For objects that need to be visible from a distance, the easiest method is to introduce a &#8216;shadow object&#8217;. This is a second object acting on behalf of, or representing, the distant object at the locations where it should be possible to refer to it. For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-alan" data-lang="alan">The hills IsA location
  :
End The hills.

The mountain IsA object At hills
  :
End The mountain.

The scenic_vista IsA location Name Scenic Vista
End The scenic_vista.

The shadow_mountain IsA object AT scenic_vista
  Name distant mountain
  Description
    "Far in the distance you can see the Pebbly
     Mountain raising towards the sky."
End The shadow_mountain.</code></pre>
</div>
</div>
<div class="paragraph">
<p>This would allow for example at scenic_vista:</p>
</div>
<div class="exampleblock gametranscript">
<div class="content">
<div class="paragraph">
<p><strong>Scenic Vista.</strong><br>
Far in the distance you can see the Pebbly Mountain raising<br>
towards the sky.<br></p>
</div>
<div class="paragraph">
<p>&gt; look at mountain through the binoculars<br>
&#8230;&#8203;</p>
</div>
</div>
</div>
<div class="paragraph">
<p>If the mountain must be visible and possible to manipulate from a number of locations, you might implement one shadow object for each location, but this might become a bit tedious if they are many. If they are identical you can use a simple rule like the following:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-alan" data-lang="alan">When hero At scenic_vista Or hero At hill_road =&gt;
  Locate shadow_mountain At hero.</code></pre>
</div>
</div>
<div class="paragraph">
<p>This will ensure that whenever the hero moves to any of the places from where the mountain is visible, the <code>shadow_mountain</code> is sure to follow. However, as the rules are executed <em>after</em> the hero already has moved, a better strategy might be to make the <code>shadow_mountain</code> &#8216;silent&#8217;, i.e. to have no description. Instead, the description of it should then be embedded in the description of the adjacent locations. Yet, another possibility would be to move the pseudo-object around using statements in the exits, like</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-alan" data-lang="alan">The scenic_vista IsA location Name Scenic Vista
  Exit east To path
    Does
      Locate shadow_mountain At path.
  End Exit east.
End The scenic_vista.</code></pre>
</div>
</div>
<div class="paragraph">
<p>Regardless of which of these strategies you chose, you need to take care that the shadow object is not present when the real object is. In this particular case, it should not be moved to the hills.</p>
</div>
</div>
<div class="sect3">
<h4 id="truethe-melody"><a class="anchor" href="#truethe-melody"></a>The Melody</h4>
<div class="paragraph">
<p>To allow the player to 'whistle the melody' for example, there are two different tactics that can be applied. One choice is to make the melody an <code>entity</code> (or some subclass thereof that you have defined), because, as we have seen, those can be manipulated from everywhere:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-alan" data-lang="alan">The melody IsA entity …
Syntax 'whistle' = 'whistle' (m) …</code></pre>
</div>
</div>
<div class="paragraph">
<p>The other route would be to make it an actual <code>object</code>. In this case the syntax for the whistle verb would need to indicate omnipotence, meaning that the player can refer to instances (even those inheriting from <code>object</code>) to be used as parameters even from afar.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-alan" data-lang="alan">The melody IsA object …
Syntax 'whistle' = 'whistle' (m)! …</code></pre>
</div>
</div>
<div class="paragraph">
<p>The melody then does not have to be reachable, near or even be at any location at all, for the player to be able to refer to it.</p>
</div>
<div class="paragraph">
<p>In both cases you would most likely need to restrict the parameters for the syntax so that the player can&#8217;t 'whistle the chair'. Which of the two strategies you would chose greatly depends on things like:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>are there many things that this applies to (many 'melodies', perhaps)?</p>
</li>
<li>
<p>should the player be able to manipulate this instance in other ways?</p>
</li>
<li>
<p>do you need many different entities for various purposes?</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect2">
<h3 id="trueusing-events-as-functions"><a class="anchor" href="#trueusing-events-as-functions"></a>6.12. Using Events as Functions</h3>
<div class="literalblock">
<div class="content">
<pre>&lt;to be supplied&gt;</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="truestructure"><a class="anchor" href="#truestructure"></a>6.13. Structure</h3>
<div class="paragraph">
<p>A good thing to do when designing an interactive fiction story is to separate the geography from the story. In Alan, you can use the import facility to structure your Alan source. One approach could be to place the description of each location in a separate file together with any objects that could be considered part of the scenery or at least is not only a tool in a puzzle. These files can then be included in a &#8216;map&#8217; file, which in turn is included by the top-level file.</p>
</div>
<div class="paragraph">
<p>The story line can be divided into files too, one for each <code>scene</code>. A scene being comments describing the important things that are suppose to happen, any prerequisites and objects, events, rules etc. which are specific for this part of the story.</p>
</div>
<div class="paragraph">
<p>This strategy will both give you a better structure of your adventure as well as help you design a better story, much like the storyboarding technique used in making movies or plays.</p>
</div>
</div>
<div class="sect2">
<h3 id="truedebugging"><a class="anchor" href="#truedebugging"></a>6.14. Debugging</h3>
<div class="paragraph">
<p>Occasionally your Alan code is flawed and you really can&#8217;t understand what is actually happening. To aid in discovering which part of your code is run when, the interpreter Arun incorporates some features for debugging. There are a few debugging switches available when starting the interpreter from the command line:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>-c       Log the commands input by the player
-l       Log a complete transcript of the game
-t&lt;n&gt;    Enable trace mode (&lt;n&gt; = level 1,2,3 or 4)
-d       Start the* debugger</pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>None of the above switches can be used unless the adventure was compiled with the debug option set (see <em>Options</em> on page <em>49</em>).</p>
</div>
</td>
</tr>
</table>
</div>
<div class="sect3">
<h4 id="truecommand-logs-and-game-transcripts"><a class="anchor" href="#truecommand-logs-and-game-transcripts"></a>Command Logs and Game Transcripts</h4>
<div class="paragraph">
<p>For various purposes, such as debugging, an actual log of the player commands can be handy. Such a log is created if the option <code>-c</code> is given to the interpreter when starting a game. The log files are created in the directory, which was current when the interpreter was started, the name of the log file will begin with the game name and have the extension <strong>.log</strong>.</p>
</div>
<div class="paragraph">
<p>A command log can on some systems be used as input to the interpreter, and thus automate the execution of the exact player experience.</p>
</div>
<div class="paragraph">
<p>You can only activate one of the logs in a single session.</p>
</div>
</div>
<div class="sect3">
<h4 id="trueinterpreter-and-instruction-trace"><a class="anchor" href="#trueinterpreter-and-instruction-trace"></a>Interpreter and Instruction Trace</h4>
<div class="paragraph">
<p>Trace mode can also act as an aid in debugging. Level 1 will print information about every invocation of the instruction interpreter, making it easier to see which parts of the code are being executed.</p>
</div>
<div class="paragraph">
<p>Trace level 2, single instruction trace, will also trace every single Acode instruction. The Acode is based on a stack machine but single instruction trace will not show all stack operations. Level 3 shows the execution of these also. Level 4 dumps the content of the stack for every instruction.</p>
</div>
</div>
<div class="sect3">
<h4 id="truedebug-mode"><a class="anchor" href="#truedebug-mode"></a>Debug mode</h4>
<div class="paragraph">
<p>Finally, and usually most useful, there is the debug mode. If the interpreter is started with this option, it will execute the start up sequence and then prompt for a debug command with</p>
</div>
<div class="paragraph">
<p>abug&gt;</p>
</div>
<div class="exampleblock gametranscript">
<div class="content">
<div class="paragraph">
<p>abug&gt;</p>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="trueusing-the-debugger"><a class="anchor" href="#trueusing-the-debugger"></a>Using the Debugger</h4>
<div class="paragraph">
<p>Abug may also be entered during the execution of an adventure. To do this you issue the single player command (type it at the game prompt)</p>
</div>
<div class="exampleblock gametranscript">
<div class="content">
<div class="paragraph">
<p>&gt; debug</p>
</div>
</div>
</div>
<div class="paragraph">
<p>The game must have been compiled with the debug option or the command will be sent to the game which probably does not recognize it.</p>
</div>
<div class="paragraph">
<p>Typing a question mark or &#8216;help&#8217; in response to the debug prompt will give a brief listing of the commands available in Abug:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>break [file:[n]]   -- set breakpoint at source line [n] in [file]
delete [file:[n]]  -- delete breakpoint at source line [n] in [file]
files              -- list source files
events             -- show events
classes            -- show class hierarchy
instances [n]      -- show instance(s)
objects [n]        -- show instance(s) that are objects
actors [n]         -- show instance(s) that are actors
locations [n]      -- show instances that are locations
trace ('source'|'section'|'instruction'|'push'|'stack')
                   -- toggle various traces
next               -- execute to next source line
go                 -- go another player turn
exit               -- exit debug mode and return to game, enter again using 'debug' as input
x                  -- d:o
quit               -- quit game</pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Any command may be abbreviated as long as it is unambiguous. Typing 'b' for 'break' will work, for example.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The display commands, <code>actors</code>, <code>locations</code>, <code>objects</code> and <code>events</code>, may optionally be followed by a number. Abug will then display detailed information about the entity requested, such as values of attributes, its present location etc. Currently there is no way to modify anything using Abug.</p>
</div>
<div class="paragraph">
<p>You can run the adventure to the next source line by using the <code>next</code> command. If the source file is available, the interpreter will also show the source line.</p>
</div>
<div class="paragraph">
<p>Breakpoints can be set on a source line. Enter the <code>break</code> command followed by the number of the source line. Alan allows the source to be separated into multiple files, so the interpreter always indicate which file the source line is in, e.g. when hitting a breakpoint or stepping to the next source line. When setting a breakpoint the current file is always assumed. You can currently set a breakpoint in another source file by preceding the line number with the file name delimited by a colon.</p>
</div>
<div class="paragraph">
<p>Breakpoints can be deleted. The <code>delete</code> command without a line number will remove any breakpoint at the current line. You can specify which breakpoint to delete by giving the line number (and optionally the file name).</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The debugger knows on which source lines it is possible to place a breakpoint. If you attempt to put a breakpoint at some line where it is not possible, it will attempt to place one a line which is numerically higher but as close a possible. This will sometimes cause a breakpoint to be placed in a context that will not be what you expected.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The trace command and its options corresponds to the types of traces described in the section on <em>Command Logs and Game Transcripts</em> <em>above</em>.</p>
</div>
<div class="paragraph">
<p>Wherever different output styles are available, e.g. in GLK based interpreters like WinArun, the Alan debugger tries to use them to distinguish the debugger output from the output of your game by using the pre-formatted style (see the section on styles in <em>Output Statements</em> on page <em>117</em>).</p>
</div>
<div class="paragraph">
<p>The following is a short excerpt from a debugging session (user input in italics, game input/output in bold face):</p>
</div>
<div class="literalblock">
<div class="content">
<pre>&lt;Arun, Adventure Interpreter version 3.0beta1 (2010-12-19 16:26:05)&gt;

&lt;Version of 'saviour.a3c' is 3.0beta1&gt;

&lt;Hmm, this is a little-endian machine, fixing byte ordering.... OK.&gt;

&lt;Hi! This is Alan interactive fiction interpreter Arun, version

3.0beta1 !&gt;

adbg&gt; _n_

adbg: Stepping to saviour.alan:1346

&lt;01346&gt;: "$pWelcome to the game of SAVIOUR!$pIn this game your mission

adbg&gt; _n_

Welcome to the game of SAVIOUR!

&lt;&lt;Game output deleted for breivity&gt;&gt;

adbg: Stepping to saviour.alan:1354

&lt;01354&gt;: Show 'logo.png'.

adbg&gt; _n_

adbg: Stepping to saviour.alan:1355

&lt;01355&gt;: "$iVisit the Alan Home Pages at:"

adbg&gt; _break 1357_

Line 1357 not available, breakpoint instead set at saviour.alan:1358

&lt;01358&gt;: Visits 2.

adbg&gt; _g_

Visit the Alan Home Pages at:

http://www.alanif.se

adbg: Breakpoint hit at saviour.alan:1358

&lt;01358&gt;: Visits 2.

adbg&gt; _n_

Outside The Tall Building

adbg: Stepping to saviour.alan:318

&lt;00318&gt;: "To the north is a tall ancient building with a large entrance.

adbg&gt; _n_

To the north is a tall ancient building with a large entrance. On the top there is a clock tower. Most of the windows in the building are broken, and a sign with three oval objects are hanging lose from the wall.

*&gt; _north_*

adbg: Stepping to saviour.alan:325

&lt;00325&gt;: Score 5.

adbg&gt; _?_

Alan 3.0beta1 -- Adventure Language System (2010-12-19 16:26)

ADBG Commands (can be abbreviated):

help -- this help

? -- d:o

break [file:[n]] -- set breakpoint at source line [n] in [file]

delete [file:[n]] -- delete breakpoint at source line [n] in [file]

files -- list source files

events -- show events

classes -- show class hierarchy

instances [n] -- show instance(s)

objects [n] -- show instance(s) that are objects

actors [n] -- show instance(s) that are actors

locations [n] -- show instances that are locations

trace ('source'|'section'|'instruction'|'push'|'stack')

-- toggle various traces

next -- execute to next source line

go -- go another player turn

exit -- exit to game, enter 'debug' to get back

x -- d:o

quit -- quit game

adbg&gt; _trace section_

Section trace on.

adbg&gt; _n_

&lt;EXIT north[1] from Outside The Tall Building[4], Moving:&gt;

&lt;ENTERED in class entity[1] is empty&gt;

&lt;ENTERED in class location[2] is empty&gt;

&lt;ENTERED in instance Hall[5] is empty&gt;

Hall

adbg: Stepping to saviour.alan:332

&lt;00332&gt;: "Inside the entrance is a hallway full of dust and pieces of

adbg&gt; _instances_

Instances:

1: #nowhere

2: pseudowords (container), at #nowhere [1]

3: nowhere

4: Outside The Tall Building

5: Hall

6: door, at Hall [5]

7: Stairs

8: cellar

9: rats, at cellar [8]

10: store

11: spool of computer tape, at store [10]

12: First Floor

13: old book, at First Floor [12]

&lt;&lt;list abbreviated&gt;&gt;

adbg&gt; _instance 13_

The old book [13] IsA object[4]

Location: at First Floor [12]

Attributes:

Takeable[2] = 1

Readable[3] = 1

openable[4] = 0

startable[5] = 0

examinable[6] = 1

adbg&gt; _g_

Inside the entrance is a hallway full of dust and pieces of the

ceiling has fallen to the floor. At the west end is a staircase, and to the south is the exit. To the east is a folding door. It is closed.

*&gt; _west_*

&lt;EXIT west[3] from Hall[5], Moving:&gt;

&lt;ENTERED in class entity[1] is empty&gt;

&lt;ENTERED in class location[2] is empty&gt;

&lt;ENTERED in instance Stairs[7] is empty&gt;

Stairs

You are at the landing of an old staircase. It seem steady enough to walk in, but be careful if you are going to use it. There is a passage leading up, and another leading down into a dark cellar. To the east is the hallway. A strange smell emerges from below.

*&gt; _up_*

&lt;EXIT up[5] from Stairs[7], Moving:&gt;

&lt;ENTERED in class entity[1] is empty&gt;

&lt;ENTERED in class location[2] is empty&gt;

&lt;ENTERED in instance First Floor[12] is empty&gt;

First Floor

The landing on the first floor is as dirty as all the others. Meters and meters of old cables are laying around, leading into a room to the east. The stairs leads up and down. They still seem alright. Through the dirty windows the barren field outside the building can be seen. Almost completely covered by dust, there is an old book laying on the floor here.

*&gt; _take book and read it_*

&lt;VERB 21, in parameter object(#1)=old book[13], inherited from object[4], CHECK:&gt;

&lt;VERB 21, in parameter object(#1)=old book[13], inherited from object[4], DOES:&gt;

Taken.

&lt;VERB 5, in parameter object(#1)=old book[13], inherited from object[4], CHECK:&gt;

&lt;VERB 5, in parameter object(#1)=old book[13], DOES:&gt;

As you carefully try to open the book it falls apart into dust and falls

to the floor through your fingers.

*&gt; _debug_*

adbg&gt; instance 13

The old book [13] IsA object[4]

Location: at nowhere [3]

Attributes:

Takeable[2] = 1

Readable[3] = 1

openable[4] = 0

startable[5] = 0

examinable[6] = 1

adbg&gt; _trace instruction_

Single instruction trace on.

adbg&gt; _n_

*&gt; _north_*

++++++++++++++++++++++++++++++++++++++++++++++++++

1dbd: PRINT 10037, 22 "You can't go that way."

1dbe: RETURN

--------------------------------------------------

*&gt; _west_*

++++++++++++++++++++++++++++++++++++++++++++++++++

1dbd: PRINT 10037, 22 "You can't go that way."

1dbe: RETURN

--------------------------------------------------

*&gt; _east_*

&lt;EXIT east[2] from First Floor[12], Moving:&gt;

&lt;ENTERED in class entity[1] is empty&gt;

&lt;ENTERED in class location[2] is empty&gt;

&lt;ENTERED in instance office[14] is empty&gt;

++++++++++++++++++++++++++++++++++++++++++++++++++

e82: LINE 0, 0

e85: PRINT 3479, 6 "Office"

e86: RETURN

--------------------------------------------------

++++++++++++++++++++++++++++++++++++++++++++++++++

e89: LINE 0, 598

adbg: Stepping to saviour.alan:598

&lt;00598&gt;: "In front of you is a deserted office area. Desks and chairs

adbg&gt; _g_

e8c: PRINT 3485, 404 "In front of you is a deserted office area. Desks and chairs are piled up in one corner. The ventilation system has partly fallen to the floor, tearing part of the ceiling down with it. Under the twisted tubing a couple of old coffee makers are crushed to pieces. One shelf, having some kind of lettering, no longer readable, is thrown to one side, and another is still standing in a corner, full of dust."

e8d: RETURN

--------------------------------------------------

++++++++++++++++++++++++++++++++++++++++++++++++++

ec3: LINE 0, 616

ec6: ATTRIBUTE 15, 17 =0

ec7: NOT FALSE =TRUE

ec8: IF TRUE

ecb: LINE 0, 617

ece: PRINT 3711, 43 " There is a ladder laying on the floor here."

ecf: ELSE

:

ee1: RETURN

--------------------------------------------------

*&gt; _look_*

&lt;VERB 19, GLOBAL, DOES:&gt;

++++++++++++++++++++++++++++++++++++++++++++++++++

71c: LINE 0, 199

71d: LOOK

++++++++++++++++++++++++++++++++++++++++++++++++++

e82: LINE 0, 0

e85: PRINT 3479, 6 "Office"

e86: RETURN

--------------------------------------------------

++++++++++++++++++++++++++++++++++++++++++++++++++

e89: LINE 0, 598

e8c: PRINT 3485, 404 "In front of you is a deserted office area. Desks and chairs are piled up in one corner. The ventilation system has partly fallen to the floor, tearing part of the ceiling down with it. Under the twisted tubing a couple of old coffee makers are crushed to pieces. One shelf, having some kind of lettering, no longer readable, is thrown to one side, and another is still standing in a corner, full of dust."

e8d: RETURN

--------------------------------------------------

++++++++++++++++++++++++++++++++++++++++++++++++++

ec3: LINE 0, 616

ec6: ATTRIBUTE 15, 17 =0

ec7: NOT FALSE =TRUE

ec8: IF TRUE

ecb: LINE 0, 617

ece: PRINT 3711, 43 " There is a ladder laying on the floor here."

ecf: ELSE

:

ee1: RETURN

--------------------------------------------------

71e: RETURN

--------------------------------------------------

*&gt; _q_*</pre>
</div>
</div>
<div class="paragraph">
<p>In the instruction trace, lines of &#8216;+&#8217; characters indicates the start of interpretation, thus they can be present inside other single step traces (like the <code>Look</code> in the example above). Lines of dashes, indicates the return from one such level of interpretation.</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="trueadventure-construction"><a class="anchor" href="#trueadventure-construction"></a>7. Adventure Construction</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This chapter will give a few clues on how to be a successful adventure author, because creating a <em>good</em> adventure is more like writing a book than writing a program (although Alan can be viewed as a kind of programming language).</p>
</div>
<div class="sect2">
<h3 id="truegetting-an-idea"><a class="anchor" href="#truegetting-an-idea"></a>7.1. Getting an Idea</h3>
<div class="paragraph">
<p>As with a book, the success or failure depends on how intriguing the story is, how hooked you can get the reader (in our case the player). Therefore, the first step <em>must</em> be to get a good idea. This may be hard or easy but with time, you, like any good author, learn to pick up ideas when you get them in ordinary every-day life, and store them for later use.</p>
</div>
<div class="paragraph">
<p>A seemingly simple idea might also be developed into a good adventure if it is placed in the correct setting and supplied with additional features, tricks and problems.</p>
</div>
<div class="paragraph">
<p>When you have a good idea, try to refrain from typing it in directly in a text editor and compile it with Alan. Instead, write the story down as if it were the story line for a book or a movie. Where appropriate, insert hints on various diversions and alternate paths that come to mind, but try to stay mainly with the main story from beginning to the preferred end. Then, let a close friend read it.</p>
</div>
</div>
<div class="sect2">
<h3 id="trueelaborating-the-story"><a class="anchor" href="#trueelaborating-the-story"></a>7.2. Elaborating the Story</h3>
<div class="paragraph">
<p>After having rewritten the story line once or twice, start creating the scenery. If your setting is small, you could draw a map of the locations needed, but a better way is probably to make a list of major locations first (those essential to the story). For each location note what important properties the location must have and which objects are necessary (just as notes, <em>don&#8217;t</em> create the Alan declarations yet!). For each object, make a small note on why the object is needed (by the player!).</p>
</div>
<div class="paragraph">
<p>This may also be done using a scene-by-scene approach. By this, we mean that the story is segmented into scenes (and maybe also acts) like in a play. For each act and scene, you do the above. This makes it easier to get an overview over a larger adventure.</p>
</div>
<div class="paragraph">
<p>I also suggest that you also create a story on a level above the actual game, at least in your own mind. This story should explain why the game-world exists and thus give a consistency to the text that you will present to the player. Nobody likes an adventure without a cause. This story or world of ideas need not be revealed to the player.</p>
</div>
<div class="paragraph">
<p>This also applies to the narrator, i.e. the imaginary person or creature that carries out the conversation with the player. Create an image of him or it and stick to it. Receiving comments about your (limited) progress in the game might be funny as long as they are not out of character.</p>
</div>
</div>
<div class="sect2">
<h3 id="trueimplementing-it"><a class="anchor" href="#trueimplementing-it"></a>7.3. Implementing it</h3>
<div class="paragraph">
<p>At last, it is time to sit down at the terminal. Divide the adventure text into files containing global verbs, the map (possibly divided further according to the scenes), the actors (perhaps one file for each actor) and a main file including the other files. This makes it easy to handle the adventure and you might ask your friend to participate in the development by giving him a few files to work with.</p>
</div>
<div class="paragraph">
<p>First, just declare the locations and connect them with exits. Do not work on the &#8220;purple prose&#8221; descriptions yet. The Alan system supplies good defaults for descriptions and so on so use these while developing the structure of the adventure. Do not bother even with the details of making it impossible to pick up the elephant, etc.</p>
</div>
<div class="paragraph">
<p>Play the adventure continuously during the development, but do not try the things you plan to make impossible later. Just go through it according to the line you planned the story to follow. A hint here is to use a separate file for the start section. In this file you can easily set up the situation you wish to test while not having to tire yourself by playing the adventure from the start every time.</p>
</div>
</div>
<div class="sect2">
<h3 id="truepolishing-the-adventure"><a class="anchor" href="#truepolishing-the-adventure"></a>7.4. Polishing the Adventure</h3>
<div class="paragraph">
<p>There, now you have a working adventure, it&#8217;s still a bit bare bones, but still the story plays the way you planned. Now it is time to insert all the nice descriptions, the limitations and perhaps the extra things to divert and hinder the hero. Just be careful not to fall into the locked-door-syndrome. Too many adventures have been tedious to play because you need to find-key/get-key/unlock-door- with-key/open-door (anyway, why do people go around locking doors and throwing away the keys). Think big.</p>
</div>
<div class="paragraph">
<p>Start by fixing the verbs so that they prohibit the impossible. Introduce as many synonyms as you can think of, this makes the adventure so much more playable.</p>
</div>
<div class="paragraph">
<p>Create the location descriptions. Remember to use the same style in all your descriptions; breaking out of style does not look good in the eyes of the adventurous. The descriptions must give the player the correct image, the brain is still the best graphic interface available, but they should also plant ideas in the player on how to solve the problems you place before him.</p>
</div>
<div class="paragraph">
<p>Another thing to aim for is the feeling that a player gets when he somehow finds information explaining things he has encountered earlier in the game. Here, as always, it is good advice to ask a friend to read the texts and convey his or her impressions (remember you know it all because you wrote it!).</p>
</div>
<div class="paragraph">
<p>Lastly, fill in the adjectives for the objects, their descriptions and short descriptions (if needed).</p>
</div>
</div>
<div class="sect2">
<h3 id="truebeta-testing"><a class="anchor" href="#truebeta-testing"></a>7.5. Beta Testing</h3>
<div class="paragraph">
<p>Now you might think that you can start distributing your game. But, wait! As any complex computer program, the game may have various kinds of bugs. Bugs in a work of interactive fiction range from misspellings and grammar errors in your descriptions, logic errors in your implementation of puzzles or events or omissions in the descriptions of surroundings that make the player miss or misunderstand how to act, to inconsistencies in the settings or story, plots that don&#8217;t work.</p>
</div>
<div class="paragraph">
<p>So how do you find these? Your only help are the beta testers. They are the people that you now should consider first a first trial beta release of your game. They should be people who you trust do give their honest opinion and really play it through to find any problems.</p>
</div>
<div class="paragraph">
<p>The beta testers will probably give you a long list of issues that you have to address before the next release. Some of the issues are simple; others may affect the basis of your story. You should seriously consider (and if possible discuss) such suggestions.</p>
</div>
<div class="paragraph">
<p>One aid in finding any problems in the playability of the game is to use the log file facility of the interpreter (see the section <em>Command Log</em> on page <em>187</em>) to produce a list of the commands a player have used. This can greatly aid in spotting troublesome areas in your game. One common such is where the player becomes stuck and reverts to "guess-the-verb". The log will give you the output of the exact game played.</p>
</div>
<div class="paragraph">
<p>After having collected all this information, considered which ones to act upon, and implemented these, you should probably do it once again (sigh!).</p>
</div>
<div class="paragraph">
<p>Now, at long last, your adventure game is ready to meet its audience.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="truehow-to-use-the-system"><a class="anchor" href="#truehow-to-use-the-system"></a>Appendix A: How To Use The System</h2>
<div class="sectionbody">
<div class="paragraph">
<p>How to actually set up and use the complete Alan system depends very much on which platform, OS and in which environment you are going to use it.</p>
</div>
<div class="paragraph">
<p>If you just want to run a game, there is of course the original command line version distributed from <a href="http://www.alanif.se/"><em>http://www.alanif.se</em></a>. To use this, read the relevant sections below to get a feel for how that will work.</p>
</div>
<div class="paragraph">
<p>But there are also a number of other packages that include an Alan interpreter, Gargoyle and Spatterlight, are two, with Gargoyle at the point of writing, being the one most up to date, and also available on multiple platforms.</p>
</div>
<div class="paragraph">
<p>If you actually want to write Interactive Fiction using Alan you also need the compiler. This is distributed from <a href="http://www.alanif.se/"><em>http://www.alanif.se</em></a> in what&#8217;s called the complete packages, including compiler, interpreter, the documentation, a conversion program for v2 games and some examples.</p>
</div>
<div class="paragraph">
<p>Whatever option you choose, there should be more detailed instructions on how to install included with that package. Below follows some information pertaining to the original versions from the Alan website.</p>
</div>
<div class="olist upperalpha">
<ol class="upperalpha" type="A">
<li>
<p>Compiling</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Although there are other options, like a prototype AlanIDE, WinAlan et al., basic use of the Alan Adventure Development System is through a traditional command line batch compiler. This means that the actual development system is a compiler that reads text files created using any standard text editor. To compile an adventure use the following command in a command shell:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>alan &lt;adventure&gt;</pre>
</div>
</div>
<div class="paragraph">
<p>where <code>&lt;adventure&gt;</code> is the name of the main file containing your adventure source text. The compiler will assume an extension of <strong>&#8220;.alan&#8221;</strong> if none is supplied. The option <code>-help</code> will give a brief help on other options to the compiler.</p>
</div>
<div class="paragraph">
<p>The primary output from the compiler is an adventure code file <strong><em>adventure</em>.a3c</strong>.</p>
</div>
<div class="paragraph">
<p>An identifying file, <strong><em>adventure</em>.ifid</strong>, is also produced. This file contains a unique identification of your game for bibliographical purposes. The content of it will be compiled into the adventure code file, which makes your game identifiable by electronic means. As long as this file exist the same identification (IFID) will be used. If it does not exist, a new one will automatically be generated.</p>
</div>
<div class="olist upperalpha">
<ol class="upperalpha" type="A">
<li>
<p>Compiler Switches</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>If you run the compiler from a command line you can get information about which switches it supports using the <code>-help</code> switch.</p>
</div>
<div class="paragraph">
<p>alan -help</p>
</div>
<div class="paragraph">
<p>Here are some examples of other switches:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>-charset</code> select the character set of the input files. This can be handy when you get a source file written on another platform, or for Windows where you edit in a Windows editor (ISO characters) and use the compiler in a DOS window (DOS characters). The option should be followed with one of the keywords <code>iso</code>, <code>mac</code> or <code>dos</code></p>
</li>
<li>
<p><code>-verbose</code> print compiler version and other verbose messages</p>
</li>
<li>
<p><code>-warnings</code>, <code>-infos</code> show warning (and/or informational) messages from the compilation process</p>
</li>
<li>
<p><code>-import</code> add a directory to the search path for imported files (see <em>File</em> <em>157</em> for details on the <code>import</code> statement). This switch can be used multiple times, each adding a new directory</p>
</li>
<li>
<p><code>-listing</code> direct compiler output (error messages etc.) to a file with the same base name as the input (source) file, but with the extension <strong>.lis</strong></p>
</li>
<li>
<p><code>-full</code> will produce a complete listing of the source on the screen, or if combined with the <code>-listing</code> option, in the listing file</p>
</li>
<li>
<p><code>-debug</code> include debugging information in the produced adventure files (same as the debug option, see <em>Options</em> on page <em>49</em>)</p>
</li>
<li>
<p><code>-pack</code> encode and compress the text data (same as the pack option, see <em>Options</em> on page <em>49</em>)</p>
</li>
<li>
<p><code>-summary</code> produce a summary about number of actors, size of adventure files, timing information etc.</p>
</li>
<li>
<p><code>-dump</code> print the internal form (developers use mainly)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Giving an extra hyphen before the option reverses its meaning (where appropriate), e.g. <code>--warnings</code> means don&#8217;t show warnings. Switches may be abbreviated as long as they are unambiguous.</p>
</div>
<div class="olist upperalpha">
<ol class="upperalpha" type="A">
<li>
<p>Running the Adventure</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>To play the generated adventure the Alan interpreter, <strong>arun</strong>, is executed with the adventure name as a parameter. For example</p>
</div>
<div class="paragraph">
<p>$ arun adventure</p>
</div>
<div class="paragraph">
<p>No extension on the adventure name is allowed, the <strong>.a3c</strong> and, if applicable, <strong>.a3r</strong> files are found automatically from that name.</p>
</div>
<div class="paragraph">
<p>On platforms with graphical user interfaces to which <strong>arun</strong> has been natively ported will allow double clicking a game file to start a game, or double clicking the interpreter application icon, in which case a dialogue requesting a game will appear.</p>
</div>
<div class="paragraph">
<p>If the interpreter program is copied to a different name, it will automatically look for a game file with the same name. Any parameters or switches will be ignored. For example, by copying the <strong>arun</strong> program to <strong>adventure</strong> the interpreter will, when started under the new name, directly look for the file <strong>adventure.a3c</strong>. The files <strong>adventure</strong> and <strong>adventure.a3c</strong> thus makes a complete game package, which is easy to start using the single command:</p>
</div>
<div class="paragraph">
<p>$ adventure</p>
</div>
<div class="olist upperalpha">
<ol class="upperalpha" type="A">
<li>
<p>Interpreter Switches</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>The interpreter supports the following switches:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>-v</code> print the version of the interpreter</p>
</li>
<li>
<p><code>-d</code> print the version of interpreter and enter debug mode</p>
</li>
<li>
<p><code>-i</code> ignore CRC and version errors in the adventure files</p>
</li>
<li>
<p><code>-t[&lt;n&gt;]</code> various levels of execution trace, higher &lt;n&gt; gives more details</p>
</li>
<li>
<p><code>-l</code> log all player command in a log-file in the current directory</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Debugging support is described in <em>Debugging</em> on page <em>187</em>.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="truea-sample-interaction"><a class="anchor" href="#truea-sample-interaction"></a>Appendix B: A Sample Interaction</h2>
<div class="sectionbody">
<div class="paragraph">
<p>In order to give you an idea of what playing an adventure might be like, if you do not have done that, this appendix lists a typical, and authentic, interaction between a player and a game. Player input is preceded by a prompt (&#8216;&gt;&#8217;) and is emphasised for clarity.</p>
</div>
<div class="paragraph">
<p>In reading this through, you will find that it is possible to use more or less full imperative statements to communicate with the game. However, you may leave out non-important words and the game usually provides a set of common abbreviations, such as &#8216;w&#8217; for &#8216;west&#8217;, which really means &#8216;go west&#8217;.</p>
</div>
<div class="paragraph">
<p>It is also common to provide possibility to refer to multiple objects in a command, either by use of &#8216;all&#8217; or specifically listing the objects.</p>
</div>
<div class="paragraph">
<p>Your input is in italics.</p>
</div>
<div class="exampleblock gametranscript">
<div class="content">
<div class="paragraph">
<p><strong>West of House.</strong><br>
Welcome to Dungeon (ALAN Demo). This version created 29-FEB-92.</p>
</div>
<div class="paragraph">
<p>You are in an open field west of a big white house with a boarded front door. There is a small mailbox here.</p>
</div>
<div class="paragraph">
<p>&gt; <em>examine the mailbox</em></p>
</div>
<div class="paragraph">
<p>I see nothing special about the mailbox.</p>
</div>
<div class="paragraph">
<p>&gt; <em>open it</em></p>
</div>
<div class="paragraph">
<p>The small mailbox is now open. The small mailbox contains a leaflet.</p>
</div>
<div class="paragraph">
<p>&gt; <em>take the leaflet and read it</em></p>
</div>
<div class="paragraph">
<p>Taken!</p>
</div>
<div class="paragraph">
<p>'I hope you have noticed that this isn&#8217;t your usual Dungeon but rather an ALAN implementation brought to you by</p>
</div>
<div class="paragraph">
<p>ThoNi &amp; GorFo Adventure Factories</p>
</div>
<div class="paragraph">
<p>Happy Adventuring!'</p>
</div>
<div class="paragraph">
<p>&gt; <em>inventory</em></p>
</div>
<div class="paragraph">
<p>You are carrying a leaflet.</p>
</div>
<div class="paragraph">
<p>&gt; <em>go south</em></p>
</div>
<div class="paragraph">
<p><strong>South of House.</strong><br>
You are facing the south side of a white house. There is no door here, and all the windows are barred.</p>
</div>
<div class="paragraph">
<p>&gt; <em>east</em></p>
</div>
<div class="paragraph">
<p><strong>Behind House.</strong><br>
You are behind the white house. In one corner of the house there is a window which is slightly ajar.</p>
</div>
<div class="paragraph">
<p>&gt; <em>open the window</em></p>
</div>
<div class="paragraph">
<p>With great effort, you open the window far enough to allow passage.</p>
</div>
<div class="paragraph">
<p>&gt; <em>go in</em></p>
</div>
<div class="paragraph">
<p><strong>Kitchen.</strong><br>
You are in the kitchen of the white house. A table seems to have been used recently for the preparation of food. On the table you can see an elongated brown sack, smelling of hot peppers and a clear glass bottle. A passage leads to the west, and a dark staircase can be seen leading upward. To the east is a small window which is open.</p>
</div>
<div class="paragraph">
<p>&gt; <em>examine all</em></p>
</div>
<div class="paragraph">
<p>You can&#8217;t refer to multiple objects with 'examine'.</p>
</div>
<div class="paragraph">
<p>&gt; <em>take all</em></p>
</div>
<div class="paragraph">
<p>(elongated brown sack, smelling of hot peppers) Taken!</p>
</div>
<div class="paragraph">
<p>(clear glass bottle) Taken!</p>
</div>
<div class="paragraph">
<p>&gt; <em>up</em></p>
</div>
<div class="paragraph">
<p><strong>Upstairs.</strong><br>
You are in the attic. The only exit is stairs that lead down. A large coil of rope is lying in the corner. There is a square brick here which feels like clay. A nasty-looking knife is lying here.</p>
</div>
<div class="paragraph">
<p>&gt; <em>take all</em></p>
</div>
<div class="paragraph">
<p>(rope) Taken!</p>
</div>
<div class="paragraph">
<p>(square clay brick) Taken!</p>
</div>
<div class="paragraph">
<p>(nasty knife) Taken!</p>
</div>
<div class="paragraph">
<p>&gt; <em>examine knife</em></p>
</div>
<div class="paragraph">
<p>I see nothing special about the knife.</p>
</div>
<div class="paragraph">
<p>&gt; <em>down</em></p>
</div>
<div class="paragraph">
<p><strong>Kitchen (again)</strong><br>
A table seems to have been used recently for the preparation of food. The table is empty. To the east is a small window which is open.</p>
</div>
<div class="paragraph">
<p>&gt; <em>w</em></p>
</div>
<div class="paragraph">
<p><strong>Living room.</strong><br>
You are in the living room. There is a door to the east. To the west is a wooden door with strange gothic lettering, which appears to be nailed shut. There is a trophy case here. In the center of the room is a large oriental rug.</p>
</div>
<div class="paragraph">
<p>On hooks above the mantlepiece hangs an elvish sword of great antiquity. A battery-powered brass lantern is on the trophy case. There is an issue of US NEWS &amp; DUNGEON REPORT dated 29-FEB-92 here.</p>
</div>
<div class="paragraph">
<p>&gt; <em>move rug</em></p>
</div>
<div class="paragraph">
<p>With a great effort, the rug is moved to one side of the room. With the rug moved, the dusty cover of a closed trap door appears.</p>
</div>
<div class="paragraph">
<p>&gt; <em>open door</em></p>
</div>
<div class="paragraph">
<p>I don&#8217;t know which door you mean.</p>
</div>
<div class="paragraph">
<p>&gt; <em>open trap door</em></p>
</div>
<div class="paragraph">
<p>The door reluctantly opens to reveal a rickety staircase descending into darkness.</p>
</div>
<div class="paragraph">
<p>&gt; <em>take the sword, the lantern and the issue</em></p>
</div>
<div class="paragraph">
<p>(rug) The rug is extremely heavy and cannot be carried.</p>
</div>
<div class="paragraph">
<p>(elvish sword) Taken!</p>
</div>
<div class="paragraph">
<p>(battery brass lantern) Taken!</p>
</div>
<div class="paragraph">
<p>(issue) Taken!</p>
</div>
<div class="paragraph">
<p>&gt; <em>read issue</em></p>
</div>
<div class="paragraph">
<p>US NEWS &amp; DUNGEON REPORT</p>
</div>
<div class="paragraph">
<p>29-FEB-92&#8230;&#8203;&#8230;&#8203;&#8230;&#8203;&#8230;&#8203;&#8230;&#8203;&#8230;&#8203;&#8230;&#8203;&#8230;&#8203;&#8230;&#8203;&#8230;&#8203;..Late Dungeon Edition</p>
</div>
<div class="paragraph">
<p>--- LATE NEWS FLASH!! ---</p>
</div>
<div class="paragraph">
<p>The Dungeon prelude is now available as an ALAN implementation. The Dungeon game was selected as an example that everybody interested in adventure gaming should recognize.</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="truerun-time-messages"><a class="anchor" href="#truerun-time-messages"></a>Appendix C: Run-time Messages</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This appendix describes the errors that may occur during the running of the adventure, i.e. during interpretation of the generated Acode. There are two classes of errors, player input response messages and system errors.</p>
</div>
<div class="paragraph">
<p>Input response errors are not fatal but abort the execution of the current player command and discard the rest of the user input, which is a normal part of the interaction between the player and the Alan run-time system. System errors <em>are</em> fatal and abort the execution of the adventure.</p>
</div>
<div class="olist upperalpha">
<ol class="upperalpha" type="A">
<li>
<p>Input Response Messages</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Various messages are printed for the benefit of the player. Most messages probably come from the adventure itself, i.e. they where provided by the adventure author. However, some messages can be given directly by the Arun interpreter. They are presented below using the Alan STRING-format, i.e. containing the special character combinations described in <em>Output Statements</em> on page <em>117</em>. These standard messages exist for all languages and the default value of the texts are selected depending upon the setting of the language option.</p>
</div>
<div class="paragraph">
<p>The contents of any message may be modified using the <code>Message</code> statement (see section <em>Messages</em> on page <em>113</em>). The identifier on the first line of a message explanation is the identifier that should be used in the <code>Message</code> statement to change the contents of that message. The text after the colon on the first line is the default English message text. Then follows a short explanation, including possible availability of parameters and their types.</p>
</div>
<div class="paragraph">
<p>All messages are available in all supported languages but below the English texts are shown.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Although the default values of the messages are static strings, it is possible to create messages that are more dynamic. The <code>Message</code> statement allows any statements, not only strings, and supplies dynamic values as parameters for many messages. See <em>Messages</em> on page <em>113</em> for details.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>UNKNOWN_WORD : "I don&#8217;t know the word '$1'."</p>
</div>
<div class="paragraph">
<p>A word not in the dictionary was used by the player.</p>
</div>
<div class="paragraph">
<p><strong>parameter1</strong> is a string containing the word used.</p>
</div>
<div class="paragraph">
<p>WHAT : "I don&#8217;t understand."</p>
</div>
<div class="paragraph">
<p>The input did not follow any syntax the Arun parser knows about. I.e. the input could not be matched to any of the defined syntaxes.</p>
</div>
<div class="paragraph">
<p>WHAT_WORD : "I don&#8217;t know what you mean by '$1'."</p>
</div>
<div class="paragraph">
<p>The player input a multiple word, such as &#8220;all&#8221;, &#8220;them&#8221; or a pronoun, but the Arun parser could not find any objects or actors that it could refer to.</p>
</div>
<div class="paragraph">
<p><strong>parameter1</strong> is a string which is the word used by the player.</p>
</div>
<div class="paragraph">
<p>MULTIPLE : "You can&#8217;t refer to multiple objects with '$v'."</p>
</div>
<div class="paragraph">
<p>The syntax matched for the indicated verb did not allow multiple parameters.</p>
</div>
<div class="paragraph">
<p>NOUN : "You must supply a noun."</p>
</div>
<div class="paragraph">
<p>The player started to specify an object or actor but only supplied the adjectives.</p>
</div>
<div class="paragraph">
<p>AFTER_BUT : "You must give at least one object after '$1'."</p>
</div>
<div class="paragraph">
<p>In a command containing <strong>ALL BUT</strong>, the player must also give the object or objects excluded.</p>
</div>
<div class="paragraph">
<p><strong>parameter1</strong> is a string containing the <strong>BUT</strong>-word the player used.</p>
</div>
<div class="paragraph">
<p>BUT_ALL : "You can only use '$1' after '$2'."</p>
</div>
<div class="paragraph">
<p>The <strong>BUT</strong>-words may only be used after an <strong>ALL</strong>-word.</p>
</div>
<div class="paragraph">
<p><strong>parameter1</strong> is a string containing the <strong>BUT</strong>-word used by the player.</p>
</div>
<div class="paragraph">
<p><strong>parameter2</strong> is a string containing the <strong>ALL</strong>-word used by the player.</p>
</div>
<div class="paragraph">
<p>NOT_MUCH : "That doesn&#8217;t leave much to $v!"</p>
</div>
<div class="paragraph">
<p>The player used an <strong>ALL BUT</strong> construct, which explicitly excluded everything matched by the <strong>ALL</strong>.</p>
</div>
<div class="paragraph">
<p>WHICH_START : "I don&#8217;t know if you mean $+1"<br>
WHICH_COMMA : ", $+1"<br>
WHICH_OR : "or $+1."</p>
</div>
<div class="paragraph">
<p>Multiple objects (or actors) matched the words given by the player. More adjectives are necessary to distinguish between them. The three messages are used to list the possibilities. The player can repeat the command with a more precise wording. The first message is used for the first alternative, the last for the last alternative and the middle for all the middle alternatives.</p>
</div>
<div class="paragraph">
<p>For each message, <strong>parameter1</strong> is a reference to the alternative instance.</p>
</div>
<div class="paragraph">
<p>WHICH_PRONOUN_START : "I don&#8217;t know if you by '$1'"<br>
WHICH_PRONOUN_FIRST : "mean $+1"</p>
</div>
<div class="paragraph">
<p>When a pronoun given in a command matched multiple parameter in the previous command, these messages are issued to explain this and which the alternatives where. Note that the message is different from the multiple match above only for the start of the message, the list of alternatives are the same, i.e. WHICH_COMMA (repeated) and WHICH_OR (the final).</p>
</div>
<div class="paragraph">
<p>NO_SUCH : "I can&#8217;t see any $1 here."</p>
</div>
<div class="paragraph">
<p>The player referred to an object or actor that was not present.</p>
</div>
<div class="paragraph">
<p><strong>parameter1</strong> is an instance referring to an instance.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>If there did not actually even exist an instance in the game with the combination of the adjectives and nouns that the player used, the interpreter uses any instance matching the noun. This still allows inflecting in accordance with the noun case, which is common in many languages (English being one of few exceptions).</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>NO_WAY : "You can&#8217;t go that way."</p>
</div>
<div class="paragraph">
<p>A directional word was used but there is no exit in that direction.</p>
</div>
<div class="paragraph">
<p>CANT0 : "You can&#8217;t do that.",</p>
</div>
<div class="paragraph">
<p>The interpreter could match the input to some syntax, but did not find any verb body to execute. This may be a situation overlooked by the author or the player may be trying to do something that is not possible.</p>
</div>
<div class="paragraph">
<p>SEE_START : "There is $01"<br>
SEE_COMMA : ", $01"<br>
SEE_AND : "and $01"<br>
SEE_END : "here. "</p>
</div>
<div class="paragraph">
<p>These messages are used to construct the default text for describing <code>thing</code>s present at the current location that have no description clause. The message parts are used as in "<em>There is &lt;indefinite form</em> <em>object1&gt;, &lt;indefinite form object2&gt; and &lt;indefinite form object3&gt; here</em>." The underlined parts are the ones in the messages and each object is printed in its indefinite form as appropriate.</p>
</div>
<div class="paragraph">
<p>CONTAINS : "$+1 contains"<br>
CARRIES : "$+1 carries"</p>
</div>
<div class="paragraph">
<p>The messages above are used to construct the default headers for listing containers. The CARRIES message is used if the container instance is an <code>actor</code>.</p>
</div>
<div class="paragraph">
<p>CONTAINS_COMMA : "$01,"<br>
CONTAINS_AND : "$01 and"<br>
CONTAINS_END : "$01."</p>
</div>
<div class="paragraph">
<p>The messages above are used to construct the contents listing of a container in much the same way as for the object listing above. The messages are used according to the pattern "<em>&lt;header for</em> <em>container&gt; contains &lt;indefinite form</em> <em>contents1&gt;, &lt;</em> <em>indefinite form contents2&gt; and &lt;</em> <em>indefinite form contents3&gt;.</em>"</p>
</div>
<div class="paragraph">
<p>You can modify these messages to change the formatting of listings. e.g. to one element per line.</p>
</div>
<div class="paragraph">
<p>CAN_NOT_CONTAIN : "$+1 can not contain $+2."</p>
</div>
<div class="paragraph">
<p>If an attempt to put something in a container that does not meet the class restrictions for the container, this message will be delivered.</p>
</div>
<div class="paragraph">
<p>IS_EMPTY : "$+1 is empty."</p>
</div>
<div class="paragraph">
<p>The default messages for empty containers.</p>
</div>
<div class="paragraph">
<p>EMPTY_HANDED : "$+1 is empty-handed."</p>
</div>
<div class="paragraph">
<p>The default messages for empty containers that are <code>actor</code>s.</p>
</div>
<div class="paragraph">
<p>HAVE_SCORED : "You have scored $1 points out of $2."</p>
</div>
<div class="paragraph">
<p>This is the default message for presenting scores, if you use the <code>Score</code> statement.</p>
</div>
<div class="paragraph">
<p><strong>parameter1</strong> is an integer containing the current score.</p>
</div>
<div class="paragraph">
<p><strong>parameter2</strong> is an integer containing the maximum score possible.</p>
</div>
<div class="paragraph">
<p>MORE : "&lt;More&gt;"</p>
</div>
<div class="paragraph">
<p>The classic message when the screen is full. The player should press <kbd>RETURN</kbd> to proceed.</p>
</div>
<div class="paragraph">
<p>AGAIN : "(again)"</p>
</div>
<div class="paragraph">
<p>This message is presented immediately after the location name if the location has been visited before to give the player the information that he has visited this location before (a good thing in some adventures). If you wish to disable this, set this message to an empty string.</p>
</div>
<div class="paragraph">
<p>SAVE_WHERE : "Enter file name to save in"</p>
</div>
<div class="paragraph">
<p>When executing a <code>Save</code> the player can enter the name of the file to save in. The name used in the previous <code>Save</code> is used as a default.</p>
</div>
<div class="paragraph">
<p>SAVE_OVERWRITE : "That file already exists, overwrite (y) ? "</p>
</div>
<div class="paragraph">
<p>If the save file already existed the player must confirm overwriting.</p>
</div>
<div class="paragraph">
<p>SAVE_FAILED : "Sorry, save failed."</p>
</div>
<div class="paragraph">
<p>When executing a <code>Save</code>, the file system indicated some error, usually a write protected directory or full disks.</p>
</div>
<div class="paragraph">
<p>RESTORE_FROM : "Enter file name to restore from"</p>
</div>
<div class="paragraph">
<p>A <code>Restore</code> statement can restore from any named file. The previously used file name is used as the default.</p>
</div>
<div class="paragraph">
<p>SAVE_MISSING : "Sorry, could not open the save file."</p>
</div>
<div class="paragraph">
<p>When executing a <code>Restore</code>, Arun could not find, or open, a save file with the name entered.</p>
</div>
<div class="paragraph">
<p>NOT_A_SAVEFILE :"That file does not seem to be an Alan game save file."</p>
</div>
<div class="paragraph">
<p>The save file found by the <code>Restore</code> statement was not Alan game save file.</p>
</div>
<div class="paragraph">
<p>SAVE_VERSION : "Sorry, the save file was created by a different version."</p>
</div>
<div class="paragraph">
<p>The save file found by the <code>Restore</code> statement was created by a different version of the Alan interpreter or the game.</p>
</div>
<div class="paragraph">
<p>SAVE_NAME : "Sorry, the save file did not contain a save for this adventure."</p>
</div>
<div class="paragraph">
<p>The indicated save file did not contain a save of this adventure.</p>
</div>
<div class="paragraph">
<p>REALLY : "Are you sure (RETURN confirms) ? "</p>
</div>
<div class="paragraph">
<p>This is the confirmation prompt, e.g. before overwriting an already existing save file.</p>
</div>
<div class="paragraph">
<p>QUIT_ACTION : "Do you want to RESTART, RESTORE, QUIT or UNDO?"</p>
</div>
<div class="paragraph">
<p>The <code>Quit</code> statement requests an action from the player.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The possible answers are currently hard-wired into the interpreter, so changing <code>RESTART</code>, <code>RESTORE</code>, <code>QUIT</code> or <code>UNDO</code> will probably confuse the player!</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>UNDONE : "'$1' undone."</p>
</div>
<div class="paragraph">
<p>When an action is undone, this message is presented to confirm the player action.</p>
</div>
<div class="paragraph">
<p><strong>parameter1</strong> is a string containing the player command that was undone. Note that since only commands that change any state in the game world are logged the command might very well not be the last command.</p>
</div>
<div class="paragraph">
<p>NO_UNDO : "No further undo available."</p>
</div>
<div class="paragraph">
<p>If the player tries to undo an action and no further actions where recorded (because of lack of memory, undone to beginning of session, etc.) this message is used to inform the player of that fact.</p>
</div>
<div class="paragraph">
<p>WHICH_PRONOUN_START : "I don&#8217;t know if you by '$1'<br>
WHICH_PRONOUN_FIRST : "mean $+1"</p>
</div>
<div class="paragraph">
<p>These messages are presented when the play used a pronoun which was ambiguous. The alternatives are listed using the <code>WHICH_PRONOUN_FIRST</code> followed by the message(s) <code>WHICH_ONE_COMMA</code> (if there were more than two alternatives), and finally by <code>WHICH_ONE_OR</code>.</p>
</div>
<div class="paragraph">
<p>IMPOSSIBLE_WITH : "That&#8217;s impossible with $+1."</p>
</div>
<div class="paragraph">
<p>If a player action is impossible with a particular parameter combination, but might be possible otherwise, this message is shown to indicate that it is the action <em>with the parameter</em> that is impossible.</p>
</div>
<div class="paragraph">
<p>CONTAINMENT_LOOP : "Putting $+1 in itself is impossible."</p>
</div>
<div class="paragraph">
<p>The interpreter detected an attempt to locate an instance inside (contained) itself. This message reliefs the author from the responsiblility to check for every possible circumstance where this might happen.</p>
</div>
<div class="paragraph">
<p>CONTAINMENT_LOOP2 : "Putting $+1 in $+2 is impossible since $+2 already is inside $+1."</p>
</div>
<div class="paragraph">
<p>Same as above but in this case the containment was transitive, i.e. it would create a containment loop with more that one instance involved.</p>
</div>
<div class="olist upperalpha">
<ol class="upperalpha" type="A">
<li>
<p>System Errors</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>System errors are errors caused by internal malfunctions. Mainly these are implementation errors (aka. bugs!), but may (in some manner) also result from user errors. The system error messages also have a purple prose style to fit in with your game, e.g.:</p>
</div>
<div class="paragraph">
<p>As you enter the twilight zone of Adventures, you stumble and fall to your knees. In front of you, you can vaguely see the outlines of an Adventure that never was.<br>
<br>
SYSTEM ERROR: Can&#8217;t open adventure code file.</p>
</div>
<div class="sect2">
<h3 id="trueplayer-errors"><a class="anchor" href="#trueplayer-errors"></a>C.1. Player Errors</h3>
<div class="paragraph">
<p>These errors are usually caused by incorrect arguments or file names entered by the player.</p>
</div>
<div class="paragraph">
<p>Can&#8217;t open adventure code file.</p>
</div>
<div class="paragraph">
<p>The player attempted to run an adventure for which there were no code file available, probably a misspelling.</p>
</div>
<div class="paragraph">
<p>Could not read all A3C code.<br>
Checksum error in Acode (.A3C) file (%1 instead of %2).</p>
</div>
<div class="paragraph">
<p>These two messages indicate problems in the adventure file. Possibly caused by transfer problems of the <strong>.a3c</strong> file.</p>
</div>
</div>
<div class="sect2">
<h3 id="trueauthor-errors"><a class="anchor" href="#trueauthor-errors"></a>C.2. Author Errors</h3>
<div class="paragraph">
<p>The following system errors are in some sense caused by the Adventure author (you).</p>
</div>
<div class="paragraph">
<p>Out of memory.</p>
</div>
<div class="paragraph">
<p>The adventure was so large that the interpreter could not allocate enough dynamic memory for it. Try to finish other running applications (does not work or is not possible on all systems), get more real memory, or complain to the Alan implementors. This might also be caused by reading incomplete or corrupted game files.</p>
</div>
<div class="paragraph">
<p>Incompatible version of ACODE program.</p>
</div>
<div class="paragraph">
<p>The version of the interpreter you are using is different than the Alan compiler used to compile the adventure. Use a different Arun or recompile the adventure with the matching compiler.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>the Arun switch <code>-d</code> will, beside entering debug mode, also print the version of both the Arun interpreter and the version of the Alan compiler used to compile the adventure.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Index not in container in 'containerMember()'</p>
</div>
<div class="paragraph">
<p>This is most likely caused by doing Random In on an empty container.</p>
</div>
<div class="paragraph">
<p>Recursive LOOK.</p>
</div>
<div class="paragraph">
<p>This message is shown when a <code>LOOK</code> statement is executed as a result of a <code>LOOK</code>! The <code>LOOK</code> statement should only be used in verb bodies. It should <em>not</em> be used in descriptions of instances because there is a definite risk that it will be executed as the effect of a <code>LOOK</code>, either explicit or implicit (by the hero entering a location which would trigger a <code>LOOK</code> in itself thus starting the recursion!).</p>
</div>
<div class="paragraph">
<p>Locating a location that would create a recursive loop of locations containing each other.</p>
</div>
<div class="paragraph">
<p>This means that an attempt to locate a location inside itself has been made. Probably in an attempt to dynamically manipulate the location structure (the map).</p>
</div>
<div class="paragraph">
<p>Non-existing parameter referenced.</p>
</div>
<div class="paragraph">
<p>A parameter that wasn&#8217;t available was referenced. This is probably due to using a parameter shorthand such as $2 inside a string in a context where the syntax was restricted to only one parameter. This may avoided by using the <code>Say</code> statement instead of the embedded string parameter references, which would allow compile time checking, thus avoiding the risk of having this happen to the player.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Parameter references embedded in strings are currently <em>not</em> checked during compile time.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Interpreter recursion.</p>
</div>
<div class="paragraph">
<p>The interpreter keeps track of its execution so that it can never enter an endless loop. There are a few situations where this can occur. One example is if the description of an instance in some way, directly or indirectly, executes <code>Describe This</code>. As the interpreter is already executing a description of the current instance the invocation of the second will create a loop that never terminates.</p>
</div>
</div>
<div class="sect2">
<h3 id="trueimplementor-errors"><a class="anchor" href="#trueimplementor-errors"></a>C.3. Implementor Errors</h3>
<div class="paragraph">
<p>Any other text in a system error message is really a SYSTEM ERROR. Scribble down the text and contact the implementors. If possible, supply the source for your adventure, a trace of the few last player commands (if possible with single step and trace turned on, see <em>Debugging</em> on page <em>187</em>).</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="truelanguage-grammar"><a class="anchor" href="#truelanguage-grammar"></a>Appendix D: Language Grammar</h2>
<div class="sectionbody">
<div class="olist upperalpha">
<ol class="upperalpha" type="A">
<li>
<p>Description</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>The Alan language is in this manual defined using a BNF-form, which you can see in most descriptions. The grammar is a set of rules defining what constructs are legal in the source for an Alan program. Below follows a brief explanation on how to interpret these rules by using some short examples. For details on the actual rules, refer to the content of chapter <em>3</em>, <em>Language Reference</em>.</p>
</div>
<div class="paragraph">
<p>The BNF form divides the rules for structure of the input source by describing it in smaller parts, which may in turn be defined by other rules. For example, a rule might say that an <strong>ADVENTURE</strong> (in this case an Alan program) consists of options, declarations and a start section. This grammar rule would look like:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ebnf" data-lang="ebnf">adventure = [options] {declaration} start_section</code></pre>
</div>
</div>
<div class="paragraph">
<p>Each item that is an identifier (<code>options</code>, <code>declaration</code> etc.), is a construct that in turn is defined by other rules, possibly elsewhere in the manual.</p>
</div>
<div class="paragraph">
<p>The equal sign (<code>=</code>) may be read as &#8220;consists of&#8221; or &#8220;is defined as&#8221;. Optional parts are surrounded by square brackets (<code>[</code> and <code>]</code>). Parts that may be repeated are enclosed in curly braces (<code>{</code> and <code>}</code>).</p>
</div>
<div class="literalblock">
<div class="content">
<pre>== : 'is defined as'

[] : 'optional'

{} : 'zero or more times'</pre>
</div>
</div>
<div class="paragraph">
<p>So the rule might be read as &#8220;an adventure consists of <code>options</code> which are optional, zero or more <strong>declarations</strong> and a <code>`start_section</code>&#8221;.</p>
</div>
<div class="paragraph">
<p>If the item to the left of the equal sign may be defined in multiple ways, the alternatives are divided by a vertical bar (<code>|</code>). For example</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-alan" data-lang="alan">declaration = messages
            | class
            | instance
            | verb
            | rule
            | synonyms
            | syntax
            | verb
            | event
            | addition</code></pre>
</div>
</div>
<div class="paragraph">
<p>This definition says that a <strong>declaration</strong> might be messages, a class definition, an instance declaration, etc.</p>
</div>
<div class="paragraph">
<p>The basic component of the language is reserved words and symbols. These are in the rules represented by quoted strings of characters. These are not defined elsewhere, but should instead be written as indicated. Character case is not significant.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-alan" data-lang="alan">random_expression = 'RANDOM' 'IN' expression</code></pre>
</div>
</div>
<div class="paragraph">
<p>The reserved words <code>random</code> and <code>in</code> can be followed by an expression (which, to make sense, must refer to a container instance) to form a 'random_expression' (which in itself is an expression).</p>
</div>
<div class="sect2">
<h3 id="truekeywords"><a class="anchor" href="#truekeywords"></a>D.1. Keywords</h3>
<div class="paragraph">
<p>The following is a complete list of all keywords in the Alan language. Note that they can still be used as identifiers in a source file if the rules described in <em>Words, Identifiers and Names</em> on page <em>153</em> are followed. Basically this means that if you surround them by single quotes they can be used as identifiers in your source code anyway. This might be especially important if you want to use any of these words as words the player might want to input, such as part of a name for an item.</p>
</div>
<div class="literalblock">
<div class="content">
<pre>'actor' 'add' 'after' 'an' 'and' 'are' 'article' 'at' 'attributes' 'before' 'between' 'by' 'can' 'cancel' 'character' 'characters' 'check' 'container' 'contains' 'count' 'current' 'decrease' 'definite' 'depend' 'depending' 'describe' 'description' 'directly' 'do' 'does' 'each' 'else' 'elsif' 'empty' 'end' 'entered' 'event' 'every' 'exclude' 'exit' 'extract' 'first' 'for' 'form' 'from' 'has' 'header' 'here' 'if' 'import' 'in' 'include' 'increase' 'indefinite' 'initialize' 'into' 'is' 'isa' 'it' 'last' 'limits' 'list' 'locate' 'location' 'look' 'make' 'max' 'mentioned' 'message' 'min' 'name' 'near' 'nearby' 'negative' 'no' 'not' 'of' 'off' 'on' 'only' 'opaque' 'option' 'options' 'or' 'play' 'prompt' 'pronoun' 'quit' 'random' 'restart' 'restore' 'save' 'say' 'schedule' 'score' 'script' 'set' 'show' 'start' 'step' 'stop' 'strip' 'style' 'sum' 'synonyms' 'syntax' 'system' 'taking' 'the' 'then' 'this' 'to' 'transcript' 'until' 'use' 'verb' 'visits' 'wait' 'when' 'where' 'with' 'word' 'words'</pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="truepredefined-player-words"><a class="anchor" href="#truepredefined-player-words"></a>Appendix E: Predefined player words</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Alan defines a set of words for the player to use, which are required for the syntax variations described in <em>Player Input</em> on page <em>160</em>. These words are available even without any declarations at all in the game source. Some of these might conflict with, or complement, words defined in the source. The lists below contain those player words for the currently defined languages.</p>
</div>
<div class="sect2">
<h3 id="trueenglish"><a class="anchor" href="#trueenglish"></a>E.1. English</h3>
<div class="literalblock">
<div class="content">
<pre>*ALL:* all everything** +
AND:** and then** +
BUT:** but except** +
THEM:** them** +
NOISE:** go the** +
**</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="trueswedish"><a class="anchor" href="#trueswedish"></a>E.2. Swedish</h3>
<div class="literalblock">
<div class="content">
<pre>*ALL:* alla allt** +
AND:** och** +
BUT:** förutom utom** +
THEM:** dem dom** +
NOISE:** gå</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="truegerman"><a class="anchor" href="#truegerman"></a>E.3. German</h3>
<div class="literalblock">
<div class="content">
<pre>*ALL:* alles** +
AND:** und** +
BUT:** ausser** +
THEM:** sie** +
NOISE:** das der die gehen</pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="truecompiler-messages"><a class="anchor" href="#truecompiler-messages"></a>Appendix F: Compiler Messages</h2>
<div class="sectionbody">
<div class="olist upperalpha">
<ol class="upperalpha" type="A">
<li>
<p>Format of messages</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>This appendix describes the error messages generated by the Alan compiler. The compiler presents the messages in the order of occurrence in the file. The offending source line is always shown together with the message. The following example illustrates a typical compiler output.</p>
</div>
<div class="paragraph">
<p>ZILexample.alan<br>
23. If barfoo Is foobared Then<br></p>
</div>
<div class="paragraph">
<p>===&#8658; 1<br>
<strong>1</strong> 310 E : Identifier 'barfoo' not defined.<br>
27. Exit north To Rumble.<br></p>
</div>
<div class="paragraph">
<p>===&#8658; 1<br>
<strong>1</strong> 310 E : Identifier 'rumble' not defined.<br>
28. Exit west To Tumble.<br></p>
</div>
<div class="paragraph">
<p>===&#8658; 1<br>
<strong>1</strong> 310 E : Identifier 'tumble' not defined.<br>
46.<br></p>
</div>
<div class="paragraph">
<p>===&#8658; 1<br>
<strong>1</strong> 101 E : 'START' 'HERE' '.' inserted.<br>
<strong>1</strong> 211 E : Must start at a Location.<br>
5 error(s).<br>
No detected warnings.<br>
2 informational message(s).</p>
</div>
<div class="paragraph">
<p>The following information is available in the compiler listing, framed for visibility:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>File name</p>
</li>
<li>
<p>Line number and source text of a line</p>
</li>
<li>
<p>Message indicator, pointer, message number and text</p>
</li>
<li>
<p>Message summary (three lines)</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>For information on how to select which levels of messages to show and where output is directed, refer to the options and their descriptions in section <em>Compiler Switches</em> on page <em>203</em>.</p>
</div>
<div class="olist upperalpha">
<ol class="upperalpha" type="A">
<li>
<p>Message explanations</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>For each message, a short description of the error, possible causes etc. are given. Each message reported also indicates the severity of that error. The message is supplemented with an indication of its severity. An informational message (indicated by the letter &#8216;I&#8217;) simply gives some information to the user, a warning message (&#8216;W&#8217;) indicates an error but the compilation still generates a valid output (although not always what the user intended). Error messages (&#8216;E&#8217;) indicate errors that have made it impossible to generate any output, but the compiler will continue to process all input. Fatal (&#8216;F&#8217;) and system (&#8216;S&#8217;) messages always terminate the compilation process immediately.</p>
</div>
<div class="paragraph">
<p>The message descriptions below may also contain the special insertion markers <code>%n</code> (where <code>n</code> is a digit), which indicate that text will be inserted at that point in the message during compile time, e.g. the offending identifier or a file name.</p>
</div>
<div class="paragraph">
<p>100 Parsing resumed here.</p>
</div>
<div class="paragraph">
<p>A severe syntax error was discovered. Some input was skipped. This error message marks the place where the parsing was restarted.</p>
</div>
<div class="paragraph">
<p>101 %1 inserted.</p>
</div>
<div class="paragraph">
<p>A syntax error was discovered and one or more symbols inserted in the input in an attempt to recover.</p>
</div>
<div class="paragraph">
<p>102 %1 deleted.</p>
</div>
<div class="paragraph">
<p>A syntax error was discovered and one or more symbols were skipped from the input in an attempt to recover.</p>
</div>
<div class="paragraph">
<p>103 %1 replaced by %2.</p>
</div>
<div class="paragraph">
<p>A syntax error was discovered and one or more symbols were replaced by one or more other symbols in an attempt to recover.</p>
</div>
<div class="paragraph">
<p>104 Severe syntax error, construct ignored.</p>
</div>
<div class="paragraph">
<p>An intricate syntax error was discovered. A complete construct was skipped in an attempt to recover.</p>
</div>
<div class="paragraph">
<p>105 Syntax error, couldn&#8217;t recover.<br>
106 Parse stack overflow.<br>
107 Parse table error.<br>
108 Parsing terminated.</p>
</div>
<div class="paragraph">
<p>Alan compiler implementation errors. Should not occur!</p>
</div>
<div class="paragraph">
<p>150 Unterminated STRING.</p>
</div>
<div class="paragraph">
<p>An opening double quote was not terminated by a closing quote before end of file. Error message points to the opening quote. Remember <strong>STRINGs</strong> may cover several lines.</p>
</div>
<div class="paragraph">
<p>151 File name missing for $INCLUDE directive.</p>
</div>
<div class="paragraph">
<p>An include directive was given but no file was indicated. The complete file name must be given according to the rules in section <em>File</em> on page <em>157</em>.</p>
</div>
<div class="paragraph">
<p>198 Could not open output file '%1' for writing.</p>
</div>
<div class="paragraph">
<p>The indicated output file could not be opened, probably because the directory did not exist or the file or directory was write-protected.</p>
</div>
<div class="paragraph">
<p>199 Adventure source file (%1) not found.</p>
</div>
<div class="paragraph">
<p>The source file given on the command line did not exist. The Alan compiler adds the <strong>.alan</strong> extension to the file name given, if it did not include a period.</p>
</div>
<div class="paragraph">
<p>201 Mismatched block identifier, '%1' assumed.</p>
</div>
<div class="paragraph">
<p>The identifier following a terminating <code>END</code> did not match the one given at the beginning of the construct. This indicates an illegal nesting or a missed <code>END IF</code>. The identifier indicates to which block the <code>END</code> is assumed to belong.</p>
</div>
<div class="paragraph">
<p>202 Multiple usage of direction '%1' in this Exit.<br>
203 Multiple definition of Exit '%1' in this location.</p>
</div>
<div class="paragraph">
<p>The directional word indicated was used more than once, either in the same, or different exit declaration from the location. This is contradictory and not legal.</p>
</div>
<div class="paragraph">
<p>204 Multiple definition of %1 DEFAULTS. Ignored.</p>
</div>
<div class="paragraph">
<p>Only one declaration of default attributes per type is allowed. The second declaration is ignored.</p>
</div>
<div class="paragraph">
<p>205 Multiple usage of '%1' in this VERB definition.</p>
</div>
<div class="paragraph">
<p>When specifying actions for multiple verbs in the same declaration, the indicated word occurred twice.</p>
</div>
<div class="paragraph">
<p>206 Multiple definition of SYNTAX for %1.</p>
</div>
<div class="paragraph">
<p>More than one syntax definition for the same verb was found. This is an error. You should remove the offending one.</p>
</div>
<div class="paragraph">
<p>207 VERB '%1' is not defined.</p>
</div>
<div class="paragraph">
<p>A <code>SYNTAX</code> construct defined the syntax for a verb that was never defined.</p>
</div>
<div class="paragraph">
<p>208 '%1' is not a VERB.</p>
</div>
<div class="paragraph">
<p>The identifier on the left hand side of a <code>SYNTAX</code> definition was defined as something that was not a <code>VERB</code>.</p>
</div>
<div class="paragraph">
<p>209 First element in a SYNTAX must be a player word.</p>
</div>
<div class="paragraph">
<p>The definition of a <code>SYNTAX</code> construct may not start with a parameter. The first word must be a player word so as to distinguish it from other forms of input.</p>
</div>
<div class="paragraph">
<p>210 Action qualification not allowed here.</p>
</div>
<div class="paragraph">
<p>The <code>BEFORE</code>, <code>AFTER</code> and <code>ONLY</code> qualifiers may not be used in a <code>DOES</code>-clause in this context.</p>
</div>
<div class="paragraph">
<p>211 Adventure must start at a Location.</p>
</div>
<div class="paragraph">
<p>You specified a <code>where</code> expression in the <code>START</code> section that did not specify an explicit location. The start section specifies where the hero starts and must be a <code>LOCATION</code>.</p>
</div>
<div class="paragraph">
<p>212 Syntax parameter '%1' overrides symbol.</p>
</div>
<div class="paragraph">
<p>The <code>SYNTAX</code> definition valid in this context defined a symbol that is the same as an entity (class or instance). The syntax parameter will take precedence.</p>
</div>
<div class="paragraph">
<p>213 Verb alternatives not allowed here.</p>
</div>
<div class="paragraph">
<p>You may only specify different verb body alternatives within objects. The global verb body and the verb body in the location may not have alternatives.</p>
</div>
<div class="paragraph">
<p>214 Parameter not defined in syntax for '%1'.</p>
</div>
<div class="paragraph">
<p>The identifier given as the selector in a verb body alternative was not defined in the syntax for that verb.</p>
</div>
<div class="paragraph">
<p>215 Syntax not compatible with syntax for '%1'.</p>
</div>
<div class="paragraph">
<p>To be able to use the same body for different verbs by supplying them in a comma-separated list in the verb header they must all be compatible. This means that they have the same number of parameters and the parameters have the same names. Otherwise conflicts will arise when figuring out which parameter to use.</p>
</div>
<div class="paragraph">
<p>216 Parameter '%1' multiply defined in this SYNTAX.</p>
</div>
<div class="paragraph">
<p>The parameter was defined more than once in the same SYNTAX definition.</p>
</div>
<div class="paragraph">
<p>217 Only one multiple parameter allowed for each syntax. This one ignored.</p>
</div>
<div class="paragraph">
<p>To be able to use multiple parameters in a player command only one parameter may be marked as referring to multiple objects or actors using ALL or conjugations. This is a warning, the syntax will be as if the first multiple marker was the only one.</p>
</div>
<div class="paragraph">
<p>218 Multiple definition of attribute '%1'.</p>
</div>
<div class="paragraph">
<p>The indicated attribute name was defined more than once in the same context (default attribute list or within the same entity). Remove one definition.</p>
</div>
<div class="paragraph">
<p>220 Multiple definition of '%1'.</p>
</div>
<div class="paragraph">
<p>The indicated word has multiple, and possibly different, definitions.</p>
</div>
<div class="paragraph">
<p>221 Multiple class restriction for parameter '%1'.</p>
</div>
<div class="paragraph">
<p>The same parameter occurred more than once in the list of class restriction in the same <code>SYNTAX</code> definition.</p>
</div>
<div class="paragraph">
<p>222 Identifier '%1' in class definition is not a parameter.</p>
</div>
<div class="paragraph">
<p>Only the parameters in the syntax may be referenced in the class-restricting clause of a <code>SYNTAX</code> definition.</p>
</div>
<div class="paragraph">
<p>230 No syntax defined for this verb, assumed '%1 (object)'.</p>
</div>
<div class="paragraph">
<p>This message is a warning to indicate that the default syntax handling has been used.</p>
</div>
<div class="paragraph">
<p>310 Identifier '%1' not defined.</p>
</div>
<div class="paragraph">
<p>The indicated word was never defined. It must be declared either as a location, an object, a container, an actor or an event.</p>
</div>
<div class="paragraph">
<p>311 Must refer to %1.</p>
</div>
<div class="paragraph">
<p>The construct indicated does not refer to the correct kind of item, the message indicates which kind of item was expected.</p>
</div>
<div class="paragraph">
<p>312 Parameter not uniquely defined as %1, which is required.</p>
</div>
<div class="paragraph">
<p>In certain contexts it is necessary to refer to a particular type of entity, e.g. the <code>IN</code> expression must refer to a container or an object with the container property. If the reference (the WHAT part) is a parameter identifier, this parameter must be restricted to be of the required type by use of parameter restrictions (such as <code>WHERE c ISA CONTAINER</code>).</p>
</div>
<div class="paragraph">
<p>315 Attribute not defined for '%1'.</p>
</div>
<div class="paragraph">
<p>The indicated attribute is not defined for the particular object, location or actor. It must either be a default attribute or be locally declared.</p>
</div>
<div class="paragraph">
<p>318 Entity '%1' is not a Container.</p>
</div>
<div class="paragraph">
<p>The referenced entity (object or actor) was not declared to have the container property, although the context required a container.</p>
</div>
<div class="paragraph">
<p>320 Word '%1' belongs to multiple word classes (%2 and %3).</p>
</div>
<div class="paragraph">
<p>A word was declared as to belong to different word classes such as noun, verb, adjective etc. Only multiple declarations that may lead to unexpected behaviour are reported, usually because of limitations in the current implementation. Generally it is allowed to declare a word e.g. as both an adjective and a noun.</p>
</div>
<div class="paragraph">
<p>321 Synonym target word '%1' not defined.</p>
</div>
<div class="paragraph">
<p>To define a synonym its target word (the word on the left side of the equal sign) must be defined as a proper word elsewhere in the source.</p>
</div>
<div class="paragraph">
<p>322 Word '%1' already defined as a synonym.</p>
</div>
<div class="paragraph">
<p>A word may not be declared as a synonym for different target words.</p>
</div>
<div class="paragraph">
<p>330 Wrong types of expression. Must be of %1 type.</p>
</div>
<div class="paragraph">
<p>In an expression, a value or an expression was used that had a type that was not allowed. The message indicates the correct type.</p>
</div>
<div class="paragraph">
<p>331 Incompatible types in %1.</p>
</div>
<div class="paragraph">
<p>The two values in an expression with a binary operator did not have compatible types, or the value used in a <code>SET</code> statement was not type compatible with the referenced attribute.</p>
</div>
<div class="paragraph">
<p>332 Type of local attribute must match default attribute.</p>
</div>
<div class="paragraph">
<p>An attribute declared locally (within an object, actor or location) that has the same name as a default attribute, has to have the same type (Boolean, integer or string).</p>
</div>
<div class="paragraph">
<p>333 The word '%1' is defined as a synonym as well as of another word class.</p>
</div>
<div class="paragraph">
<p>Synonyms must be words <em>not</em> defined elsewhere.</p>
</div>
<div class="paragraph">
<p>400 Script not defined for Actor '%1'.</p>
</div>
<div class="paragraph">
<p>No script with the indicated identity was defined for the actor.</p>
</div>
<div class="paragraph">
<p>401 Actor reference required outside Actor specification.</p>
</div>
<div class="paragraph">
<p>Inside an actor specification it is permissible to leave out the actor reference in a <code>USE</code> statement in which case the surrounding actor is assumed. Outside actor specifications, the actor reference must always be supplied.</p>
</div>
<div class="paragraph">
<p>402 An Actor can&#8217;t be inside a Container.</p>
</div>
<div class="paragraph">
<p>The <code>LOCATE</code> statement tried to locate an actor inside a container. This is not allowed.</p>
</div>
<div class="paragraph">
<p>403 Script number multiply defined for Actor '%1'.</p>
</div>
<div class="paragraph">
<p>The indicated number was used for more than one script for the same actor.</p>
</div>
<div class="paragraph">
<p>404 Attribute to %1 must be a default attribute.</p>
</div>
<div class="paragraph">
<p>To reference attributes for <code>OBJECT</code>, <code>LOCATION</code> and <code>ACTOR</code> the attribute used must be a default attribute, as all objects, locations or actors must have it.</p>
</div>
<div class="paragraph">
<p>405 The class of a parameter used in %1 must be uniquely defined.</p>
</div>
<div class="paragraph">
<p>In some statements the class of the identifier must be determined during compile time. This is, for example, the case in <code>MAKE</code> and <code>SET</code> statements.</p>
</div>
<div class="paragraph">
<p>406 A parameter defined as Container have no default attributes.</p>
</div>
<div class="paragraph">
<p>A parameter that was restricted to containers do not have any default attributes. Actors, objects and locations have separate sets of default attributes. In order to refer to an attribute on a parameter it must be restricted to one of these classes. If the parameter also requires the container property, use <code>CONTAINER ACTOR</code> or <code>CONTAINER OBJECT</code>.</p>
</div>
<div class="paragraph">
<p>407 Attribute in LIMITS must be a default attribute.</p>
</div>
<div class="paragraph">
<p>All objects must have the attribute that a limit is to test.</p>
</div>
<div class="paragraph">
<p>408 Attributes in %1 must be of Boolean type.</p>
</div>
<div class="paragraph">
<p>The attribute referenced in the indicated context must be a Boolean attribute.</p>
</div>
<div class="paragraph">
<p>409 No parameter defined in this context.</p>
</div>
<div class="paragraph">
<p>No parameter is defined in the context where a reference to <code>OBJECT</code> was made. Parameters are only defined within checks and bodies of verbs, so the use of <code>OBJECT</code> (an obsolete construct, use the parameter identifier instead) is also restricted to those contexts. See <em>Run-time Contexts</em> <em>162</em>.</p>
</div>
<div class="paragraph">
<p>410 A parameter may not be used in %1.</p>
</div>
<div class="paragraph">
<p>In certain statements a parameter may not be used at all.</p>
</div>
<div class="paragraph">
<p>411 %1 ignored for Actor 'hero'.</p>
</div>
<div class="paragraph">
<p>It is allowed to redefine the predefined actor <code>HERO</code> (the player). This makes it possible to define local attributes and descriptions for the hero. However any definition of scripts or initial location is ignored (the script is supplied by the player in his input and the initial location is defined in the <code>START</code> section).</p>
</div>
<div class="paragraph">
<p>412 'ACTOR' is not allowed inside events.</p>
</div>
<div class="paragraph">
<p>In events no actor is active. This means that no reference to the active actor can be made. See <em>Run-time Contexts</em> <em>162</em>.</p>
</div>
<div class="paragraph">
<p>413 Expression in %1 must be of integer type.</p>
</div>
<div class="paragraph">
<p>The context required a numeric expression.</p>
</div>
<div class="paragraph">
<p>414 Invalid initial location for %1.</p>
</div>
<div class="paragraph">
<p>The initial location specified was not valid.</p>
</div>
<div class="paragraph">
<p>415 Invalid Where specification in %1 statement.</p>
</div>
<div class="paragraph">
<p>The statement indicated does not allow the <code>WHERE</code> specification used.</p>
</div>
<div class="paragraph">
<p>416 Interval of size 1 in RANDOM expression.</p>
</div>
<div class="paragraph">
<p>This message informs that the interval in a <code>RANDOM</code> statement was just one single value, resulting in always returning the same value, not very random.</p>
</div>
<div class="paragraph">
<p>417 Comparing two constant entities will always yield the same result.</p>
</div>
<div class="paragraph">
<p>The expression compared two identifiers none of which was a parameter. This will always give the same result. This is probably an error, but the message is still a warning as it gives a perfectly running adventure (but, perhaps not what you intended?).</p>
</div>
<div class="paragraph">
<p>418 Aggregate is only allowed on integer type attributes.</p>
</div>
<div class="paragraph">
<p>The aggregates <code>MAX</code> and <code>SUM</code> can only perform their calculation on integers.</p>
</div>
<div class="paragraph">
<p>419 Expression in %1 must be of integer or string type.</p>
</div>
<div class="paragraph">
<p>In the indicated context only integer and string type expressions may be used.</p>
</div>
<div class="paragraph">
<p>501 LOCATION '%1' has no Exits.</p>
</div>
<div class="paragraph">
<p>In case the hero is located at the indicated location he may not be able to escape from that location. This may be intentional (as for a limbo location or a location with magic words to use as an escape) but the warning is presented as a reminder.</p>
</div>
<div class="paragraph">
<p>600 Multiple use of option '%1', ignored.</p>
</div>
<div class="paragraph">
<p>The indicated option was used more than once, this occurrence is ignored and the previous setting used.</p>
</div>
<div class="paragraph">
<p>601 Unknown option, '%1'.</p>
</div>
<div class="paragraph">
<p>A word was given in the option section that was not the name of an option.</p>
</div>
<div class="paragraph">
<p>602 Illegal value for option '%1'.</p>
</div>
<div class="paragraph">
<p>The indicated option does not allow the value used.</p>
</div>
<div class="paragraph">
<p>997 SYSTEM ERROR: %1</p>
</div>
<div class="paragraph">
<p>A severe implementation dependent error has occurred (a bug!). Please report.</p>
</div>
<div class="paragraph">
<p>998 Feature not implemented in %1.</p>
</div>
<div class="paragraph">
<p>The combination of some syntactically correct but semantically tricky constructs is not yet implemented. Please report.</p>
</div>
<div class="paragraph">
<p>999 No Adventure generated.</p>
</div>
<div class="paragraph">
<p>When an error is detected this informational message is given to indicate that no executable adventure was output.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="truelocalization"><a class="anchor" href="#truelocalization"></a>Appendix G: Localization</h2>
<div class="sectionbody">
<div class="paragraph">
<p>To create adventures in languages other than English, there are a few separate issues to consider. The sections below describes the support that Alan provides for each of them.</p>
</div>
<div class="olist upperalpha">
<ol class="upperalpha" type="A">
<li>
<p>Character/Glyph availability</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Most languages have characters, or glyphs, other than the common ones used in English, like ö, Ñ or æ. Alan uses a character encoding called ISO-8859-1 which allows for many characters (but not all) used in European and other countries.</p>
</div>
<div class="paragraph">
<p>To make use of these characters you just need to make sure that the adventure text files use this character encoding. Usually you can do this in the editor you are using, often when you save a file the first time, or there should be a setting in your operating system to define the default encoding.</p>
</div>
<div class="paragraph">
<p>If the Alan source files are encoded using ISO-8859-1 they will be presented correctly when the game is run using e.g. WinArun. If you run the games in console mode you have to ensure that both your console program and your operating system are set (and able) to show characters using the ISO-8859-1 encoding.</p>
</div>
<div class="olist upperalpha">
<ol class="upperalpha" type="A">
<li>
<p>Standard messages</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>There are two main types of messages that are output by interpreter to the player. They are initiated by various parts of the Alan system. The built in messages are built in to the compiler, see <em>Input Response Messages</em> on page 210, but can be changed to messages in the available languages. If you are using any of the available standard libraries, that library also issues messages, often overriding the messages built-in.</p>
</div>
<div class="paragraph">
<p>The only way to translate messages in the library is to translate the library. This is probably what you want to do anyway, since most of the verbs would be in English.</p>
</div>
<div class="paragraph">
<p>Messages built into the compiler are generated automatically into the game file, e.g. as error messages like &#8220;You can&#8217;t do that.&#8221; These can either be changed by the Language option (if the language of your choice is already supported), or translated using the Message statement. Appendix <em>Run-time Messages</em> on page <em>210</em> lists all such messages and their content.</p>
</div>
<div class="paragraph">
<p>There are a few special words that are currently not author translatable, as described in Appendix <em>Predefined player words</em> on page <em>224</em>.</p>
</div>
<div class="olist upperalpha">
<ol class="upperalpha" type="A">
<li>
<p>Player words</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>TBD.</p>
</div>
<div class="olist upperalpha">
<ol class="upperalpha" type="A">
<li>
<p>Word variations</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>TBD. &lt;Text about using multiple names for the same objects &amp; synonyms, and how the interpreter chooses which word to use when&gt;</p>
</div>
<div class="olist upperalpha">
<ol class="upperalpha" type="A">
<li>
<p>Word order</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>TBD. &lt;Text about how the rigid word order (verb first, possibly prefixed with a noun) that Alan imposes. Or does it? With the noun first is it possible to implement &#8220;das buch nehmen&#8221; with the syntax take = (o) nehmen?&gt;</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="trueportability-of-games"><a class="anchor" href="#trueportability-of-games"></a>Appendix H: Portability of Games</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The adventure files produced by the Alan compiler is compatible across all supported platforms. This means that by copying the binary <em>*.a3c*</em> file (and any <em>*.a3r*</em> file if available) to another machine it should be possible to run the game on that new machine without any changes. Note however that the files must be transferred in <em>binary</em> mode (where applicable). All characters are automatically converted to the native set allowing multi-national characters to be presented correctly even on machines that do not support the IS0 8859-1 standard. This is of course restricted to characters having a representation in the current native character set.</p>
</div>
<div class="paragraph">
<p>It is a strong goal to achieve complete portability of the games to be able to provide games for all supported platforms without re-compilation. Game authors are encouraged to seriously consider this when designing games and not use any system specific characters, character combinations or special commands that may be available on some systems.</p>
</div>
<div class="paragraph">
<p>Portability between different versions of the system is not guaranteed. Again, it is a strong goal to be backwards compatible, at least between different builds within the same major version. This means that the most recent v3 interpreter should run games from all previous v3 compilers.</p>
</div>
<div class="paragraph">
<p>Changes in the game file format may occur between versions, which may or may not be compatible. Conversion tools may be available, older interpreter versions can be requested.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="truecopying-conditions"><a class="anchor" href="#truecopying-conditions"></a>Appendix I: Copying Conditions</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The Alan System is distributed under the Artistic License 2.0 for which the full text follows. The intent of this licensing is that the Copyright Holder retain some control over the development of the Alan System, while still keeping it available as open source and free software.</p>
</div>
<div class="paragraph">
<p>In practical terms this means that the licensing is chosen so that it should be possible to</p>
</div>
<div class="ulist">
<ul>
<li>
<p>freely distribute games produced with the Alan system, including for profit</p>
</li>
<li>
<p>re-distribute compiled versions of the Alan system, including together with a game which is not open source or free, provided there is no charge for the Alan system</p>
</li>
<li>
<p>redistribute compiled and/or source versions of the original Alan system (the Standard Version)</p>
</li>
<li>
<p>acquire the source code for the Standard Version</p>
</li>
<li>
<p>modify the source code for private use</p>
</li>
<li>
<p>re-distribute compiled and/or source of a Modified Version provided they are done so under a compatible license with appropriate attribution <strong>and</strong> that the modification is described and made available, preferably by returning it to the Copyright Holder so that it can be merged into the Standard Version</p>
<div class="olist upperalpha">
<ol class="upperalpha" type="A">
<li>
<p>Artistic License 2.0</p>
</li>
</ol>
</div>
</li>
</ul>
</div>
<h3 id="truepreamble" class="discrete">Preamble</h3>
<div class="paragraph">
<p>This license establishes the terms under which a given free software Package may be copied, modified, distributed, and/or redistributed. The intent is that the Copyright Holder maintains some artistic control over the development of that Package while still keeping the Package available as open source and free software.</p>
</div>
<div class="paragraph">
<p>You are always permitted to make arrangements wholly outside of this license directly with the Copyright Holder of a given Package. If the terms of this license do not permit the full use that you propose to make of the Package, you should contact the Copyright Holder and seek a different licensing arrangement.</p>
</div>
<h3 id="truedefinitions" class="discrete">Definitions</h3>
<div class="paragraph">
<p>"Copyright Holder" means the individual(s) or organization(s) named in the copyright notice for the entire Package.</p>
</div>
<div class="paragraph">
<p>"Contributor" means any party that has contributed code or other material to the Package, in accordance with the Copyright Holder&#8217;s procedures.</p>
</div>
<div class="paragraph">
<p>"You" and "your" means any person who would like to copy, distribute, or modify the Package.</p>
</div>
<div class="paragraph">
<p>"Package" means the collection of files distributed by the Copyright Holder, and derivatives of that collection and/or of those files. A given Package may consist of either the Standard Version, or a Modified Version.</p>
</div>
<div class="paragraph">
<p>"Distribute" means providing a copy of the Package or making it accessible to anyone else, or in the case of a company or organization, to others outside of your company or organization.</p>
</div>
<div class="paragraph">
<p>"Distributor Fee" means any fee that you charge for Distributing this Package or providing support for this Package to another party. It does not mean licensing fees.</p>
</div>
<div class="paragraph">
<p>"Standard Version" refers to the Package if it has not been modified, or has been modified only in ways explicitly requested by the Copyright Holder.</p>
</div>
<div class="paragraph">
<p>"Modified Version" means the Package, if it has been changed, and such changes were not explicitly requested by the Copyright Holder.</p>
</div>
<div class="paragraph">
<p>"Original License" means this Artistic License as Distributed with the Standard Version of the Package, in its current version or as it may be modified by The Copyright Holder in the future.</p>
</div>
<div class="paragraph">
<p>"Source" form means the source code, documentation source, and configuration files for the Package.</p>
</div>
<div class="paragraph">
<p>"Compiled" form means the compiled byte code, object code, binary, or any other form resulting from mechanical transformation or translation of the Source form.</p>
</div>
<h3 id="truepermission-for-use-and-modification-without-distribution" class="discrete">Permission for Use and Modification Without Distribution</h3>
<div class="paragraph">
<p>(1) You are permitted to use the Standard Version and create and use Modified Versions for any purpose without restriction, provided that you do not Distribute the Modified Version.</p>
</div>
<h3 id="truepermissions-for-redistribution-of-the-standard-version" class="discrete">Permissions for Redistribution of the Standard Version</h3>
<div class="paragraph">
<p>(2) You may Distribute verbatim copies of the Source form of the Standard Version of this Package in any medium without restriction, either gratis or for a Distributor Fee, provided that you duplicate all of the original copyright notices and associated disclaimers. At your discretion, such verbatim copies may or may not include a Compiled form of the Package.</p>
</div>
<div class="paragraph">
<p>(3) You may apply any bug fixes, portability changes, and other modifications made available from the Copyright Holder. The resulting Package will still be considered the Standard Version, and as such will be subject to the Original License.</p>
</div>
<h3 id="truedistribution-of-modified-versions-of-the-package-as-source" class="discrete">Distribution of Modified Versions of the Package as Source</h3>
<div class="paragraph">
<p>(4) You may Distribute your Modified Version as Source (either gratis or for a Distributor Fee, and with or without a Compiled form of the Modified Version) provided that you clearly document how it differs from the Standard Version, including, but not limited to, documenting any non-standard features, executables, or modules, and provided that you do at least ONE of the following:</p>
</div>
<div class="paragraph">
<p>(a) make the Modified Version available to the Copyright Holder of the Standard Version, under the Original License, so that the Copyright Holder may include your modifications in the Standard Version.</p>
</div>
<div class="paragraph">
<p>(b) ensure that installation of your Modified Version does not prevent the user installing or running the Standard Version. In addition, the Modified Version must bear a name that is different from the name of the Standard Version.</p>
</div>
<div class="paragraph">
<p>(c) allow anyone who receives a copy of the Modified Version to make the Source form of the Modified Version available to others under</p>
</div>
<div class="paragraph">
<p>(i) the Original License or</p>
</div>
<div class="paragraph">
<p>(ii) a license that permits the licensee to freely copy, modify and redistribute the Modified Version using the same licensing terms that apply to the copy that the licensee received, and requires that the Source form of the Modified Version, and of any works derived from it, be made freely available in that license fees are prohibited but Distributor Fees are allowed.</p>
</div>
<h3 id="truedistribution-of-compiled-forms-of-the-standard-version-or-modified-versions-without-the-source" class="discrete">Distribution of Compiled Forms of the Standard Version or Modified Versions without the Source</h3>
<div class="paragraph">
<p>(5) You may Distribute Compiled forms of the Standard Version without the Source, provided that you include complete instructions on how to get the Source of the Standard Version. Such instructions must be valid at the time of your distribution. If these instructions, at any time while you are carrying out such distribution, become invalid, you must provide new instructions on demand or cease further distribution. If you provide valid instructions or cease distribution within thirty days after you become aware that the instructions are invalid, then you do not forfeit any of your rights under this license.</p>
</div>
<div class="paragraph">
<p>(6) You may Distribute a Modified Version in Compiled form without the Source, provided that you comply with Section 4 with respect to the Source of the Modified Version.</p>
</div>
<h3 id="trueaggregating-or-linking-the-package" class="discrete">Aggregating or Linking the Package</h3>
<div class="paragraph">
<p>(7) You may aggregate the Package (either the Standard Version or Modified Version) with other packages and Distribute the resulting aggregation provided that you do not charge a licensing fee for the Package. Distributor Fees are permitted, and licensing fees for other components in the aggregation are permitted. The terms of this license apply to the use and Distribution of the Standard or Modified Versions as included in the aggregation.</p>
</div>
<div class="paragraph">
<p>(8) You are permitted to link Modified and Standard Versions with other works, to embed the Package in a larger work of your own, or to build stand-alone binary or byte code versions of applications that include the Package, and Distribute the result without restriction, provided the result does not expose a direct interface to the Package.</p>
</div>
<h3 id="trueitems-that-are-not-considered-part-of-a-modified-version" class="discrete">Items That are Not Considered Part of a Modified Version</h3>
<div class="paragraph">
<p>(9) Works (including, but not limited to, modules and scripts) that merely extend or make use of the Package, do not, by themselves, cause the Package to be a Modified Version. In addition, such works are not considered parts of the Package itself, and are not subject to the terms of this license.</p>
</div>
<h3 id="truegeneral-provisions" class="discrete">General Provisions</h3>
<div class="paragraph">
<p>(10) Any use, modification, and distribution of the Standard or Modified Versions is governed by this Artistic License. By using, modifying or distributing the Package, you accept this license. Do not use, modify, or distribute the Package, if you do not accept this license.</p>
</div>
<div class="paragraph">
<p>(11) If your Modified Version has been derived from a Modified Version made by someone other than you, you are nevertheless required to ensure that your Modified Version complies with the requirements of this license.</p>
</div>
<div class="paragraph">
<p>(12) This license does not grant you the right to use any trademark, service mark, trade name, or logo of the Copyright Holder.</p>
</div>
<div class="paragraph">
<p>(13) This license includes the non-exclusive, worldwide, free-of-charge patent license to make, have made, use, offer to sell, sell, import and otherwise transfer the Package with respect to any patent claims licensable by the Copyright Holder that are necessarily infringed by the Package. If you institute patent litigation (including a cross-claim or counter-claim) against any party alleging that the Package constitutes direct or contributory patent infringement, then this Artistic License to you shall terminate on the date that such litigation is filed.</p>
</div>
<div class="paragraph">
<p>(14) Disclaimer of Warranty: THE PACKAGE IS PROVIDED BY THE COPYRIGHT HOLDER AND CONTRIBUTORS "AS IS' AND WITHOUT ANY EXPRESS OR IMPLIED WARRANTIES. THE IMPLIED WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE, OR NON-INFRINGEMENT ARE DISCLAIMED TO THE EXTENT PERMITTED BY YOUR LOCAL LAW. UNLESS REQUIRED BY LAW, NO COPYRIGHT HOLDER OR CONTRIBUTORWILL BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, OR CONSEQUENTIAL DAMAGES ARISING IN ANY WAY OUT OF THE USE OF THE PACKAGE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.</p>
</div>
<div class="olist upperalpha">
<ol class="upperalpha" type="A">
<li>
<p>Executive Summary</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>So, in short, the interpreter Arun and any game produced using the Alan System is yours. You may sell or copy it as you like, and as you need the interpreter to run the game, it may be copied freely too. The Arun interpreter may also be uploaded on BBS&#8217;es or FTP-sites to allow players to download an interpreter for his platform and use that to run your game.</p>
</div>
<div class="paragraph">
<p>The documentation and examples are free to copy or place on any BBS&#8217;es or FTP-sites if their contents are not changed.</p>
</div>
<div class="paragraph">
<p>If you create a game using the Alan System, we&#8217;d very much like to see it. Send us a copy (preferably in source) and any documentation or a description of the game and its novel features. We will of course honour any copy-restrictions that you might want to place on it.</p>
</div>
<div class="paragraph">
<p>Short games or samples of Alan source are also most welcome as examples that we might use and distribute to other users. Sending an example means that you waive all rights to it. If you also supply a walkthrough to your example it will be added to the growing suite of test data and thus help us further improve the quality of the Alan system.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="trueindex"><a class="anchor" href="#trueindex"></a>8. INDEX</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Aabstract attribute 72Abug 188actor 26behaviour 26predefined class 36, 59ACTOR in what specifications 140actor description 59actors execution context 163hints about 174moving 164adjective 66AFTER qualifier 106ALL 81, 94, 103, 161, 211, 212AND 94, 160, 161article 78Arun 187, 205, 210attribute pre-defined 82, 143attributes 32, 167boolean 70declaration 69event type 71numeric 70of reference type 71pre-defined location 143opaque 82visits 137string 70Bbasic type 51BEFORE qualifier 106BETWEEN 147BNF 221BUT 161, 212CCANCEL statement 126character combinations, in strings 118character sets 50CHECK 102in exits 88, 164in verbs 41check, unconditional 102checks execution order 109class syntax for 55class expressions 145classes 55comparisons equality 146compatible types 53computer language 20concatenation of strings 146CONTAINER 82container property of objects 81Opaque 82containment operator 147CONTAINS 147COUNT 150in limits 84Current Actor 147Current Location 147Ddebugging 187DECREASE statement 128default attributes 171syntax 42DEPENDING ON statement 131DESCRIBE statement 120description of locations 61Description of locations 30DESCRIPTION of actor scripts 89, 175Description clause 75descriptions execution context 163DIRECTLY 149DOES in descriptions 77in exits 164in locations 164in verbs 104doors, hints about 172double quotes 156EEMPTY statement 124Entered clause 76entity predefined class 36, 58EVENT 109event type 52events execution context 163hints about 172EVERYTHING 161EXCEPT 161, 212execution contexts 162of an adventure 24, 159execution context Initialize clause 75Exit 30EXIT 88, 164expressions 141EXTRACT 85HHERE 138hero 164hero, the 60Iidentifier quoted 66identifiers lexical definition 153If statement 32, 54IF statement 130import statement 54INCREASE statement 128indicator multiple 94omnipotent 94INDIRECTLY 149Infocom 18, 19inheritance 34, 56inheriting attributes 73inheriting properties, rules for 63Initialize clause 75initialize empty set 72instance displaying 67instance type 52instances 56integer predefined class 36interpreter 187, 205IT 161, 211Llanguages 210LIMITS 83LIST statement 121literal predefined class 36literals 62, 141Locate statement 33LOCATE statement 123locating inside containers 83, 124location 25, 29of 143, 181pre-defined attribute 143predefined class 36LOCATION in what specification 140locations 61logical expressions 144LOOK statement 134, 135MMake statement 32MAKE statement 127map 25MAX aggregate 150MENTIONED 80Meta Verbs 101MIN aggregate 150Multi-media Statements 122multinational characters 50multiple indicator 161multiple parameters 161NName of locations 66, 154Name clause 65names inheriting 67multiple 66NEARBY 139nested locations 61, 124noun 66numbers lexical definition 155Oobject 31predefined class 36, 59object orientation 34omnipotent indicator 162ONLY qualifier 106opaque pre-defined attribute 82Opaque 82container property 82operators binary 146logical 144relational 146, 147options 48, 49output statements 118Pparameter 42, 96indicators 94referencing 161Play 122player commands 159polymorphism 35pre-defined attribute 137visits 137predefined classes 35prompt 30Prompt Section 115pronoun predefined 69Pronoun clause 68properties 62property 62QQUIT statement 134quoted identifier 66, 153RRandom 59, 114, 125, 143, 144expression 143Random In 143reference attribute 51, 52, 53, 71, 72, 74, 121, 128, 129, 133, 142, 233RESTORE statement 135restriction of parameters 43restriction, of parameters 96rule 110rules executing 111execution context 163SSAVE statement 135SAY statement 120SCHEDULE statement 125SCORE statement 135SCRIPT 89semantics of locations 61semantics of pre-defined classes 36, 57Set statement 32SET statement 128set type 53set type attributes 72shadow object;object shadow 184Show 122single quotes 155spacing, in strings 156specialisation 37start section 48, 116STEP 91step, executing the last 91string comparisons 146functions 125predefined class 36String 30STRING 118strings lexical definition 156STRIP statement 125sub-classing 37SUM aggregate 150SYNONYMS 112Syntax 42SYNTAX 92syntax, default 98TTHEM 161, 211THEN 160thing predefined class 36 predefined class 58THIS expression 148transitivity Direct 149Indirect 149types of expressions 141typographical notation 28Uundo 164Use statement 54USE statement 89, 132Vverb 27alternative 105execution context 162execution order 43, 108Meta 101qualifiers 104, 106reusing common 171Verb 39VERB 100visits 137pre-defined attribute 137VISITS statements 136Wwhat specifications 140WHEN 110where specification 138</p>
</div>
</div>
</div>
</div>
<div id="footnotes">
<hr>
<div class="footnote" id="_footnote_1">
<a href="#_footnoteref_1">1</a>. Other non-English languages may be supported in the future depending on demand.
</div>
<div class="footnote" id="_footnote_2">
<a href="#_footnoteref_2">2</a>. Width and Length is overridden by the actual terminal or window size, if available.
</div>
</div>
<div id="footer">
<div id="footer-text">
Version 0.1.7<br>
Last updated 2018-08-21 02:06:52 E
</div>
</div>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/8.9.1/styles/github.min.css">
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/8.9.1/highlight.min.js"></script>
<script>hljs.initHighlighting()</script>
</body>
</html>